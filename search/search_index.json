{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Projeto BI Zero TO DW","text":""},{"location":"#apresentacao-do-projeto-bi-zero-to-dw","title":"Apresenta\u00e7\u00e3o do Projeto BI Zero TO DW","text":"<p>Nesse projeto vamos abordar o fluxo dos dados de um projeto de Big Data.</p> <p></p> <p>Partindo da premissa que o projeto dever\u00e1 conter as seguintes fases:</p> <ul> <li>1 - Os dados est\u00e3o dispon\u00edveis em um banco de dados Azure SQL Database;</li> <li>2 - Esses dados dever\u00e3o ser extra\u00eddos e persistidos na camada Landing Zone para posterior processamento;</li> <li>3 - Ap\u00f3s a extra\u00e7\u00e3o, os dados s\u00e3o processados e armazenados na camada bronze sem nenhum tratamento de dados. A estrutura das tabelas da camada bronze dever\u00e3o ser identicas a dos arquivos;</li> <li>4 - Na camada silver, os dados dever\u00e3o passar por transforma\u00e7\u00f5es/tratamentos que s\u00e3o descritos mais a frente;</li> <li>5 - Na camada gold, os dados devem estar modelados no padr\u00e3o multidimensional, criando tabelas de dimens\u00f5es e fato;</li> </ul>"},{"location":"0_quem_sou_eu/","title":"Projeto BI Zero TO DW","text":""},{"location":"0_quem_sou_eu/#quem-sou-eu","title":"Quem sou eu?","text":"<p>Meu nome \u00e9 Gabriel Quintella e voc\u00ea pode me chamar de Quintell\u00e3o caso queira!</p> <p>Trabalho com dados desde 2005.</p> <p>Possuo forma\u00e7\u00e3o em Sistemas de Informa\u00e7\u00e3o com especializa\u00e7\u00e3o em Projetos e Bancos de Dados com foco em BI e Bigdata.</p> <p>Possuo certica\u00e7\u00e3o Itil, Cobit, Microsoft tanto em ambientes OnPrimise e Cloud (Azure), Python e Databricks.</p> <p>Al\u00e9m disso trabalho atualmente como Engenheiro de Dados por\u00e9m j\u00e1 atuei como DBA, Administrador de Dados, Programador SQL como foco em Pl/SQL e TSQL, desenvolvedor de BI e como engenheiro de dados.</p> <p>Possuo experi\u00eancia em lideran\u00e7a de times de dados e proefici\u00eancia em bancos de dados tanto na parte de administra\u00e7\u00e3o quanto programa\u00e7\u00e3o, profundos conhecimentos em modelagem de dados relacional e multidimensional.</p> <p>Quando falamos em ferramentas de integra\u00e7\u00e3o, trabalehi por muitos anos com Pentaho, SQL Server Integration Service e Data Factory.</p> <p>E tamb\u00e9m possuo conhecimento em Python e PySpark.</p> <p>Deixo minhas redes sociais para poder acompanhar meus trabalhos!</p> <p>Instagram - https://www.instagram.com/dbaassists/ Twiter - https://twitter.com/dbaassists YouTube - https://www.youtube.com/@quintellao/featured Blog - https://www.dbaassists.com.br/ GitHub - https://github.com/dbaassists</p> <p>Grande abra\u00e7o e fique com Deus!!</p> <p>Quintell\u00e3o</p>"},{"location":"10_notebook_externo/","title":"Projeto BI Zero TO DW","text":""},{"location":"10_notebook_externo/#10-notebook-externo","title":"10 - Notebook Externo","text":""},{"location":"10_notebook_externo/#seq-101-funcao-remove-acentuacao","title":"SEQ-10.1 - Fun\u00e7\u00e3o Remove Acentua\u00e7\u00e3o","text":"<p>Essa fun\u00e7\u00e3o ela varre a coluna posi\u00e7\u00e3o a posi\u00e7\u00e3o em busca de caracter com acentos para poder substituir.</p> Fun\u00e7\u00e3o Remove Acentua\u00e7\u00e3o<pre><code>def acentuacao(var):\n  De   = \"\u00e1\u00e9\u00ed\u00f3\u00fa\u00e0\u00e8\u00ec\u00f2\u00f9\u00e2\u00ea\u00ee\u00f4\u00fb\u00e3\u00f5\u00e4\u00eb\u00ef\u00f6\u00fc\u00e7\u00f1\u00ff\u00fd\u00c1\u00c9\u00cd\u00d3\u00da\u00c0\u00c8\u00cc\u00d2\u00d9\u00c2\u00ca\u00ce\u00d4\u00db\u00c3\u00d5\u00c4\u00cb\u00cf\u00d6\u00dc\u00c7\u00d1\u0178\u00dd\"\n  Para = \"aeiouaeiouaeiouaoaeioucnyyAEIOUAEIOUAEIOUAOAEIOUCNYY\"\n  Return = \"\"\n  count = 0\n\n  try:\n    while count &lt; len(var):\n      letra = var[count]\n      indice = De.find(letra)\n      count += 1\n      if indice == -1:\n        Return += letra\n      else:\n        Return += Para[indice]\n  except:\n    Return = \"\"\n\n  return Return\n\nspark.udf.register(\"acentuacao\", acentuacao)\n</code></pre> <p>Para conhecer melhor seu funcionamento, deixo o link de um v\u00eddeo do meu canal que explico com maiores detalhes V\u00eddeo Removendo Acentua\u00e7\u00e3o.</p>"},{"location":"10_notebook_externo/#seq-102-funcao-cria-dados-dimensao-tempo","title":"SEQ-10.2 - Fun\u00e7\u00e3o Cria Dados Dimens\u00e3o Tempo","text":"Fun\u00e7\u00e3o Cria\u00e7\u00e3o Dados Dimens\u00e3o Tempo<pre><code>def cria_dimensao_tempo(data_inicial, data_fim, dias_acrescimo):\n\n        inicio = data_inicial\n\n        while data_inicial &lt;= data_fim:\n                v_id_tempo = str(data_inicial.strftime(\"%Y%m%d\"))\n                v_ano = data_inicial.year\n                v_mes = data_inicial.month\n                v_dia = data_inicial.day\n\n                if inicio == data_inicial:\n\n                        spark.sql(fr\"\"\"TRUNCATE TABLE gold.DIM_TEMPO\"\"\")\n\n                data_inicial += dias_acrescimo\n\n                spark.sql(fr\"\"\"\n                        INSERT INTO gold.DIM_TEMPO \n                        (ID_TEMPO\n                        ,DATA\n                        ,ANO\n                        ,MES\n                        ,DIA\n                        ,DATA_CADASTRO\n                        ,DATA_ALTERACAO) \n                        VALUES (sha2(cast({v_id_tempo} AS VARCHAR(10)),256)\n                                ,CAST({v_id_tempo} AS VARCHAR(10))\n                                ,{v_ano}\n                                ,{v_mes}\n                                ,{v_dia}\n                                ,from_utc_timestamp(now(),'GMT-3')\n                                ,from_utc_timestamp(now(),'GMT-3')\n                                );\n                        \"\"\")\n</code></pre>"},{"location":"11_gerar_massa_dados/","title":"Projeto BI Zero TO DW","text":""},{"location":"11_gerar_massa_dados/#11-notebook-externo","title":"11 - Notebook Externo","text":""},{"location":"11_gerar_massa_dados/#seq-111-definindo-as-bibliotecas","title":"SEQ-11.1 - Definindo as Bibliotecas","text":"<p>Selecionado quais bibliotecas ser\u00e3o usadas.</p> Bibliotecas Usadas<pre><code>import numpy as np\nfrom faker import Faker\nimport pandas as pd\nfrom pandas import DataFrame\nfrom datetime import datetime\nfrom datetime import date\nimport random\n</code></pre>"},{"location":"11_gerar_massa_dados/#seq-112-massa-de-dados-fakes-de-pessoas","title":"SEQ-11.2 - Massa de Dados Fakes de Pessoas","text":"Cria\u00e7\u00e3o Massa de Dados Fakes de Pessoas<pre><code>print('01 (DEFINICAO) - CRIA\u00c7\u00c3O DA FUN\u00c7\u00c3O QUE GERA MASSA DE DADOS FAKE')\n\ndef geracao_dados_fake(qtd_rows: int = 100, locale: str = \"pt_BR\") -&gt; DataFrame:\n\n    data_atual = datetime.now()\n    local_faker = Faker(locale)\n    list_result = []\n    for _ in range(qtd_rows):\n        data_nascimento = local_faker.date()\n        dict_result = {\n            \"Nome\": local_faker.name(),\n            \"DataNascimento\": str(data_nascimento),\n            'NumIdade': (data_atual.date() - datetime.strptime(data_nascimento, \"%Y-%m-%d\").date()).days //365,\n            \"NomEndereco\": local_faker.street_name(),\n            \"NumEndereco\": local_faker.building_number(),\n            \"NomCidade\": local_faker.city(),\n            \"NumTelefone\": local_faker.phone_number(),\n            \"NomEmail\": local_faker.ascii_email(),\n            \"NomOcupacao\": local_faker.job()\n        }\n        list_result.append(dict_result)\n\n    return pd.DataFrame(list_result)\n\nprint('02 (INICIO) - PROCESSO DE GERA\u00c7\u00c3O DE DADOS DE PESSOAS FAKE')\n\ndfDadosFake = geracao_dados_fake(1500)\n\narquivo = fr'C:\\Temp\\Python_YT\\Arquivo_Exemplo\\exemplo_pessoas.csv'\n\ndfDadosFake.to_csv(arquivo\n                 , sep=';'\n                 , header=True\n                 , index=False)\n\nprint('02 (FIM) - PROCESSO DE GERA\u00c7\u00c3O DE DADOS DE PESSOAS FAKE')\n</code></pre>"},{"location":"11_gerar_massa_dados/#seq-113-massa-de-dados-de-produtos","title":"SEQ-11.3 - Massa de Dados de Produtos","text":"Cria\u00e7\u00e3o Dataframe de Produtos<pre><code>print('03 (INICIO) - PROCESSO DE GERA\u00c7\u00c3O DE DADOS DE PRODUTOS E CATEGORIAS')\n\ndadosProdutos = [('AB\u00d3BORA', 'Verduras e Legumes', 'Verduras e Legumes')\n,('ACELGA', 'Verduras e Legumes', 'Verduras e Legumes')\n,('AGRI\u00c3O', 'Verduras e Legumes', 'Verduras e Legumes')\n,('ALCACHOFRA', 'Verduras e Legumes', 'Verduras e Legumes')\n,('ALFACE', 'Verduras e Legumes', 'Verduras e Legumes')\n,('ALHO-POR\u00d3', 'Verduras e Legumes', 'Verduras e Legumes')\n,('ALMEIR\u00c3O', 'Verduras e Legumes', 'Verduras e Legumes')\n,('ASPARGO', 'Verduras e Legumes', 'Verduras e Legumes')\n,('BATATA', 'Verduras e Legumes', 'Verduras e Legumes')\n,('BERINJELA', 'Verduras e Legumes', 'Verduras e Legumes')\n,('BERTALHA', 'Verduras e Legumes', 'Verduras e Legumes')\n,('BETERRABA', 'Verduras e Legumes', 'Verduras e Legumes')\n,('BR\u00d3COLIS', 'Verduras e Legumes', 'Verduras e Legumes')\n,('CEBOLA', 'Verduras e Legumes', 'Verduras e Legumes')\n,('CENOURA', 'Verduras e Legumes', 'Verduras e Legumes')\n,('CHIC\u00d3RIA', 'Verduras e Legumes', 'Verduras e Legumes')\n,('CHUCHU', 'Verduras e Legumes', 'Verduras e Legumes')\n,('COUVE', 'Verduras e Legumes', 'Verduras e Legumes')\n,('COUVE\u2013FLOR', 'Verduras e Legumes', 'Verduras e Legumes')\n,('JIL\u00d3', 'Verduras e Legumes', 'Verduras e Legumes')\n,('LENTILHA', 'Verduras e Legumes', 'Verduras e Legumes')\n,('MANDIOCA', 'Verduras e Legumes', 'Verduras e Legumes')\n,('MAXIXE', 'Verduras e Legumes', 'Verduras e Legumes')\n,('MILHO VERDE', 'Verduras e Legumes', 'Verduras e Legumes')\n,('MOSTARDA', 'Verduras e Legumes', 'Verduras e Legumes')\n,('NABO', 'Verduras e Legumes', 'Verduras e Legumes')\n,('PALMITO', 'Verduras e Legumes', 'Verduras e Legumes')\n,('PEPINO', 'Verduras e Legumes', 'Verduras e Legumes')\n,('PIMENT\u00c3O', 'Verduras e Legumes', 'Verduras e Legumes')\n,('QUIABO', 'Verduras e Legumes', 'Verduras e Legumes')\n,('RABANETE', 'Verduras e Legumes', 'Verduras e Legumes')\n,('TOMATE', 'Verduras e Legumes', 'Verduras e Legumes')\n,('VAGEM', 'Verduras e Legumes', 'Verduras e Legumes')\n,('Fil\u00e9 Mignon', 'Carne Boi', 'Carnes')\n,('Maminha', 'Carne Boi', 'Carnes')\n,('Picanha', 'Carne Boi', 'Carnes')\n,('Cox\u00e3o mole', 'Carne Boi', 'Carnes')\n,('Patinho', 'Carne Boi', 'Carnes')\n,('Lagarto', 'Carne Boi', 'Carnes')\n,('Contrafil\u00e9', 'Carne Boi', 'Carnes')\n,('Alcatra', 'Carne Boi', 'Carnes')\n,('Costela', 'Carne Boi', 'Carnes')\n,('Paleta', 'Carne Boi', 'Carnes')\n,('Chuleta', 'Carne Boi', 'Carnes')\n,('Cox\u00e3o Duro', 'Carne Boi', 'Carnes')\n,('Fraldinha', 'Carne Boi', 'Carnes')\n,('Ac\u00e9m', 'Carne Boi', 'Carnes')\n,('M\u00fasculo dianteiro', 'Carne Boi', 'Carnes')\n,('Coxa', 'Carne Frango', 'Carnes')\n,('Coxinha da asa', 'Carne Frango', 'Carnes')\n,('Coxa com sobrecoxa', 'Carne Frango', 'Carnes')\n,('Cora\u00e7\u00e3o', 'Carne Frango', 'Carnes')\n,('Sobrecoxa', 'Carne Frango', 'Carnes')\n,('Sassami', 'Carne Frango', 'Carnes')\n,('Fil\u00e9 de sobrecoxa', 'Carne Frango', 'Carnes')\n,('Fil\u00e9 de peito', 'Carne Frango', 'Carnes')\n,('Salm\u00e3o', 'Carne Peixe', 'Carnes')\n,('Bacalhau', 'Carne Peixe', 'Carnes')\n,('Atum', 'Carne Peixe', 'Carnes')\n,('Sardinha', 'Carne Peixe', 'Carnes')\n,('Merluza', 'Carne Peixe', 'Carnes')\n,('Corvina', 'Carne Peixe', 'Carnes')\n,('Camar\u00e3o', 'Carne Peixe', 'Carnes')\n,('Pescadinha', 'Carne Peixe', 'Carnes')\n,('Johnnie Walker', 'Whisky','Bebidas')\n,('Smirnoff', 'Vodka','Bebidas')\n,('Bacardi', 'Rum','Bebidas')\n,('Jack Daniels', 'Whisky','Bebidas')\n,('Absolut', 'Vodka','Bebidas')\n,('Martini', 'Rum','Bebidas')\n,('Chivas Regal', 'Whisky','Bebidas')\n,('Ballantines', 'Whisky','Bebidas')\n,('Mo\u00ebt &amp; Chandon', 'Champagne','Bebidas')\n,('Gordons', 'Gin','Bebidas')\n,('Grants', 'Whisky','Bebidas')\n,('Skyy', 'Vodka','Bebidas')\n,('C\u00eeroc', 'Vodka','Bebidas')\n,('Malibu', 'Rum','Bebidas')\n,('Tanqueray', 'Gin','Bebidas')\n,('Coca-Cola', 'Refrigerante','Bebidas')\n,('Coca-Cola Zero', 'Refrigerante','Bebidas')\n,('Guaran\u00e1 Antarctica', 'Refrigerante','Bebidas')\n,('Mineirinho', 'Refrigerante','Bebidas')\n,('Pepsi', 'Refrigerante','Bebidas')\n,('Pepsi Zero', 'Refrigerante','Bebidas')\n,('Pepsi Twister', 'Refrigerante','Bebidas')\n,('Fanta Laranja', 'Refrigerante','Bebidas')\n,('Fanta Uva', 'Refrigerante','Bebidas')\n,('Sprite', 'Refrigerante','Bebidas')\n,('Sprite Zero', 'Refrigerante','Bebidas')\n,('Kuat', 'Refrigerante','Bebidas')]\n\ndfProdutos = pd.DataFrame(dadosProdutos, columns=['DESCRICAO_PRODUTO' ,'TIPO_PRODUTO',  'CATEGORIA_PRODUTO'])\n\ndfProdutos = dfProdutos.sort_values(by=['CATEGORIA_PRODUTO','DESCRICAO_PRODUTO'])\n\ndfProdutos = dfProdutos.reset_index()\n\ndfProdutos['CODIGO_PRODUTO'] = np.arange(1, len(dfProdutos) + 1)\n\nprint('03.1 (INICIO) - GERA\u00c7\u00c3O DE DADOS DE CATEGORIA DE PRODUTOS')\n\ndfCategoriaProduto =  pd.DataFrame(columns=['CODIGO_CATEGORIA','CATEGORIA_PRODUTO','SUB_CATEGORIA_PRODUTO'])\n\ndfCategoriaProduto_temp = pd.DataFrame()\n\nlistaCategoriaProduto = dfProdutos[['CATEGORIA_PRODUTO','TIPO_PRODUTO']].drop_duplicates()\n\ncodigo_categoria = 1\n\ntype(listaCategoriaProduto)\n\n#for coluna in listaCategoriaProduto.columns:\n\nfor index, row in listaCategoriaProduto.iterrows():\n\n    print(row['CATEGORIA_PRODUTO'])\n    print(row['TIPO_PRODUTO'])\n\n    dfCategoriaProduto_temp = pd.DataFrame({'CODIGO_CATEGORIA': [int(codigo_categoria)]\n                                                ,'CATEGORIA_PRODUTO': [str(row['CATEGORIA_PRODUTO'])]\n                                                ,'SUB_CATEGORIA_PRODUTO': [str(row['TIPO_PRODUTO'])]}\n                                                )\n\n    dfCategoriaProduto = dfCategoriaProduto.append(dfCategoriaProduto_temp)\n\n    codigo_categoria += 1\n\ndfCategoriaProduto.to_csv(fr'C:\\Temp\\Python_YT\\Git\\Projeto_BI_Zero_TO_DW\\01_SCRIPT_SQL\\DADOS_BASE\\08_categoria_produtos.csv'\n                  ,sep=';'\n                  ,header=True\n                  ,index=False)\n\nprint('03.1 (FIM) - GERA\u00c7\u00c3O DE DADOS DE CATEGORIA DE PRODUTOS')\n\nprint('03.2 (INICIO) - GERA\u00c7\u00c3O DE DADOS DE PRODUTOS')\n\ndfProdutos = pd.merge(dfProdutos\n                      , dfCategoriaProduto\n                              ,how='inner'\n                              ,left_on=['CATEGORIA_PRODUTO','TIPO_PRODUTO']\n                              ,right_on=['CATEGORIA_PRODUTO','SUB_CATEGORIA_PRODUTO']\n                      )[['CODIGO_PRODUTO'\n                        ,'DESCRICAO_PRODUTO'\n                        ,'CODIGO_CATEGORIA']]\n\ndfProdutos.to_csv(fr'C:\\Temp\\Python_YT\\Git\\Projeto_BI_Zero_TO_DW\\01_SCRIPT_SQL\\DADOS_BASE\\02_produtos.csv'\n                  ,sep=';'\n                  ,header=True\n                  ,index=False)\n\nprint('03.2 (FIM) - GERA\u00c7\u00c3O DE DADOS DE PRODUTOS')\n\nprint('03 (INICIO) - PROCESSO DE GERA\u00c7\u00c3O DE DADOS DE PRODUTOS E CATEGORIAS')\n</code></pre>"},{"location":"11_gerar_massa_dados/#seq-114-massa-de-dados-de-cliente","title":"SEQ-11.4 - Massa de Dados de Cliente","text":"Cria\u00e7\u00e3o Dataframe de Clientes<pre><code>print('04 (INICIO) - PROCESSO GERA\u00c7\u00c3O DE DADOS DE CLIENTES')\n\ndf = pd.read_csv(f'C:\\Temp\\Python_YT\\Arquivo_Exemplo\\exemplo_pessoas.csv' , sep=';')\n\ndfPessoas = df.loc[1:1398,['Nome','DataNascimento','NumIdade','NomEndereco','NumEndereco','NomCidade','NumTelefone','NomEmail','NomOcupacao']]\n\ndfPessoas = dfPessoas.rename(columns={'Nome':'NOME_CLIENTE'\n                                      ,'DataNascimento':'DATA_NASCIMENTO'\n                                      ,'NumIdade':'IDADE_CLIENTE'\n                                      ,'NomEndereco':'DESCRICAO_ENDERECO'\n                                      ,'NumEndereco':'NUMERO_ENDERECO'\n                                      ,'NomCidade':'NOME_CIDADE'\n                                      ,'NumTelefone':'NUMERO_TELEFONE'\n                                      ,'NomEmail':'EMAIL_CLIENTE'\n                                      ,'NomOcupacao':'OCUPACAO_CLIENTE'})\n\ndfPessoas = dfPessoas.sort_values(by='NOME_CLIENTE')\n\ndfPessoas['CODIGO_CLIENTE'] = np.arange(1, len(dfPessoas) + 1)\n\ndfPessoas = dfPessoas[['CODIGO_CLIENTE'\n                        ,'NOME_CLIENTE'\n                        ,'DATA_NASCIMENTO'\n                        ,'IDADE_CLIENTE'\n                        ,'DESCRICAO_ENDERECO'\n                        ,'NUMERO_ENDERECO'\n                        ,'NOME_CIDADE'\n                        ,'NUMERO_TELEFONE'\n                        ,'EMAIL_CLIENTE'\n                        ,'OCUPACAO_CLIENTE']]\n\ndfPessoas.to_csv(fr'C:\\Temp\\Python_YT\\Git\\Projeto_BI_Zero_TO_DW\\01_SCRIPT_SQL\\DADOS_BASE\\01_clientes.csv'\n                  ,sep=';'\n                  ,header=True\n                  ,index=False)\n\nprint('04 (FIM) - PROCESSO GERA\u00c7\u00c3O DE DADOS DE CLIENTES')\n</code></pre>"},{"location":"11_gerar_massa_dados/#seq-115-massa-de-dados-de-vendedor","title":"SEQ-11.5 - Massa de Dados de Vendedor","text":"Cria\u00e7\u00e3o Dataframe de Vendedores<pre><code>print('05 (INICIO) - PROCESSO GERA\u00c7\u00c3O DE DADOS DE VENDEDORES')\n\ndfPessoasVendedor = df.loc[1400:1438,['Nome']] #.sort_values(by=['Nome'])\ndfVendedor = pd.DataFrame(columns=['CODIGO_VENDEDOR','NOME_VENDEDOR'])\n\ndfVendedor_ecommerce = pd.DataFrame({'CODIGO_VENDEDOR': [0]\n                                            ,'NOME_VENDEDOR':['E-Commerce']})\n\ndfVendedor = dfVendedor.append(dfVendedor_ecommerce, ignore_index=True)\n\ncodigo_vendedor_inicial = 1\ncodigo_vendedor_final = len(dfVendedor)-1\n\nfor vendedor in dfPessoasVendedor['Nome']:\n\n    dados = [{'CODIGO_VENDEDOR' : codigo_vendedor_inicial,'NOME_VENDEDOR': vendedor}]       \n\n    df1 = pd.DataFrame(dados)   \n\n    dfVendedor =  pd.concat([dfVendedor, df1])\n\n    codigo_vendedor_inicial = codigo_vendedor_inicial + 1  \n\ndfVendedor.set_index('CODIGO_VENDEDOR', inplace=True)\n\ndfVendedor.reset_index(inplace=True)\n\ndfVendedor.to_csv(fr'C:\\Temp\\Python_YT\\Git\\Projeto_BI_Zero_TO_DW\\01_SCRIPT_SQL\\DADOS_BASE\\03_vendedores.csv'\n                  ,sep=';'\n                  ,header=True\n                  ,index=False)\n\nprint('05 (FIM) - PROCESSO GERA\u00c7\u00c3O DE DADOS DE VENDEDORES')\n</code></pre>"},{"location":"11_gerar_massa_dados/#seq-116-massa-de-dados-de-forma-de-pagamento","title":"SEQ-11.6 - Massa de Dados de Forma de Pagamento","text":"Cria\u00e7\u00e3o Dataframe de Forma de Pagamento<pre><code>print('06 (INICIO) - PROCESSO GERA\u00c7\u00c3O DE DADOS DE FORMA DE PAGAMENTO')\n\ndadosFormaPagamento = ['CART\u00c3O D\u00c9BITO'\n,'PIX'\n,'CART\u00c3O CR\u00c9DITO'\n,'BOLETO']\n\ndfFormaPagamento = pd.DataFrame(dadosFormaPagamento, columns=['DESCRICAO_FORMA_PAGAMENTO'])\n\ndfFormaPagamento['CODIGO_FORMA_PAGAMENTO'] = np.arange(1, len(dfFormaPagamento) + 1)\n\ndfFormaPagamento.to_csv(fr'C:\\Temp\\Python_YT\\Git\\Projeto_BI_Zero_TO_DW\\01_SCRIPT_SQL\\DADOS_BASE\\05_forma_pagamento.csv'\n                  ,sep=';'\n                  ,header=True\n                  ,index=False)\n\nprint('06 (FIM) - PROCESSO GERA\u00c7\u00c3O DE DADOS DE FORMA DE PAGAMENTO')\n</code></pre>"},{"location":"11_gerar_massa_dados/#seq-117-massa-de-dados-de-loja","title":"SEQ-11.7 - Massa de Dados de Loja","text":"Cria\u00e7\u00e3o Dataframe de Loja<pre><code>print('07 (INICIO) - PROCESSO GERA\u00c7\u00c3O DE DADOS DE LOJAS')\n\ndadosloja = [\n('E-COMMERCE','WWW','VIRTUAL'),\n('LOJA A','MT','F\u00cdSICA'),\n('LOJA B','RJ','F\u00cdSICA'),\n('LOJA C','CE','F\u00cdSICA')\n]\n\nlista_vendedores = []\n\ndfLoja = pd.DataFrame(dadosloja, columns=['NOME_LOJA', 'LOCALIDADE_LOJA', 'TIPO_LOJA'])\n\ndfLoja['CODIGO_LOJA'] = np.arange(1, len(dfLoja) + 1)\n\ndfLojaFinal = pd.DataFrame(columns=['CODIGO_LOJA','NOME_LOJA', 'LOCALIDADE_LOJA', 'TIPO_LOJA', 'CODIGO_VENDEDOR'])\n\nfor index in dfLoja.index:\n\n    print(index)\n\n    if dfLoja['NOME_LOJA'][index] == 'E-COMMERCE':\n\n        dfLojaFinal_vendedor = pd.DataFrame({'CODIGO_LOJA': [dfLoja['CODIGO_LOJA'][index]]\n                                            ,'NOME_LOJA': [dfLoja['NOME_LOJA'][index]]\n                                            ,'LOCALIDADE_LOJA':[dfLoja['LOCALIDADE_LOJA'][index]]\n                                            ,'TIPO_LOJA':[dfLoja['TIPO_LOJA'][index]]\n                                            ,'CODIGO_VENDEDOR':[0]}\n                                            )\n\n        dfLojaFinal =  pd.concat([dfLojaFinal, dfLojaFinal_vendedor])\n\n    else:\n\n        indice_vendedor_randomico = np.random.choice(dfVendedor[dfVendedor['CODIGO_VENDEDOR'] != 0].index, size = random.randint(5, 9) , replace=False)\n\n        for ivr in indice_vendedor_randomico:\n\n            if ivr not in lista_vendedores:\n\n                dfLojaFinal_vendedor = pd.DataFrame({'CODIGO_LOJA': [dfLoja['CODIGO_LOJA'][index]]\n                                                    ,'NOME_LOJA': [dfLoja['NOME_LOJA'][index]]\n                                                    ,'LOCALIDADE_LOJA':[dfLoja['LOCALIDADE_LOJA'][index]]\n                                                    ,'TIPO_LOJA':[dfLoja['TIPO_LOJA'][index]]\n                                                    ,'CODIGO_VENDEDOR':[ivr]}\n                                                    )\n\n                dfLojaFinal =  pd.concat([dfLojaFinal, dfLojaFinal_vendedor])                   \n\n                lista_vendedores.append(ivr)    \n\ndfLojaFinal = dfLojaFinal[['CODIGO_LOJA'\n                          , 'CODIGO_VENDEDOR'\n                          , 'NOME_LOJA'\n                          , 'LOCALIDADE_LOJA'\n                          , 'TIPO_LOJA']].sort_values(by=['CODIGO_LOJA','CODIGO_VENDEDOR'], ascending=[True, True])\n\ndfLojaFinal['CODIGO_LOJA_VENDEDOR'] = np.arange(0, len(dfLojaFinal))\n\ndfLojaFinal[['CODIGO_LOJA_VENDEDOR'\n            , 'CODIGO_LOJA'\n            , 'CODIGO_VENDEDOR'\n            , 'NOME_LOJA'\n            , 'LOCALIDADE_LOJA'\n            , 'TIPO_LOJA']].to_csv(fr'C:\\Temp\\Python_YT\\Git\\Projeto_BI_Zero_TO_DW\\01_SCRIPT_SQL\\DADOS_BASE\\04_lojas.csv'\n                  ,sep=';'\n                  ,header=True\n                  ,index=False)\n\ndfLojaFinal = dfLojaFinal.reset_index()\n\nprint('07 (FIM) - PROCESSO GERA\u00c7\u00c3O DE DADOS DE LOJAS')\n</code></pre>"},{"location":"11_gerar_massa_dados/#seq-118-massa-de-dados-de-venda","title":"SEQ-11.8 - Massa de Dados de Venda","text":"Cria\u00e7\u00e3o Dataframe de Venda<pre><code>print('08 (INICIO) - PROCESSO GERA\u00c7\u00c3O DE DADOS DE VENDAS')\n\ndfFinal = pd.DataFrame(columns=['CODIGO_VENDA'\n                    ,'DATA_VENDA'\n                    ,'CODIGO_CLIENTE'\n                    ,'NOME_CLIENTE'\n                    ,'CODIGO_PRODUTO'\n                    ,'DESCRICAO_PRODUTO'\n                    ,'CODIGO_CATEGORIA'\n                    ,'TIPO_PRODUTO'\n                    ,'CODIGO_LOJA_VENDEDOR'\n                    ,'NOME_VENDEDOR'\n                    ,'CODIGO_LOJA'\n                    ,'NOME_LOJA'\n                    ,'LOCALIDADE_LOJA'\n                    ,'TIPO_LOJA'\n                    ,'VALOR_UNITARIO'\n                    ,'QUANTIDADE'\n                    ,'VALOR_FINAL'\n                    ,'TIPO_PAGAMENTO'])\n\ncodigo_venda_inicial = 1\ncodigo_venda_final = 2542 #43209\n\nwhile codigo_venda_final &gt; 0:\n\n    print('codigo_venda_final: ' + str(codigo_venda_final))\n\n    data_inicio = pd.to_datetime('2017-01-02')\n    data_fim = pd.to_datetime(date.today().isoformat())\n\n    pessoa = int(np.random.choice(dfPessoas.index, size = 1 , replace=False))\n    indice_randomico_vendedor = int(np.random.choice(dfVendedor.index, size = 1 , replace=False))\n    indice_randomico_forma_pagamento = int(np.random.choice(dfFormaPagamento.index, size = 1 , replace=False))    \n\n    indice_randomico_loja = int(np.random.choice(dfLojaFinal.index, size = 1 , replace=False))    \n\n    v_vendedor = dfVendedor['NOME_VENDEDOR'][indice_randomico_vendedor]\n    v_codigo_vendedor = dfVendedor['CODIGO_VENDEDOR'][indice_randomico_vendedor]\n\n    v_codigo_loja = dfLojaFinal['CODIGO_LOJA_VENDEDOR'][indice_randomico_loja]\n\n    v_loja = dfLojaFinal['NOME_LOJA'][indice_randomico_loja]\n    v_lojalocalidade = dfLojaFinal['LOCALIDADE_LOJA'][indice_randomico_loja]   \n    v_lojatipo = dfLojaFinal['TIPO_LOJA'][indice_randomico_loja]       \n    v_formaPagamento = dfFormaPagamento['DESCRICAO_FORMA_PAGAMENTO'][indice_randomico_forma_pagamento]\n    v_codigo_formaPagamento = dfFormaPagamento['CODIGO_FORMA_PAGAMENTO'][indice_randomico_forma_pagamento]\n\n    v_pessoa = dfPessoas['NOME_CLIENTE'][pessoa]\n    v_codigo_cliente = dfPessoas['CODIGO_CLIENTE'][pessoa]\n\n    indice_randomico = np.random.choice(dfProdutos.index, size = random.randint(1, 10) , replace=False)    \n\n    p_data_venda = pd.to_datetime(np.random.uniform(data_inicio.value, data_fim.value, size=365))\n\n    if v_codigo_loja == 0:\n\n        v_data_venda = p_data_venda[0].strftime(\"%Y-%m-%d %H:%M:%S\")\n\n    elif v_codigo_loja != 1:\n\n        hora = int(random.uniform(9, 18))\n        minuto = int(random.uniform(0, 59))\n        segundo = int(random.uniform(0, 59))\n\n        data = str(p_data_venda[0].year) + '-' + str(p_data_venda[0].month).zfill(2) + '-' + str(p_data_venda[0].day).zfill(2) + ' ' + str(hora).zfill(2) + ':' + str(minuto).zfill(2) + ':' + str(segundo).zfill(2)\n\n        v_data_venda = datetime.strptime(data, \"%Y-%m-%d %H:%M:%S\")\n\n    tipo_pagamento = random.randint(1, 4)\n\n    if tipo_pagamento == 3:\n\n        v_tipo_pagamento = 'PARCELADO'\n\n    else:\n\n        v_tipo_pagamento = 'A VISTA'        \n\n    for i in indice_randomico:\n\n        if dfProdutos['CODIGO_CATEGORIA'][i] == 3: #'Whisky':\n\n            valor_min = 89.98\n            valor_max = 179.99\n\n            valor = np.random.uniform(valor_min, valor_max, size=1)\n\n        elif dfProdutos['CODIGO_CATEGORIA'][i] == 1: #'Vodka':\n\n            valor_min = 35.99\n            valor_max = 99.99\n\n            valor = np.random.uniform(valor_min, valor_max, size=1)\n\n        elif dfProdutos['CODIGO_CATEGORIA'][i] == 4: #'Refrigerante':\n\n            valor_min = 6.00\n            valor_max = 9.99\n\n            valor = np.random.uniform(valor_min, valor_max, size=1)\n\n        elif dfProdutos['CODIGO_CATEGORIA'][i] == 2: #'Rum':\n\n            valor_min = 69.00\n            valor_max = 99.99\n\n            valor = np.random.uniform(valor_min, valor_max, size=1)\n\n        elif dfProdutos['CODIGO_CATEGORIA'][i] == 6: #'Champagne':\n\n            valor_min = 115.00\n            valor_max = 159.99\n\n            valor = np.random.uniform(valor_min, valor_max, size=1)            \n\n        elif dfProdutos['CODIGO_CATEGORIA'][i] == 5: #'Gin':\n\n            valor_min = 99.00\n            valor_max = 119.99\n\n            valor = np.random.uniform(valor_min, valor_max, size=1)    \n\n        elif dfProdutos['CODIGO_CATEGORIA'][i] == 10: #'Verduras e Legumes':\n\n            valor_min = 0.99\n            valor_max = 5.99\n\n            valor = np.random.uniform(valor_min, valor_max, size=1)    \n\n        elif dfProdutos['CODIGO_CATEGORIA'][i] == 7: #'Carne Boi':\n\n            valor_min = 29.99\n            valor_max = 75.99\n\n            valor = np.random.uniform(valor_min, valor_max, size=1) \n\n        elif dfProdutos['CODIGO_CATEGORIA'][i] == 9: #'Carne Frango':\n\n            valor_min = 14.99\n            valor_max = 29.99\n\n            valor = np.random.uniform(valor_min, valor_max, size=1) \n\n        elif dfProdutos['CODIGO_CATEGORIA'][i] ==  8: #'Carne Peixe':\n\n            valor_min = 29.99\n            valor_max = 85.99\n\n            valor = np.random.uniform(valor_min, valor_max, size=1)             \n\n        else:\n\n            valor_min = 0.99\n            valor_max = 7.99\n\n            valor = np.random.uniform(valor_min, valor_max, size=1)            \n\n        v_quantidade = int(np.random.randint(1, 10, size=1))\n\n        v_produto = dfProdutos['DESCRICAO_PRODUTO'][i]\n        v_codigo_produto = dfProdutos['CODIGO_PRODUTO'][i]\n        v_tipo_produto = dfProdutos['CODIGO_CATEGORIA'][i]\n\n        dados = [{ 'CODIGO_VENDA' : codigo_venda_inicial\n                    ,'DATA_VENDA': str(v_data_venda)\n                    ,'CODIGO_CLIENTE': v_codigo_cliente\n                    ,'NOME_CLIENTE': v_pessoa\n                    ,'CODIGO_PRODUTO' : v_codigo_produto\n                    ,'DESCRICAO_PRODUTO' : v_produto\n                    ,'CODIGO_VENDEDOR': v_codigo_vendedor\n                    ,'NOME_VENDEDOR' : v_vendedor\n                    ,'CODIGO_LOJA_VENDEDOR': v_codigo_loja\n                    ,'NOME_LOJA': v_loja\n                    ,'LOCALIDADE_LOJA': v_lojalocalidade\n                    ,'TIPO_LOJA': v_lojatipo\n                    ,'VALOR_UNITARIO': round(float(valor),2)\n                    ,'QUANTIDADE': v_quantidade\n                    ,'VALOR_FINAL': round((round(float(valor),2) * v_quantidade),2)\n                    ,'FORMA_PAGAMENTO' : int(v_codigo_formaPagamento)\n                    ,'TIPO_PAGAMENTO' : v_tipo_pagamento}]       \n\n        df = pd.DataFrame(dados)\n\n        dfFinal =  pd.concat([dfFinal, df])\n\n    codigo_venda_inicial = codigo_venda_inicial + 1\n\n    codigo_venda_final = codigo_venda_final - 1\n\nprint('08 (FIM) - PROCESSO GERA\u00c7\u00c3O DE DADOS DE VENDAS')\n\nprint('09 (INICIO) - PROCESSO GERA\u00c7\u00c3O DE DADOS DE VENDAS')\n\ndfVenda = (dfFinal.groupby(['CODIGO_VENDA'\n                            ,'DATA_VENDA'\n                            ,'CODIGO_CLIENTE'\n                            ,'CODIGO_LOJA_VENDEDOR'\n                            ,'FORMA_PAGAMENTO'\n                            ,'TIPO_PAGAMENTO'], as_index=False)\n                .agg(VALOR_FINAL=('VALOR_FINAL','sum'))\n                     .sort_values(by=['DATA_VENDA','CODIGO_VENDA'])\n                     .reset_index(drop=True))\n\ndfVenda.to_csv(fr'C:\\Temp\\Python_YT\\Git\\Projeto_BI_Zero_TO_DW\\01_SCRIPT_SQL\\DADOS_BASE\\06_vendas.csv'\n                  ,sep=';'\n                  ,header=True\n                  ,index=False)\n\nprint('09 (FIM) - PROCESSO GERA\u00c7\u00c3O DE DADOS DE VENDAS')\n\nprint('10 (INICIO) - PROCESSO GERA\u00c7\u00c3O DE DADOS DE ITENS DE VENDAS')\n\ndfItemVenda = (dfFinal.groupby(['CODIGO_VENDA', 'CODIGO_PRODUTO'], as_index=False)\n                .agg(VALOR_UNITARIO=('VALOR_UNITARIO','sum')\n                     ,QUANTIDADE=('QUANTIDADE','sum')\n                     ,VALOR_FINAL=('VALOR_FINAL','sum'))\n                     .sort_values(by=['CODIGO_VENDA', 'CODIGO_PRODUTO'])\n                     .reset_index(drop=True))\n\ndfItemVenda.to_csv(fr'C:\\Temp\\Python_YT\\Git\\Projeto_BI_Zero_TO_DW\\01_SCRIPT_SQL\\DADOS_BASE\\07_item_vendas.csv'\n                  ,sep=';'  \n                  ,header=True\n                  ,index=False)\n\nprint('10 (FIM) - PROCESSO GERA\u00c7\u00c3O DE DADOS DE ITENS DE VENDAS')\n</code></pre>"},{"location":"12_carga_sql_server_relacional/","title":"Projeto BI Zero TO DW","text":""},{"location":"12_carga_sql_server_relacional/#12-notebook-carga-de-dados-no-axure-sql-server","title":"12 - Notebook Carga de Dados no Axure SQL Server","text":""},{"location":"12_carga_sql_server_relacional/#seq-121-definindo-as-bibliotecas","title":"SEQ-12.1 - Definindo as Bibliotecas","text":"<p>Selecionado quais bibliotecas ser\u00e3o usadas.</p> Bibliotecas Usadas<pre><code>import pandas as pd\nfrom sqlalchemy import create_engine\nimport pyodbc\nimport os\n\nserver = 'localhost\\DBAASSISTS'\ndatabase = 'TREINAMENTO' \nusername = 'usr_treinamento' \npassword = 'Tr&amp;in@M&amp;nT0SQL2024!' \ndriver = 'SQL Server'\n</code></pre>"},{"location":"12_carga_sql_server_relacional/#seq-122-carga-de-clientes","title":"SEQ-12.2 - Carga de Clientes","text":"Carga de Clientes<pre><code>print('01 (INICIO) - CARGA DE DADOS DE CLIENTES')\n\ndiretorio = fr'C:\\Temp\\Python_YT\\Git\\Projeto_BI_Zero_TO_DW\\01_SCRIPT_SQL\\DADOS_BASE\\01_clientes.csv'\n\ndfcliente = pd.read_csv(diretorio\n                    ,sep=';')\n\nwith pyodbc.connect('DRIVER={'+driver+'};SERVER='+server+';DATABASE='+database+';UID='+username+';PWD='+ password) as conn:\n\n    with conn.cursor() as cursor:\n\n        cursor.execute(fr\"\"\"\n                        TRUNCATE TABLE dbo.TB_ITEM_VENDA;\n                        DELETE FROM dbo.TB_VENDA;\n                        DELETE FROM dbo.TB_CLIENTE;\n                        \"\"\")\n\n        for i, coluna in dfcliente.iterrows():\n\n            cursor.execute(fr\"\"\"\n                        SET IDENTITY_INSERT dbo.TB_CLIENTE ON;  \n                        INSERT INTO dbo.TB_CLIENTE (CODIGO_CLIENTE\n                                                    ,NOME_CLIENTE\n                                                    ,DATA_NASCIMENTO\n                                                    ,IDADE_CLIENTE\n                                                    ,DESCRICAO_ENDERECO\n                                                    ,NUMERO_ENDERECO\n                                                    ,NOME_CIDADE\n                                                    ,NUMERO_TELEFONE\n                                                    ,EMAIL_CLIENTE\n                                                    ,OCUPACAO_CLIENTE) \n                                                    VALUES \n                                                    ({coluna['CODIGO_CLIENTE']} \n                                                    ,'{coluna['NOME_CLIENTE']}'\n                                                    ,'{coluna['DATA_NASCIMENTO']}'\n                                                    ,'{coluna['IDADE_CLIENTE']}'\n                                                    ,'{coluna['DESCRICAO_ENDERECO']}'\n                                                    ,'{coluna['NUMERO_ENDERECO']}'\n                                                    ,'{coluna['NOME_CIDADE']}'\n                                                    ,'{coluna['NUMERO_TELEFONE']}'\n                                                    ,'{coluna['EMAIL_CLIENTE']}'\n                                                    ,'{coluna['OCUPACAO_CLIENTE']}'\n                                                    )\n                        SET IDENTITY_INSERT dbo.TB_CLIENTE OFF;\n                        \"\"\")\n\nprint('01 (FIM) - CARGA DE DADOS DE CLIENTES')\n</code></pre>"},{"location":"12_carga_sql_server_relacional/#seq-123-carga-de-vendedores","title":"SEQ-12.3 - Carga de Vendedores","text":"Carga de Vendedores<pre><code>print('02 (INICIO) - CARGA DE DADOS DE VENDEDORES')\n\ndfvendedor = pd.read_csv(fr'C:\\Temp\\Python_YT\\Git\\Projeto_BI_Zero_TO_DW\\01_SCRIPT_SQL\\DADOS_BASE\\03_vendedores.csv'\n                        ,sep=';')\n\nwith pyodbc.connect('DRIVER={'+driver+'};SERVER='+server+';DATABASE='+database+';UID='+username+';PWD='+ password) as conn:\n\n    with conn.cursor() as cursor:\n\n        cursor.execute(fr\"\"\"DELETE FROM dbo.TB_LOJA;\n                       DELETE FROM dbo.TB_VENDEDOR;\n                       \"\"\")\n\n        for i, coluna in dfvendedor.iterrows():\n\n            cursor.execute(fr\"\"\"\n                        SET IDENTITY_INSERT dbo.TB_VENDEDOR ON;  \n                        INSERT INTO dbo.TB_VENDEDOR \n                        (CODIGO_VENDEDOR\n                        ,NOME_VENDEDOR) \n                        VALUES (\n                           {coluna['CODIGO_VENDEDOR']} \n                        , '{coluna['NOME_VENDEDOR']}'\n                        )\n                        SET IDENTITY_INSERT dbo.TB_VENDEDOR OFF;  \n                        \"\"\")\n\nprint('02 (FIM) - CARGA DE DADOS DE VENDEDORES') \n</code></pre>"},{"location":"12_carga_sql_server_relacional/#seq-124-carga-de-lojas","title":"SEQ-12.4 - Carga de Lojas","text":"Carga de Lojas<pre><code>print('03 (INICIO) - CARGA DE DADOS DE LOJAS')\n\ndfloja = pd.read_csv(fr'C:\\Temp\\Python_YT\\Git\\Projeto_BI_Zero_TO_DW\\01_SCRIPT_SQL\\DADOS_BASE\\04_lojas.csv'\n                        ,sep=';')\n\nwith pyodbc.connect('DRIVER={'+driver+'};SERVER='+server+';DATABASE='+database+';UID='+username+';PWD='+ password) as conn:\n    with conn.cursor() as cursor:\n\n        cursor.execute(fr\"\"\"\n                        DELETE FROM dbo.TB_LOJA;\n                        \"\"\")\n\n        for i, coluna in dfloja.iterrows():\n\n            cursor.execute(fr\"\"\"\n                        SET IDENTITY_INSERT dbo.TB_LOJA ON;\n                        INSERT INTO dbo.TB_LOJA \n                        (CODIGO_LOJA_VENDEDOR\n                        ,CODIGO_LOJA\n                        ,CODIGO_VENDEDOR\n                        ,NOME_LOJA\n                        ,LOCALIDADE_LOJA\n                        ,TIPO_LOJA) \n                        VALUES (\n                        {coluna['CODIGO_LOJA_VENDEDOR']}\n                        , {coluna['CODIGO_LOJA']}\n                        , {coluna['CODIGO_VENDEDOR']}\n                        , '{coluna['NOME_LOJA']}' \n                        , '{coluna['LOCALIDADE_LOJA']}'\n                        , '{coluna['TIPO_LOJA']}')\n                        SET IDENTITY_INSERT dbo.TB_LOJA OFF;\n                        \"\"\")\n\nprint('03 (FIM) - CARGA DE DADOS DE LOJAS') \n</code></pre>"},{"location":"12_carga_sql_server_relacional/#seq-125-carga-de-categoria-de-produtos","title":"SEQ-12.5 - Carga de Categoria de Produtos","text":"Carga de Categoria de Produtos<pre><code>print('04 (INICIO) - CARGA DE DADOS DE CATEGORIA PRODUTOS')\n\ndfCategoriaProduto = pd.read_csv(fr'C:\\Temp\\Python_YT\\Git\\Projeto_BI_Zero_TO_DW\\01_SCRIPT_SQL\\DADOS_BASE\\08_categoria_produtos.csv'\n                        ,sep=';')\n\nwith pyodbc.connect('DRIVER={'+driver+'};SERVER='+server+';DATABASE='+database+';UID='+username+';PWD='+ password) as conn:\n\n    with conn.cursor() as cursor:\n\n        cursor.execute(fr\"\"\"\n                        DELETE FROM dbo.TB_PRODUTO;\n                        DELETE FROM dbo.TB_CATEGORIA_PRODUTO;\n                        \"\"\")\n\n        for i, coluna in dfCategoriaProduto.iterrows():\n\n            cursor.execute(fr\"\"\"\n                        SET IDENTITY_INSERT dbo.TB_CATEGORIA_PRODUTO ON;  \n                        INSERT INTO dbo.TB_CATEGORIA_PRODUTO \n                           (CODIGO_CATEGORIA\n                           ,CATEGORIA_PRODUTO\n                           ,SUB_CATEGORIA_PRODUTO) \n                        VALUES (\n                           {coluna['CODIGO_CATEGORIA']} \n                        , '{coluna['CATEGORIA_PRODUTO']}'\n                        , '{coluna['SUB_CATEGORIA_PRODUTO']}'\n                        )\n                        SET IDENTITY_INSERT dbo.TB_CATEGORIA_PRODUTO OFF;  \n                        \"\"\")\n\nprint('04 (FIM) - CARGA DE DADOS DE CATEGORIA PRODUTOS')\n</code></pre>"},{"location":"12_carga_sql_server_relacional/#seq-126-carga-de-produtos","title":"SEQ-12.6 - Carga de Produtos","text":"<p>Selecionado quais bibliotecas ser\u00e3o usadas.</p> Carga de Produtos<pre><code>print('05 (INICIO) - CARGA DE DADOS DE PRODUTOS')\n\ndfproduto = pd.read_csv(fr'C:\\Temp\\Python_YT\\Git\\Projeto_BI_Zero_TO_DW\\01_SCRIPT_SQL\\DADOS_BASE\\02_produtos.csv'\n                        ,sep=';')\n\nwith pyodbc.connect('DRIVER={'+driver+'};SERVER='+server+';DATABASE='+database+';UID='+username+';PWD='+ password) as conn:\n\n    with conn.cursor() as cursor:\n\n        cursor.execute(fr\"\"\"DELETE FROM dbo.TB_PRODUTO;\"\"\")\n\n        for i, coluna in dfproduto.iterrows():\n\n            cursor.execute(fr\"\"\"\n                        SET IDENTITY_INSERT dbo.TB_PRODUTO ON;  \n                        INSERT INTO dbo.TB_PRODUTO \n                           (CODIGO_PRODUTO\n                           , DESCRICAO_PRODUTO\n                           , CODIGO_CATEGORIA) \n                        VALUES (\n                           {coluna['CODIGO_PRODUTO']} \n                        , '{coluna['DESCRICAO_PRODUTO']}'\n                        , '{coluna['CODIGO_CATEGORIA']}'\n                        )\n                        SET IDENTITY_INSERT dbo.TB_PRODUTO OFF;  \n                        \"\"\")\n\nprint('05 (FIM) - CARGA DE DADOS DE PRODUTOS')   \n</code></pre>"},{"location":"12_carga_sql_server_relacional/#seq-127-carga-de-formas-de-pagamento","title":"SEQ-12.7 - Carga de Formas de Pagamento","text":"<p>Selecionado quais bibliotecas ser\u00e3o usadas.</p> Carga de Formas Pagamento<pre><code>print('06 (INICIO) - CARGA DE DADOS DE FORMA PAGAMENTO')\n\ndfforma_pagamento = pd.read_csv(fr'C:\\Temp\\Python_YT\\Git\\Projeto_BI_Zero_TO_DW\\01_SCRIPT_SQL\\DADOS_BASE\\05_forma_pagamento.csv'\n                        ,sep=';')\n\n#with pyodbc.connect('DRIVER='+driver+';SERVER=tcp:'+server+';PORT=1433;DATABASE='+database+';UID='+username+';PWD='+ password) as conn:\n\nwith pyodbc.connect('DRIVER={'+driver+'};SERVER='+server+';DATABASE='+database+';UID='+username+';PWD='+ password) as conn:\n\n    with conn.cursor() as cursor:\n\n        cursor.execute(fr\"\"\"DELETE FROM dbo.TB_FORMA_PAGAMENTO;\"\"\")        \n\n        for i, coluna in dfforma_pagamento.iterrows():\n\n            cursor.execute(fr\"\"\"\n                        SET IDENTITY_INSERT dbo.TB_FORMA_PAGAMENTO ON;  \n                        INSERT INTO dbo.TB_FORMA_PAGAMENTO \n                        (CODIGO_FORMA_PAGAMENTO\n                        ,DESCRICAO_FORMA_PAGAMENTO) \n                        VALUES (\n                        {coluna['CODIGO_FORMA_PAGAMENTO']}\n                        ,'{coluna['DESCRICAO_FORMA_PAGAMENTO']}'\n                        )\n                        SET IDENTITY_INSERT dbo.TB_FORMA_PAGAMENTO OFF;\n                        \"\"\")\n\nprint('06 (FIM) - CARGA DE DADOS DE FORMA PAGAMENTP')     \n</code></pre>"},{"location":"12_carga_sql_server_relacional/#seq-128-carga-de-vendas","title":"SEQ-12.8 - Carga de Vendas","text":"<p>Selecionado quais bibliotecas ser\u00e3o usadas.</p> Carga de Vendas<pre><code>print('07 (INICIO) - CARGA DE DADOS DE VENDAS')\n\ndfVenda = pd.read_csv(fr'C:\\Temp\\Python_YT\\Git\\Projeto_BI_Zero_TO_DW\\01_SCRIPT_SQL\\DADOS_BASE\\06_vendas.csv'\n                      ,dtype={'CODIGO_VENDA': int\n                            ,'DATA_VENDA': str\n                            ,'CODIGO_CLIENTE': int\n                            ,'CODIGO_LOJA_VENDEDOR': int\n                            ,'VALOR_FINAL': float\n                            ,'FORMA_PAGAMENTO': int\n                            ,'TIPO_PAGAMENTO': str}\n                        ,parse_dates=['DATA_VENDA']\n                        ,sep=';')\n\n\ndfVenda.sort_values(by='FORMA_PAGAMENTO')\n\nwith pyodbc.connect('DRIVER={'+driver+'};SERVER='+server+';DATABASE='+database+';UID='+username+';PWD='+ password) as conn:\n\n    with conn.cursor() as cursor:\n\n        cursor.execute(fr\"\"\"\n                       DELETE FROM dbo.TB_ITEM_VENDA;\n                       DELETE FROM dbo.TB_VENDA;\"\"\")        \n\n        for i, coluna in dfVenda.iterrows():\n\n            cursor.execute(fr\"\"\"\n                        SET IDENTITY_INSERT dbo.TB_VENDA ON;  \n                        INSERT INTO dbo.TB_VENDA \n                        (CODIGO_VENDA\n                        ,DATA_VENDA\n                        ,CODIGO_CLIENTE\n                        ,CODIGO_LOJA_VENDEDOR\n                        ,VALOR_FINAL\n                        ,CODIGO_FORMA_PAGAMENTO\n                        ,TIPO_PAGAMENTO) \n                        VALUES (\n                        {coluna['CODIGO_VENDA']}\n                        ,'{coluna['DATA_VENDA']}'\n                        ,{coluna['CODIGO_CLIENTE']}\n                        ,{coluna['CODIGO_LOJA_VENDEDOR']}\n                        ,'{coluna['VALOR_FINAL']}'\n                        ,{coluna['FORMA_PAGAMENTO']}\n                        ,'{coluna['TIPO_PAGAMENTO']}'\n                        )\n                        SET IDENTITY_INSERT dbo.TB_VENDA OFF;\n                        \"\"\")            \n\nprint('07 (FIM) - CARGA DE DADOS DE VENDAS')\n</code></pre>"},{"location":"12_carga_sql_server_relacional/#seq-129-carga-de-itens-de-venda","title":"SEQ-12.9 - Carga de Itens de Venda","text":"<p>Selecionado quais bibliotecas ser\u00e3o usadas.</p> Carga de Itens de Venda<pre><code>print('08 (INICIO) - CARGA DE DADOS DE ITEM VENDA')\n\ndfItemVenda = pd.read_csv(fr'C:\\Temp\\Python_YT\\Git\\Projeto_BI_Zero_TO_DW\\01_SCRIPT_SQL\\DADOS_BASE\\07_item_vendas.csv'\n                      ,dtype={'CODIGO_VENDA': int\n                            ,'CODIGO_PRODUTO': str\n                            ,'VALOR_UNITARIO': float\n                            ,'QUANTIDADE': int\n                            ,'VALOR_FINAL': float}\n                        ,sep=';')\n\nwith pyodbc.connect('DRIVER={'+driver+'};SERVER='+server+';DATABASE='+database+';UID='+username+';PWD='+ password) as conn:\n\n    with conn.cursor() as cursor:\n\n        cursor.execute(fr\"\"\"TRUNCATE TABLE dbo.TB_ITEM_VENDA;\"\"\")        \n\n        for i, coluna in dfItemVenda.iterrows():\n\n            cursor.execute(fr\"\"\"\n                        INSERT INTO dbo.TB_ITEM_VENDA \n                        (CODIGO_VENDA\n                        ,CODIGO_PRODUTO\n                        ,VALOR_UNITARIO\n                        ,QUANTIDADE\n                        ,VALOR_FINAL) \n                        VALUES (\n                        {coluna['CODIGO_VENDA']}\n                        ,{coluna['CODIGO_PRODUTO']}\n                        ,{coluna['VALOR_UNITARIO']}\n                        ,{coluna['QUANTIDADE']}\n                        ,{coluna['VALOR_FINAL']}\n                        )\n                        \"\"\")\n\nprint('08 (FIM) - CARGA DE DADOS DE ITEM VENDA')\n</code></pre>"},{"location":"12_carga_sql_server_relacional/#seq-1210-carga-de-tempo","title":"SEQ-12.10 - Carga de Tempo","text":"<p>Selecionado quais bibliotecas ser\u00e3o usadas.</p> Carga de Tempo<pre><code>print('09 (INICIO) - CARGA DE DADOS DE TEMPO')\n\ndfTempo = pd.read_csv(fr'C:\\Temp\\Python_YT\\Git\\Projeto_BI_Zero_TO_DW\\01_SCRIPT_SQL\\DADOS_BASE\\09_tempo.csv'\n                      ,dtype={'ID_TEMPO': str\n                            ,'DATA': str\n                            ,'ANO': int\n                            ,'MES': int\n                            ,'DIA': int}\n                      ,date_parser=['DATA']\n                        ,sep=';')\n\nwith pyodbc.connect('DRIVER={'+driver+'};SERVER='+server+';DATABASE='+database+';UID='+username+';PWD='+ password) as conn:\n\n    with conn.cursor() as cursor:\n\n        cursor.execute(fr\"\"\"TRUNCATE TABLE dbo.Tempo;\"\"\")        \n\n        for i, coluna in dfTempo.iterrows():\n\n            cursor.execute(fr\"\"\"\n                        INSERT INTO dbo.Tempo \n                        (ID_TEMPO\n                        ,DATA\n                        ,ANO\n                        ,MES\n                        ,DIA) \n                        VALUES (\n                        '{coluna['ID_TEMPO']}'\n                        ,{coluna['DATA']}\n                        ,{coluna['ANO']}\n                        ,{coluna['MES']}\n                        ,{coluna['DIA']}\n                        )\n                        \"\"\")\n\nprint('09 (FIM) - CARGA DE DADOS DE TEMPO')\n</code></pre>"},{"location":"13_carga_sql_server_multidimensional/","title":"Projeto BI Zero TO DW","text":""},{"location":"13_carga_sql_server_multidimensional/#13-notebook-carga-de-dados-no-axure-sql-server","title":"13 - Notebook Carga de Dados no Axure SQL Server","text":""},{"location":"13_carga_sql_server_multidimensional/#seq-131-definindo-as-bibliotecas","title":"SEQ-13.1 - Definindo as Bibliotecas","text":"<p>Selecionado quais bibliotecas ser\u00e3o usadas.</p> Bibliotecas Usadas<pre><code>from pyspark.sql.functions import *\nfrom datetime import date, timedelta\nimport pyodbc\n</code></pre>"},{"location":"13_carga_sql_server_multidimensional/#seq-132-instalacao-biblioteca-pyodbc","title":"SEQ-13.2 - Instala\u00e7\u00e3o Biblioteca pyodbc","text":"<p>Selecionado quais bibliotecas ser\u00e3o usadas.</p> Instala\u00e7\u00e3o Biblioteca pyodbc<pre><code>pip install pyodbc\n</code></pre>"},{"location":"13_carga_sql_server_multidimensional/#seq-133-importacao-arquivo-de-configuracao-no-github","title":"SEQ-13.3 - Importa\u00e7\u00e3o Arquivo de Configura\u00e7\u00e3o no GitHub","text":"<p>Processo de busca das credenciais de acesso ao Azure SQL Database armazenadas no GitHub.</p> Importa\u00e7\u00e3o Arquivo de Configura\u00e7\u00e3o no GitHub<pre><code>dfjson =  pd.read_json(\"https://raw.githubusercontent.com/dbaassists/Projeto_BI_Zero_TO_DW/main/04_ARQUIVO_CONFIG/config_azure_sql.json\")\n\nserver = dfjson['Config']['server']\ndatabase = dfjson['Config']['database']\nusername = dfjson['Config']['username']\npassword = dfjson['Config']['password']\n</code></pre>"},{"location":"13_carga_sql_server_multidimensional/#seq-134-instalacao-do-driver-odbc-driver-on-azure-databricks-cluster","title":"SEQ-13.4 - Instala\u00e7\u00e3o do Driver ODBC Driver on Azure Databricks cluster","text":"<p>Driver a ser instalado.</p> Instala\u00e7\u00e3o do Driver ODBC Driver on Azure Databricks cluster<pre><code>%sh\ncurl https://packages.microsoft.com/keys/microsoft.asc | apt-key add -\ncurl https://packages.microsoft.com/config/ubuntu/16.04/prod.list &gt; /etc/apt/sources.list.d/mssql-release.list\nsudo apt-get update\nsudo ACCEPT_EULA=Y apt-get -q -y install msodbcsql17\n</code></pre>"},{"location":"13_carga_sql_server_multidimensional/#seq-135-limpeza-das-tabelas-do-azure-sql-database","title":"SEQ-13.5 - Limpeza das Tabelas do Azure SQL Database","text":"Limpeza das Tabelas do Azure SQL Database<pre><code>cnxn = pyodbc.connect('DRIVER={ODBC Driver 17 for SQL Server};SERVER=srv-db-treinamentosql.database.windows.net;port=1433;DATABASE=srv-db-treinamentosql;UID='+username+';PWD='+ password)\n\nlista_tabela = ['dw.Fato_Venda', 'dw.Dim_Cliente', 'dw.Dim_Produto', 'dw.Dim_Forma_Pagamento', 'dw.Dim_Tempo', 'dw.Dim_Loja']\n\nfor tabela in lista_tabela:\n\n    print(tabela)\n\n    cursor = cnxn.cursor()\n\n    if tabela == 'dw.Fato_Venda':\n        comando = 'TRUNCATE TABLE'\n        print(comando)\n        cursor.execute(f'TRUNCATE TABLE {tabela}')\n\n    else:\n\n        comando = 'DELETE FROM'\n        print(comando)\n        cursor.execute(f'DELETE FROM {tabela}')    \n\n    cursor.commit()\n\ncnxn.close()    \n</code></pre>"},{"location":"13_carga_sql_server_multidimensional/#seq-136-carga-de-clientes-dwdim_cliente","title":"SEQ-13.6 - Carga de Clientes (dw.Dim_Cliente)","text":"Carga de Clientes (dw.Dim_Cliente)<pre><code># Consulta SQL para selecionar os dados do Databricks SQL\nquery = \"\"\"\nSELECT * FROM gold.dim_cliente\n\"\"\"\n# Carregando os dados do Databricks SQL\ndf = spark.sql(query)\n\n# Escrevendo os dados no banco de dados Azure SQL\ndf.write \\\n    .format(\"jdbc\") \\\n    .option(\"url\",  f\"jdbc:sqlserver://{server};database={database}\") \\\n    .option(\"dbtable\", \"dw.Dim_Cliente\") \\\n    .option(\"user\", username) \\\n    .option(\"password\", password) \\\n    .mode(\"append\") \\\n    .save()\n</code></pre>"},{"location":"13_carga_sql_server_multidimensional/#seq-137-carga-de-produtos-dwdim_produto","title":"SEQ-13.7 - Carga de Produtos (dw.Dim_Produto)","text":"Carga de Produtos (dw.Dim_Produto)<pre><code># Consulta SQL para selecionar os dados do Databricks SQL\nquery = \"\"\"\nSELECT * FROM gold.dim_produto\n\"\"\"\n# Carregando os dados do Databricks SQL\ndf = spark.sql(query)\n\n# Escrevendo os dados no banco de dados Azure SQL\ndf.write \\\n    .format(\"jdbc\") \\\n    .option(\"url\",  f\"jdbc:sqlserver://{server};database={database}\") \\\n    .option(\"dbtable\", \"dw.Dim_Produto\") \\\n    .option(\"user\", username) \\\n    .option(\"password\", password) \\\n    .mode(\"append\") \\\n    .save()\n</code></pre>"},{"location":"13_carga_sql_server_multidimensional/#seq-138-carga-de-categoria-de-forma-de-pagamento-golddim_forma_pagamento","title":"SEQ-13.8 - Carga de Categoria de Forma de Pagamento (gold.dim_forma_pagamento)","text":"Carga de Categoria de Forma de Pagamento (gold.dim_forma_pagamento)<pre><code># Consulta SQL para selecionar os dados do Databricks SQL\nquery = \"\"\"\nSELECT * FROM gold.dim_forma_pagamento\n\"\"\"\n# Carregando os dados do Databricks SQL\ndf = spark.sql(query)\n\n# Escrevendo os dados no banco de dados Azure SQL\ndf.write \\\n    .format(\"jdbc\") \\\n    .option(\"url\",  f\"jdbc:sqlserver://{server};database={database}\") \\\n    .option(\"dbtable\", \"dw.Dim_Forma_Pagamento\") \\\n    .option(\"user\", username) \\\n    .option(\"password\", password) \\\n    .mode(\"append\") \\\n    .save()\n</code></pre>"},{"location":"13_carga_sql_server_multidimensional/#seq-139-carga-de-tempo-golddim_tempo","title":"SEQ-13.9 - Carga de Tempo (gold.dim_tempo)","text":"<p>Selecionado quais bibliotecas ser\u00e3o usadas.</p> Carga de Tempo (gold.dim_tempo)<pre><code># Consulta SQL para selecionar os dados do Databricks SQL\nquery = \"\"\"\nSELECT * FROM gold.dim_tempo\n\"\"\"\n# Carregando os dados do Databricks SQL\ndf = spark.sql(query)\n\n# Escrevendo os dados no banco de dados Azure SQL\ndf.write \\\n    .format(\"jdbc\") \\\n    .option(\"url\",  f\"jdbc:sqlserver://{server};database={database}\") \\\n    .option(\"dbtable\", \"dw.Dim_Tempo\") \\\n    .option(\"user\", username) \\\n    .option(\"password\", password) \\\n    .mode(\"append\") \\\n    .save()\n</code></pre>"},{"location":"13_carga_sql_server_multidimensional/#seq-1310-carga-de-formas-de-loja-dwdim_loja","title":"SEQ-13.10 - Carga de Formas de Loja (dw.Dim_loja)","text":"<p>Selecionado quais bibliotecas ser\u00e3o usadas.</p> Carga de Formas de Loja (dw.Dim_loja)<pre><code># Consulta SQL para selecionar os dados do Databricks SQL\nquery = \"\"\"\nSELECT * FROM gold.dim_loja\n\"\"\"\n# Carregando os dados do Databricks SQL\ndf = spark.sql(query)\n\n# Escrevendo os dados no banco de dados Azure SQL\ndf.write \\\n    .format(\"jdbc\") \\\n    .option(\"url\",  f\"jdbc:sqlserver://{server};database={database}\") \\\n    .option(\"dbtable\", \"dw.Dim_Loja\") \\\n    .option(\"user\", username) \\\n    .option(\"password\", password) \\\n    .mode(\"append\") \\\n    .save()   \n</code></pre>"},{"location":"13_carga_sql_server_multidimensional/#seq-138-carga-de-vendas-dwfato_venda","title":"SEQ-13.8 - Carga de Vendas (dw.Fato_Venda)","text":"<p>Selecionado quais bibliotecas ser\u00e3o usadas.</p> Carga de Vendas (dw.Fato_Venda)<pre><code># Consulta SQL para selecionar os dados do Databricks SQL\nquery = \"\"\"\nSELECT * FROM gold.fato_venda\n\"\"\"\n# Carregando os dados do Databricks SQL\ndf = spark.sql(query)\n\n# Escrevendo os dados no banco de dados Azure SQL\ndf.write \\\n    .format(\"jdbc\") \\\n    .option(\"url\",  f\"jdbc:sqlserver://{server};database={database}\") \\\n    .option(\"dbtable\", \"dw.Fato_Venda\") \\\n    .option(\"user\", username) \\\n    .option(\"password\", password) \\\n    .mode(\"append\") \\\n    .save()\n</code></pre>"},{"location":"14_arquivos/","title":"Projeto BI Zero TO DW","text":""},{"location":"14_arquivos/#14-arquivos-do-projeto","title":"14 - Arquivos do Projeto","text":""},{"location":"14_arquivos/#seq-14-sessao-de-arquivos","title":"SEQ-14 - Sess\u00e3o de Arquivos","text":"<p>Essa fun\u00e7\u00e3o ela varre a coluna posi\u00e7\u00e3o a posi\u00e7\u00e3o em busca de caracter com acentos para poder substituir.</p> <p>Para visualizar o arquivo da arquitetura do projeto (SEQ-03), \u00e9 ncess\u00e1rio acessar o Excalidraw</p> Sequ\u00eancia Arquivo Link SEQ-01 Arquivo Cria\u00e7\u00e3o Tabelas SQL Arquivo CREATE TABLE SEQ-02 Arquivo Inser\u00e7\u00e3o Dados nas Tabelas SQL Arquivo INSERT DATA SEQ-03 Arquivo da Arquitetura do Projeto Arquivo Arquitetura SEQ-04 Arquivo Excel de Exemplo do Cen\u00e1rio Arquivo Base Excel SEQ-05 Arquivo Configura\u00e7\u00e3o Ambiente Databricks Notebook Configura\u00e7\u00e3o SEQ-06 Arquivo Exporta\u00e7\u00e3o Dados Azure SQL Database Notebook Extra\u00e7\u00e3o Dados SEQ-07 Arquivo JSON de Parametriza\u00e7\u00e3o de Conex\u00e3o com Azure SQL Database JSON de Configura\u00e7\u00e3o SEQ-08 Arquivo Ingest\u00e3o Dados Camada Bronze Notebook Carga Camada Bronze SEQ-09 Arquivo Ingest\u00e3o Dados Camada Silver Notebook Carga Camada Silver SEQ-10 Arquivo Ingest\u00e3o Dados Camada Gold Notebook Carga Camada Gold SEQ-11 Arquivo Carga Dados Azure SQL Database Schema DW Notebook Carga DW Azure SQL Database SEQ-12 Arquivo An\u00e1lise de Dados Databricks Notebook An\u00e1lise dos Dados SEQ-13 Arquivo Python Gera\u00e7\u00e3o Massa Dados Gera\u00e7\u00e3o Massa Dados SEQ-14 Arquivo Carga de Dados no SQL Server Carga de Dados no SQL Server SEQ-15 Arquivo Modelo Dados Relacional Toad Data Modeler Modelo Dados Banco Relacional Toad Data Modeler SEQ-16 Arquivo Modelo Dados Dimensional Toad Data Modeler Modelo Dados Banco Dimensional Toad Data Modeler SEQ-17 Arquivo Cria\u00e7\u00e3o Tabelas Fato e Dimens\u00f5es SQL Arquivo CREATE TABLE Fato e Dimens\u00f5es"},{"location":"1_arquitetura/","title":"Projeto BI Zero TO DW","text":""},{"location":"1_arquitetura/#1-arquitetura-do-projeto-bi-zero-to-dw","title":"1 - Arquitetura do Projeto BI Zero TO DW","text":"<p>Com base no que foi definido na fase de apresenta\u00e7\u00e3o do projeto, a arquitetura foi definida da seguinte forma.</p> <p></p> <p>Objetos criados:</p> Sequ\u00eancia Objeto Detalhamento SEQ-01 Notebook de Configura\u00e7\u00e3o do Ambiente Nesse notebook ficar\u00e1 respons\u00e1vel por conter todos as instru\u00e7\u00f5es de cria\u00e7\u00e3o do armazenamento landing zone no HDFS, cria\u00e7\u00e3o dos Schemas Bronze, Silver e Gold, assim como a cria\u00e7\u00e3o das tabelas. Todas os Schemas e Tabelas devem ter a sua defini\u00e7\u00e3o e tamb\u00e9m ficar\u00e1 respons\u00e1vel por conter o script de cria\u00e7\u00e3o da tabela dimens\u00e3o tempo. SEQ-02 Arquivo Par\u00e2metro de Conex\u00e3o com O Azure SQL Database Estrutura respons\u00e1vel por gerenciar as credenciais de acesso ao banco de dados Azure SQL Database SEQ-03 Notebook de Extra\u00e7\u00e3o de Dados do Azure SQL Database Ser\u00e1 respons\u00e1vel por realizar a identifica\u00e7\u00e3o de quais dados (tabelas) ser\u00e3o exportadas e pertidas na camada landing zone no formato parquet. SEQ-04 Notebook Ingest\u00e3o Camada Bronze Respons\u00e1vel pelo fluxo de leitura da camada landing zone e ingest\u00e3o dos dados na camada bronze. SEQ-05 Cria\u00e7\u00e3o Fun\u00e7\u00e3o Tratamento de Dados Fun\u00e7\u00e3o que ser\u00e1 usada na ingest\u00e3o dos dados na camada silver e que ser\u00e1 usado para aplicar regras de tratamento de dados. SEQ-06 Notebook Ingest\u00e3o Camada Silver Respons\u00e1vel pela ingest\u00e3o dos dados na camada silver a aplica\u00e7\u00e3o de regras de neg\u00f3cio. SEQ-07 Notebook Ingest\u00e3o Camada Gold Respons\u00e1vel pela ingest\u00e3o dos dados na camada gold no formato de dimens\u00f5es e fatos. SEQ-08 Notebook An\u00e1lise dos Dados Respons\u00e1vel pela an\u00e1lise dos dados da camada gold. SEQ-09 Notebook Carga Dados Azure SQL Respons\u00e1vel por carregar os dados no Azure SQL Database para o schema DW."},{"location":"2_provisionando_azure_sql/","title":"Projeto BI Zero TO DW","text":""},{"location":"2_provisionando_azure_sql/#2-provisionamento-do-azure-sql-databese","title":"2 - Provisionamento do Azure SQL Databese","text":""},{"location":"2_provisionando_azure_sql/#21-provisionar-o-azure-sql-database","title":"2.1 - Provisionar o Azure SQL Database","text":"<p>Primeiro passo para realizar o provisionamento \u00e9 voc\u00ea possuir uma conta na Azure e em seguida ter provisionado um Resource Group dentro da sua conta.</p> <p>O provisionamento do Resource Group n\u00e3o ser\u00e1 abordado nesse treinamento, por\u00e9m deixo um link para voc\u00ea aprender como que \u00e9 feito.</p> <p>Provisionando o Resouce Group</p> <p>Ap\u00f3s provisionar o Resource Group, vamos partir para o Azure SQL Server.</p> <p>Depois de logar em sua conta da Azure, vamos seguir os passos:</p> <p>Existem diversas formas de provisionar um recurso.</p> <p>2.1.1 - Clicar em CREATE A RESOURCE</p> <p></p> <p>2.1.2 - Vamos procurar o Azure SQL Database. Para isso, na barra SOURCE, vamos digitar AZURE SQL DATABASE.</p> <p></p> <p>2.1.3 - Pr\u00f3ximo passo \u00e9 clicar em AZURE SQL.</p> <p></p> <p>2.1.4 - Nessa etapa basta clicar em CREATE.</p> <p></p> <p>2.1.5 - Por \u00faltimo, selecionar SINGLE DATABASE e depois clicar em CREATE.</p> <p></p>"},{"location":"2_provisionando_azure_sql/#22-definindo-nome-do-servidor-e-banco","title":"2.2 - Definindo Nome do Servidor e Banco","text":"<p>Nessa tela, vamos precisar definir as seguintes informa\u00e7\u00f5es:</p> <ul> <li>Subscription;</li> <li>Resource Group;</li> <li>Nome do Servidor (definido na pr\u00f3xima tela);</li> <li>Modo de Autentica\u00e7\u00e3o (definido na pr\u00f3xima tela);</li> <li>Nome do Banco de Dados.</li> </ul> <p>As demais informa\u00e7\u00f5es na aba Basics vou manter o default.</p> <p></p>"},{"location":"2_provisionando_azure_sql/#23-definindo-informacoes-do-servidor","title":"2.3 - Definindo Informa\u00e7\u00f5es do Servidor","text":"<p>Nessa tela vamos precisar definir as seguintes informa\u00e7\u00f5es:</p> <ul> <li>Nome do Servidor;</li> <li>Regi\u00e3o do Azure;</li> <li>Modo de Autentica\u00e7\u00e3o;</li> <li>Nome do Banco de Dados.</li> </ul> <p>As demais informa\u00e7\u00f5es na aba Basics vou manter o default.</p> <p></p>"},{"location":"2_provisionando_azure_sql/#24-configuracoes-de-rede","title":"2.4 - Configura\u00e7\u00f5es de Rede","text":"<p>Na aba Netwoking segue as configura\u00e7\u00f5es:</p> <ul> <li> <p>2.4.1 - Em connectivity method: </p> <ul> <li>Public Endpoint</li> </ul> </li> <li> <p>2.4.2 - Em firewall rules: </p> <ul> <li>Allow Azure services and resources to access this server - NO</li> <li>Add current client IP address - YES</li> </ul> </li> <li> <p>2.4.3 - Em connection policy</p> <ul> <li>Proxy</li> </ul> </li> </ul> <p>As demais informa\u00e7\u00f5es na aba Basics vou manter o default.</p> <p></p>"},{"location":"2_provisionando_azure_sql/#25-finalizando-provisionamento","title":"2.5 - Finalizando Provisionamento","text":"<p>Ao clicar em CREATE, o recurso ser\u00e1 provisionado.</p> <p></p>"},{"location":"3_configuracao_ambiente_azure_sql/","title":"Projeto BI Zero TO DW","text":""},{"location":"3_configuracao_ambiente_azure_sql/#3-configurando-o-ambiente-azure-sql-database","title":"3 - Configurando o Ambiente Azure SQL Database","text":"<p>Essa etapa \u00e9 respons\u00e1vel pela cria\u00e7\u00e3o das tabelas no banco Azure SQL Database.</p>"},{"location":"3_configuracao_ambiente_azure_sql/#seq-31-tabelas-azure-sql-database","title":"SEQ-3.1 - Tabelas Azure SQL Database.","text":"<p>Pr\u00e9-Requisito para cria\u00e7\u00e3o da estrutura do Azure SQL Database.</p> Sequ\u00eancia A\u00e7\u00e3o Detalhamento SEQ-2.1 Provisionamento do Azure SQL Provisionamento de um banco de dados no Azure Banco de Dados Schema Tabela Descri\u00e7\u00e3o srv-db-treinamentosql dbo TB_FORMA_PAGAMENTO Armazena informa\u00e7\u00f5es de forma de pagamento. srv-db-treinamentosql dbo TB_CATEGORIA_PRODUTO Armazena informa\u00e7\u00f5es das categorias dos produtos srv-db-treinamentosql dbo TB_PRODUTO Armazena informa\u00e7\u00f5es de produtos. srv-db-treinamentosql dbo TB_CLIENTE Armazena informa\u00e7\u00f5es de clientes. srv-db-treinamentosql dbo TB_VENDEDOR Armazena informa\u00e7\u00f5es de vendedores. srv-db-treinamentosql dbo TB_LOJA Armazena informa\u00e7\u00f5es de lojas. srv-db-treinamentosql dbo TB_VENDA Armazenada informa\u00e7\u00f5es de vendas. srv-db-treinamentosql dbo TB_ITEM_VENDA Armazena informa\u00e7\u00f5es sobre os itens que foram vendidos."},{"location":"3_configuracao_ambiente_azure_sql/#seq-32-modelo-de-dados-modelagem-relacional","title":"SEQ-3.2 - Modelo de Dados - Modelagem Relacional","text":""},{"location":"3_configuracao_ambiente_azure_sql/#321-diagrama-de-dados-gerado-no-ssms","title":"3.2.1 - Diagrama de Dados Gerado no SSMS","text":""},{"location":"3_configuracao_ambiente_azure_sql/#322-modelo-de-dados-relacional-gerado-no-toad-data-modeler","title":"3.2.2 - Modelo de Dados Relacional Gerado no Toad Data Modeler","text":""},{"location":"3_configuracao_ambiente_azure_sql/#323-modelo-de-dados-multidimensional-gerado-no-toad-data-modeler","title":"3.2.3 - Modelo de Dados Multidimensional Gerado no Toad Data Modeler","text":"<p>Modelo 01 - Ponto de Debate</p> <p></p> <p>Modelo Final</p> <p></p>"},{"location":"3_configuracao_ambiente_azure_sql/#seq-33-script-create-table-baseado-no-modeo-relacional","title":"SEQ-3.3 - Script CREATE TABLE - Baseado no Modeo Relacional","text":"<p>Esse script pode ser encontrado em: Script de Cria\u00e7\u00e3o de Tabelas</p> Script Para Criar Tabelas no SQL<pre><code>IF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'Tempo', N'COLUMN',N'DATA_ALTERACAO'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'Tempo', @level2type=N'COLUMN',@level2name=N'DATA_ALTERACAO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'Tempo', N'COLUMN',N'DATA_CADASTRO'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'Tempo', @level2type=N'COLUMN',@level2name=N'DATA_CADASTRO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'Tempo', N'COLUMN',N'DIA'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'Tempo', @level2type=N'COLUMN',@level2name=N'DIA'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'Tempo', N'COLUMN',N'MES'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'Tempo', @level2type=N'COLUMN',@level2name=N'MES'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'Tempo', N'COLUMN',N'ANO'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'Tempo', @level2type=N'COLUMN',@level2name=N'ANO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'Tempo', N'COLUMN',N'DATA'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'Tempo', @level2type=N'COLUMN',@level2name=N'DATA'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'Tempo', N'COLUMN',N'ID_TEMPO'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'Tempo', @level2type=N'COLUMN',@level2name=N'ID_TEMPO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'TB_VENDEDOR', NULL,NULL))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_VENDEDOR'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'TB_VENDEDOR', N'COLUMN',N'NOME_VENDEDOR'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_VENDEDOR', @level2type=N'COLUMN',@level2name=N'NOME_VENDEDOR'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'TB_VENDEDOR', N'COLUMN',N'CODIGO_VENDEDOR'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_VENDEDOR', @level2type=N'COLUMN',@level2name=N'CODIGO_VENDEDOR'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'TB_VENDA', NULL,NULL))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_VENDA'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'TB_VENDA', N'COLUMN',N'TIPO_PAGAMENTO'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_VENDA', @level2type=N'COLUMN',@level2name=N'TIPO_PAGAMENTO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'TB_VENDA', N'COLUMN',N'VALOR_FINAL'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_VENDA', @level2type=N'COLUMN',@level2name=N'VALOR_FINAL'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'TB_VENDA', N'COLUMN',N'DATA_VENDA'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_VENDA', @level2type=N'COLUMN',@level2name=N'DATA_VENDA'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'TB_VENDA', N'COLUMN',N'CODIGO_FORMA_PAGAMENTO'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_VENDA', @level2type=N'COLUMN',@level2name=N'CODIGO_FORMA_PAGAMENTO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'TB_VENDA', N'COLUMN',N'CODIGO_CLIENTE'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_VENDA', @level2type=N'COLUMN',@level2name=N'CODIGO_CLIENTE'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'TB_VENDA', N'COLUMN',N'CODIGO_VENDA'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_VENDA', @level2type=N'COLUMN',@level2name=N'CODIGO_VENDA'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'TB_PRODUTO', NULL,NULL))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_PRODUTO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'TB_PRODUTO', N'COLUMN',N'CODIGO_CATEGORIA'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_PRODUTO', @level2type=N'COLUMN',@level2name=N'CODIGO_CATEGORIA'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'TB_PRODUTO', N'COLUMN',N'DESCRICAO_PRODUTO'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_PRODUTO', @level2type=N'COLUMN',@level2name=N'DESCRICAO_PRODUTO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'TB_PRODUTO', N'COLUMN',N'CODIGO_PRODUTO'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_PRODUTO', @level2type=N'COLUMN',@level2name=N'CODIGO_PRODUTO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'TB_LOJA', NULL,NULL))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_LOJA'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'TB_LOJA', N'COLUMN',N'TIPO_LOJA'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_LOJA', @level2type=N'COLUMN',@level2name=N'TIPO_LOJA'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'TB_LOJA', N'COLUMN',N'LOCALIDADE_LOJA'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_LOJA', @level2type=N'COLUMN',@level2name=N'LOCALIDADE_LOJA'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'TB_LOJA', N'COLUMN',N'NOME_LOJA'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_LOJA', @level2type=N'COLUMN',@level2name=N'NOME_LOJA'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'TB_LOJA', N'COLUMN',N'CODIGO_LOJA'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_LOJA', @level2type=N'COLUMN',@level2name=N'CODIGO_LOJA'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'TB_ITEM_VENDA', NULL,NULL))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_ITEM_VENDA'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'TB_ITEM_VENDA', N'COLUMN',N'VALOR_FINAL'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_ITEM_VENDA', @level2type=N'COLUMN',@level2name=N'VALOR_FINAL'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'TB_ITEM_VENDA', N'COLUMN',N'QUANTIDADE'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_ITEM_VENDA', @level2type=N'COLUMN',@level2name=N'QUANTIDADE'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'TB_ITEM_VENDA', N'COLUMN',N'VALOR_UNITARIO'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_ITEM_VENDA', @level2type=N'COLUMN',@level2name=N'VALOR_UNITARIO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'TB_ITEM_VENDA', N'COLUMN',N'CODIGO_PRODUTO'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_ITEM_VENDA', @level2type=N'COLUMN',@level2name=N'CODIGO_PRODUTO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'TB_ITEM_VENDA', N'COLUMN',N'CODIGO_VENDA'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_ITEM_VENDA', @level2type=N'COLUMN',@level2name=N'CODIGO_VENDA'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'TB_FORMA_PAGAMENTO', NULL,NULL))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_FORMA_PAGAMENTO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'TB_FORMA_PAGAMENTO', N'COLUMN',N'DESCRICAO_FORMA_PAGAMENTO'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_FORMA_PAGAMENTO', @level2type=N'COLUMN',@level2name=N'DESCRICAO_FORMA_PAGAMENTO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'TB_FORMA_PAGAMENTO', N'COLUMN',N'CODIGO_FORMA_PAGAMENTO'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_FORMA_PAGAMENTO', @level2type=N'COLUMN',@level2name=N'CODIGO_FORMA_PAGAMENTO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'TB_CLIENTE', NULL,NULL))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_CLIENTE'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'TB_CLIENTE', N'COLUMN',N'OCUPACAO_CLIENTE'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_CLIENTE', @level2type=N'COLUMN',@level2name=N'OCUPACAO_CLIENTE'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'TB_CLIENTE', N'COLUMN',N'EMAIL_CLIENTE'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_CLIENTE', @level2type=N'COLUMN',@level2name=N'EMAIL_CLIENTE'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'TB_CLIENTE', N'COLUMN',N'NUMERO_TELEFONE'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_CLIENTE', @level2type=N'COLUMN',@level2name=N'NUMERO_TELEFONE'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'TB_CLIENTE', N'COLUMN',N'NOME_CIDADE'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_CLIENTE', @level2type=N'COLUMN',@level2name=N'NOME_CIDADE'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'TB_CLIENTE', N'COLUMN',N'NUMERO_ENDERECO'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_CLIENTE', @level2type=N'COLUMN',@level2name=N'NUMERO_ENDERECO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'TB_CLIENTE', N'COLUMN',N'DESCRICAO_ENDERECO'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_CLIENTE', @level2type=N'COLUMN',@level2name=N'DESCRICAO_ENDERECO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'TB_CLIENTE', N'COLUMN',N'IDADE_CLIENTE'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_CLIENTE', @level2type=N'COLUMN',@level2name=N'IDADE_CLIENTE'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'TB_CLIENTE', N'COLUMN',N'DATA_NASCIMENTO'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_CLIENTE', @level2type=N'COLUMN',@level2name=N'DATA_NASCIMENTO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'TB_CLIENTE', N'COLUMN',N'NOME_CLIENTE'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_CLIENTE', @level2type=N'COLUMN',@level2name=N'NOME_CLIENTE'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'TB_CLIENTE', N'COLUMN',N'CODIGO_CLIENTE'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_CLIENTE', @level2type=N'COLUMN',@level2name=N'CODIGO_CLIENTE'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'TB_CATEGORIA_PRODUTO', NULL,NULL))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_CATEGORIA_PRODUTO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'TB_CATEGORIA_PRODUTO', N'COLUMN',N'SUB_CATEGORIA_PRODUTO'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_CATEGORIA_PRODUTO', @level2type=N'COLUMN',@level2name=N'SUB_CATEGORIA_PRODUTO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'TB_CATEGORIA_PRODUTO', N'COLUMN',N'CATEGORIA_PRODUTO'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_CATEGORIA_PRODUTO', @level2type=N'COLUMN',@level2name=N'CATEGORIA_PRODUTO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'TB_CATEGORIA_PRODUTO', N'COLUMN',N'CODIGO_CATEGORIA'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_CATEGORIA_PRODUTO', @level2type=N'COLUMN',@level2name=N'CODIGO_CATEGORIA'\nGO\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[TB_VENDA]') AND type in (N'U'))\nALTER TABLE [dbo].[TB_VENDA] DROP CONSTRAINT IF EXISTS [FK_TB_VENDA_LOJA_VENDEDOR]\nGO\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[TB_VENDA]') AND type in (N'U'))\nALTER TABLE [dbo].[TB_VENDA] DROP CONSTRAINT IF EXISTS [FK_TB_VENDA_FORMA_PAGAMENTO]\nGO\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[TB_VENDA]') AND type in (N'U'))\nALTER TABLE [dbo].[TB_VENDA] DROP CONSTRAINT IF EXISTS [FK_TB_VENDA_CLIENTE]\nGO\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[TB_PRODUTO]') AND type in (N'U'))\nALTER TABLE [dbo].[TB_PRODUTO] DROP CONSTRAINT IF EXISTS [FK_TB_PRODUTO_CATEGORIA_PRODUTO]\nGO\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[TB_LOJA]') AND type in (N'U'))\nALTER TABLE [dbo].[TB_LOJA] DROP CONSTRAINT IF EXISTS [FK_TB_VENDEDOR_LOJA]\nGO\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[TB_ITEM_VENDA]') AND type in (N'U'))\nALTER TABLE [dbo].[TB_ITEM_VENDA] DROP CONSTRAINT IF EXISTS [FK_TB_VENDA_ITEM_VENDA]\nGO\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[TB_ITEM_VENDA]') AND type in (N'U'))\nALTER TABLE [dbo].[TB_ITEM_VENDA] DROP CONSTRAINT IF EXISTS [FK_TB_ITEM_VENDA_PRODUTO]\nGO\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Tempo]') AND type in (N'U'))\nALTER TABLE [dbo].[Tempo] DROP CONSTRAINT IF EXISTS [DF__Tempo__DATA_ALTE__3CFEF876]\nGO\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Tempo]') AND type in (N'U'))\nALTER TABLE [dbo].[Tempo] DROP CONSTRAINT IF EXISTS [DF__Tempo__DATA_CADA__3C0AD43D]\nGO\n/****** Object:  Index [IX_02]    Script Date: 15/02/2024 08:28:02 ******/\nDROP INDEX IF EXISTS [IX_02] ON [dbo].[TB_VENDA]\nGO\n/****** Object:  Index [IX_01]    Script Date: 15/02/2024 08:28:02 ******/\nDROP INDEX IF EXISTS [IX_01] ON [dbo].[TB_VENDA]\nGO\n/****** Object:  Index [IX_01]    Script Date: 15/02/2024 08:28:02 ******/\nDROP INDEX IF EXISTS [IX_01] ON [dbo].[TB_PRODUTO]\nGO\n/****** Object:  Index [IX_02]    Script Date: 15/02/2024 08:28:02 ******/\nDROP INDEX IF EXISTS [IX_02] ON [dbo].[TB_ITEM_VENDA]\nGO\n/****** Object:  Index [IX_01]    Script Date: 15/02/2024 08:28:02 ******/\nDROP INDEX IF EXISTS [IX_01] ON [dbo].[TB_ITEM_VENDA]\nGO\n/****** Object:  Table [dbo].[Tempo]    Script Date: 15/02/2024 08:28:02 ******/\nDROP TABLE IF EXISTS [dbo].[Tempo]\nGO\n/****** Object:  Table [dbo].[TB_VENDEDOR]    Script Date: 15/02/2024 08:28:02 ******/\nDROP TABLE IF EXISTS [dbo].[TB_VENDEDOR]\nGO\n/****** Object:  Table [dbo].[TB_VENDA]    Script Date: 15/02/2024 08:28:02 ******/\nDROP TABLE IF EXISTS [dbo].[TB_VENDA]\nGO\n/****** Object:  Table [dbo].[TB_PRODUTO]    Script Date: 15/02/2024 08:28:02 ******/\nDROP TABLE IF EXISTS [dbo].[TB_PRODUTO]\nGO\n/****** Object:  Table [dbo].[TB_LOJA]    Script Date: 15/02/2024 08:28:02 ******/\nDROP TABLE IF EXISTS [dbo].[TB_LOJA]\nGO\n/****** Object:  Table [dbo].[TB_ITEM_VENDA]    Script Date: 15/02/2024 08:28:02 ******/\nDROP TABLE IF EXISTS [dbo].[TB_ITEM_VENDA]\nGO\n/****** Object:  Table [dbo].[TB_FORMA_PAGAMENTO]    Script Date: 15/02/2024 08:28:02 ******/\nDROP TABLE IF EXISTS [dbo].[TB_FORMA_PAGAMENTO]\nGO\n/****** Object:  Table [dbo].[TB_CLIENTE]    Script Date: 15/02/2024 08:28:02 ******/\nDROP TABLE IF EXISTS [dbo].[TB_CLIENTE]\nGO\n/****** Object:  Table [dbo].[TB_CATEGORIA_PRODUTO]    Script Date: 15/02/2024 08:28:02 ******/\nDROP TABLE IF EXISTS [dbo].[TB_CATEGORIA_PRODUTO]\nGO\n/****** Object:  Table [dbo].[TB_CATEGORIA_PRODUTO]    Script Date: 15/02/2024 08:28:02 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[TB_CATEGORIA_PRODUTO](\n    [CODIGO_CATEGORIA] [smallint] IDENTITY(1,1) NOT NULL,\n    [CATEGORIA_PRODUTO] [varchar](100) NOT NULL,\n    [SUB_CATEGORIA_PRODUTO] [varchar](100) NOT NULL,\n CONSTRAINT [PK_TB_CATEGORIA_PRODUTO] PRIMARY KEY CLUSTERED \n(\n    [CODIGO_CATEGORIA] ASC\n)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]\n) ON [PRIMARY]\nGO\n/****** Object:  Table [dbo].[TB_CLIENTE]    Script Date: 15/02/2024 08:28:02 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[TB_CLIENTE](\n    [CODIGO_CLIENTE] [int] IDENTITY(1,1) NOT NULL,\n    [NOME_CLIENTE] [varchar](100) NOT NULL,\n    [DATA_NASCIMENTO] [date] NOT NULL,\n    [IDADE_CLIENTE] [tinyint] NOT NULL,\n    [DESCRICAO_ENDERECO] [varchar](200) NOT NULL,\n    [NUMERO_ENDERECO] [smallint] NOT NULL,\n    [NOME_CIDADE] [varchar](100) NOT NULL,\n    [NUMERO_TELEFONE] [varchar](30) NOT NULL,\n    [EMAIL_CLIENTE] [varchar](100) NOT NULL,\n    [OCUPACAO_CLIENTE] [varchar](100) NOT NULL,\n CONSTRAINT [PK_TB_CLIENTE] PRIMARY KEY CLUSTERED \n(\n    [CODIGO_CLIENTE] ASC\n)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]\n) ON [PRIMARY]\nGO\n/****** Object:  Table [dbo].[TB_FORMA_PAGAMENTO]    Script Date: 15/02/2024 08:28:02 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[TB_FORMA_PAGAMENTO](\n    [CODIGO_FORMA_PAGAMENTO] [smallint] IDENTITY(1,1) NOT NULL,\n    [DESCRICAO_FORMA_PAGAMENTO] [varchar](100) NOT NULL,\n CONSTRAINT [PK_TB_FORMA_PAGAMENTO] PRIMARY KEY CLUSTERED \n(\n    [CODIGO_FORMA_PAGAMENTO] ASC\n)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]\n) ON [PRIMARY]\nGO\n/****** Object:  Table [dbo].[TB_ITEM_VENDA]    Script Date: 15/02/2024 08:28:02 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[TB_ITEM_VENDA](\n    [CODIGO_VENDA] [int] NOT NULL,\n    [CODIGO_PRODUTO] [smallint] NOT NULL,\n    [VALOR_UNITARIO] [decimal](18, 2) NULL,\n    [QUANTIDADE] [smallint] NULL,\n    [VALOR_FINAL] [decimal](18, 2) NULL,\n CONSTRAINT [PK_TB_ITEM_VENDA] PRIMARY KEY CLUSTERED \n(\n    [CODIGO_VENDA] ASC,\n    [CODIGO_PRODUTO] ASC\n)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]\n) ON [PRIMARY]\nGO\n/****** Object:  Table [dbo].[TB_LOJA]    Script Date: 15/02/2024 08:28:02 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[TB_LOJA](\n    [CODIGO_LOJA_VENDEDOR] [smallint] IDENTITY(1,1) NOT NULL,\n    [CODIGO_LOJA] [smallint] NOT NULL,\n    [CODIGO_VENDEDOR] [smallint] NOT NULL,\n    [NOME_LOJA] [varchar](100) NOT NULL,\n    [LOCALIDADE_LOJA] [varchar](100) NOT NULL,\n    [TIPO_LOJA] [varchar](100) NOT NULL,\n CONSTRAINT [PK_TB_LOJA] PRIMARY KEY CLUSTERED \n(\n    [CODIGO_LOJA_VENDEDOR] ASC\n)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]\n) ON [PRIMARY]\nGO\n/****** Object:  Table [dbo].[TB_PRODUTO]    Script Date: 15/02/2024 08:28:02 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[TB_PRODUTO](\n    [CODIGO_PRODUTO] [smallint] IDENTITY(1,1) NOT NULL,\n    [DESCRICAO_PRODUTO] [varchar](100) NOT NULL,\n    [CODIGO_CATEGORIA] [smallint] NOT NULL,\n CONSTRAINT [PK_TB_PRODUTO] PRIMARY KEY CLUSTERED \n(\n    [CODIGO_PRODUTO] ASC\n)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]\n) ON [PRIMARY]\nGO\n/****** Object:  Table [dbo].[TB_VENDA]    Script Date: 15/02/2024 08:28:02 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[TB_VENDA](\n    [CODIGO_VENDA] [int] IDENTITY(1,1) NOT NULL,\n    [CODIGO_CLIENTE] [int] NOT NULL,\n    [CODIGO_FORMA_PAGAMENTO] [smallint] NOT NULL,\n    [CODIGO_LOJA_VENDEDOR] [smallint] NOT NULL,\n    [DATA_VENDA] [datetime] NOT NULL,\n    [VALOR_FINAL] [decimal](18, 2) NOT NULL,\n    [TIPO_PAGAMENTO] [varchar](100) NOT NULL,\n CONSTRAINT [PK_TB_VENDA] PRIMARY KEY CLUSTERED \n(\n    [CODIGO_VENDA] ASC\n)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]\n) ON [PRIMARY]\nGO\n/****** Object:  Table [dbo].[TB_VENDEDOR]    Script Date: 15/02/2024 08:28:02 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[TB_VENDEDOR](\n    [CODIGO_VENDEDOR] [smallint] IDENTITY(1,1) NOT NULL,\n    [NOME_VENDEDOR] [varchar](100) NOT NULL,\n CONSTRAINT [PK_CODIGO_VENDEDOR] PRIMARY KEY CLUSTERED \n(\n    [CODIGO_VENDEDOR] ASC\n)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]\n) ON [PRIMARY]\nGO\n/****** Object:  Table [dbo].[Tempo]    Script Date: 15/02/2024 08:28:02 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[Tempo](\n    [ID_TEMPO] [varchar](100) NOT NULL,\n    [DATA] [varchar](10) NOT NULL,\n    [ANO] [int] NOT NULL,\n    [MES] [int] NOT NULL,\n    [DIA] [int] NOT NULL,\n    [DATA_CADASTRO] [datetime] NOT NULL,\n    [DATA_ALTERACAO] [datetime] NOT NULL,\n CONSTRAINT [PK_Tempo] PRIMARY KEY CLUSTERED \n(\n    [ID_TEMPO] ASC\n)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]\n) ON [PRIMARY]\nGO\n/****** Object:  Index [IX_01]    Script Date: 15/02/2024 08:28:02 ******/\nCREATE NONCLUSTERED INDEX [IX_01] ON [dbo].[TB_ITEM_VENDA]\n(\n    [CODIGO_VENDA] ASC\n)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]\nGO\n/****** Object:  Index [IX_02]    Script Date: 15/02/2024 08:28:02 ******/\nCREATE NONCLUSTERED INDEX [IX_02] ON [dbo].[TB_ITEM_VENDA]\n(\n    [CODIGO_PRODUTO] ASC\n)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]\nGO\n/****** Object:  Index [IX_01]    Script Date: 15/02/2024 08:28:02 ******/\nCREATE NONCLUSTERED INDEX [IX_01] ON [dbo].[TB_PRODUTO]\n(\n    [CODIGO_CATEGORIA] ASC\n)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]\nGO\n/****** Object:  Index [IX_01]    Script Date: 15/02/2024 08:28:02 ******/\nCREATE NONCLUSTERED INDEX [IX_01] ON [dbo].[TB_VENDA]\n(\n    [CODIGO_CLIENTE] ASC\n)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]\nGO\n/****** Object:  Index [IX_02]    Script Date: 15/02/2024 08:28:02 ******/\nCREATE NONCLUSTERED INDEX [IX_02] ON [dbo].[TB_VENDA]\n(\n    [CODIGO_FORMA_PAGAMENTO] ASC\n)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]\nGO\nALTER TABLE [dbo].[Tempo] ADD  DEFAULT (getdate()) FOR [DATA_CADASTRO]\nGO\nALTER TABLE [dbo].[Tempo] ADD  DEFAULT (getdate()) FOR [DATA_ALTERACAO]\nGO\nALTER TABLE [dbo].[TB_ITEM_VENDA]  WITH CHECK ADD  CONSTRAINT [FK_TB_ITEM_VENDA_PRODUTO] FOREIGN KEY([CODIGO_PRODUTO])\nREFERENCES [dbo].[TB_PRODUTO] ([CODIGO_PRODUTO])\nGO\nALTER TABLE [dbo].[TB_ITEM_VENDA] CHECK CONSTRAINT [FK_TB_ITEM_VENDA_PRODUTO]\nGO\nALTER TABLE [dbo].[TB_ITEM_VENDA]  WITH CHECK ADD  CONSTRAINT [FK_TB_VENDA_ITEM_VENDA] FOREIGN KEY([CODIGO_VENDA])\nREFERENCES [dbo].[TB_VENDA] ([CODIGO_VENDA])\nGO\nALTER TABLE [dbo].[TB_ITEM_VENDA] CHECK CONSTRAINT [FK_TB_VENDA_ITEM_VENDA]\nGO\nALTER TABLE [dbo].[TB_LOJA]  WITH CHECK ADD  CONSTRAINT [FK_TB_VENDEDOR_LOJA] FOREIGN KEY([CODIGO_VENDEDOR])\nREFERENCES [dbo].[TB_VENDEDOR] ([CODIGO_VENDEDOR])\nGO\nALTER TABLE [dbo].[TB_LOJA] CHECK CONSTRAINT [FK_TB_VENDEDOR_LOJA]\nGO\nALTER TABLE [dbo].[TB_PRODUTO]  WITH CHECK ADD  CONSTRAINT [FK_TB_PRODUTO_CATEGORIA_PRODUTO] FOREIGN KEY([CODIGO_CATEGORIA])\nREFERENCES [dbo].[TB_CATEGORIA_PRODUTO] ([CODIGO_CATEGORIA])\nGO\nALTER TABLE [dbo].[TB_PRODUTO] CHECK CONSTRAINT [FK_TB_PRODUTO_CATEGORIA_PRODUTO]\nGO\nALTER TABLE [dbo].[TB_VENDA]  WITH CHECK ADD  CONSTRAINT [FK_TB_VENDA_CLIENTE] FOREIGN KEY([CODIGO_CLIENTE])\nREFERENCES [dbo].[TB_CLIENTE] ([CODIGO_CLIENTE])\nGO\nALTER TABLE [dbo].[TB_VENDA] CHECK CONSTRAINT [FK_TB_VENDA_CLIENTE]\nGO\nALTER TABLE [dbo].[TB_VENDA]  WITH CHECK ADD  CONSTRAINT [FK_TB_VENDA_FORMA_PAGAMENTO] FOREIGN KEY([CODIGO_FORMA_PAGAMENTO])\nREFERENCES [dbo].[TB_FORMA_PAGAMENTO] ([CODIGO_FORMA_PAGAMENTO])\nGO\nALTER TABLE [dbo].[TB_VENDA] CHECK CONSTRAINT [FK_TB_VENDA_FORMA_PAGAMENTO]\nGO\nALTER TABLE [dbo].[TB_VENDA]  WITH CHECK ADD  CONSTRAINT [FK_TB_VENDA_LOJA_VENDEDOR] FOREIGN KEY([CODIGO_LOJA_VENDEDOR])\nREFERENCES [dbo].[TB_LOJA] ([CODIGO_LOJA_VENDEDOR])\nGO\nALTER TABLE [dbo].[TB_VENDA] CHECK CONSTRAINT [FK_TB_VENDA_LOJA_VENDEDOR]\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'C\u00f3digo da Categoria do Produto.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_CATEGORIA_PRODUTO', @level2type=N'COLUMN',@level2name=N'CODIGO_CATEGORIA'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Descri\u00e7\u00e3o da Categoria do Produto.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_CATEGORIA_PRODUTO', @level2type=N'COLUMN',@level2name=N'CATEGORIA_PRODUTO'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Descri\u00e7\u00e3o da Sub-Categoria do Produto.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_CATEGORIA_PRODUTO', @level2type=N'COLUMN',@level2name=N'SUB_CATEGORIA_PRODUTO'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Armazena informa\u00e7\u00f5es das categorias dos produtos' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_CATEGORIA_PRODUTO'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'C\u00f3digo do Cliente.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_CLIENTE', @level2type=N'COLUMN',@level2name=N'CODIGO_CLIENTE'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Nome do Cliente.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_CLIENTE', @level2type=N'COLUMN',@level2name=N'NOME_CLIENTE'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Data de Nascimento do Cliente' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_CLIENTE', @level2type=N'COLUMN',@level2name=N'DATA_NASCIMENTO'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Idade do Cliente' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_CLIENTE', @level2type=N'COLUMN',@level2name=N'IDADE_CLIENTE'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Endere\u00e7o do Cliente' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_CLIENTE', @level2type=N'COLUMN',@level2name=N'DESCRICAO_ENDERECO'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'N\u00famero do Endere\u00e7o' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_CLIENTE', @level2type=N'COLUMN',@level2name=N'NUMERO_ENDERECO'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Cidade' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_CLIENTE', @level2type=N'COLUMN',@level2name=N'NOME_CIDADE'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Telefone' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_CLIENTE', @level2type=N'COLUMN',@level2name=N'NUMERO_TELEFONE'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'E-mail do cliente' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_CLIENTE', @level2type=N'COLUMN',@level2name=N'EMAIL_CLIENTE'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Ocupa\u00e7\u00e3o do Cliente' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_CLIENTE', @level2type=N'COLUMN',@level2name=N'OCUPACAO_CLIENTE'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Armazena informa\u00e7\u00f5es de clientes.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_CLIENTE'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'C\u00f3digo da Forma de Pagamento na Tabela TB_FORMA_PAGAMENTO.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_FORMA_PAGAMENTO', @level2type=N'COLUMN',@level2name=N'CODIGO_FORMA_PAGAMENTO'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Descri\u00e7\u00e3o da Forma de Pagamento na Tabela TB_FORMA_PAGAMENTO.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_FORMA_PAGAMENTO', @level2type=N'COLUMN',@level2name=N'DESCRICAO_FORMA_PAGAMENTO'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Armazena informa\u00e7\u00f5es de forma de pagamento.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_FORMA_PAGAMENTO'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'C\u00f3digo da Venda' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_ITEM_VENDA', @level2type=N'COLUMN',@level2name=N'CODIGO_VENDA'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'C\u00f3digo do Produto' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_ITEM_VENDA', @level2type=N'COLUMN',@level2name=N'CODIGO_PRODUTO'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Valor Unit\u00e1rio do Produto' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_ITEM_VENDA', @level2type=N'COLUMN',@level2name=N'VALOR_UNITARIO'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Quantidade do Produto Vendido' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_ITEM_VENDA', @level2type=N'COLUMN',@level2name=N'QUANTIDADE'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Valor Final do Produto Vendido' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_ITEM_VENDA', @level2type=N'COLUMN',@level2name=N'VALOR_FINAL'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Armazena informa\u00e7\u00f5es sobre os itens que foram vendidos.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_ITEM_VENDA'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'C\u00f3digo da Loja.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_LOJA', @level2type=N'COLUMN',@level2name=N'CODIGO_LOJA'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Nome da Loja.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_LOJA', @level2type=N'COLUMN',@level2name=N'NOME_LOJA'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Localidade da Loja.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_LOJA', @level2type=N'COLUMN',@level2name=N'LOCALIDADE_LOJA'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Tipo da Loja.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_LOJA', @level2type=N'COLUMN',@level2name=N'TIPO_LOJA'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Armazena informa\u00e7\u00f5es de lojas.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_LOJA'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'C\u00f3digo do Produto.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_PRODUTO', @level2type=N'COLUMN',@level2name=N'CODIGO_PRODUTO'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Descri\u00e7\u00e3o do Produto.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_PRODUTO', @level2type=N'COLUMN',@level2name=N'DESCRICAO_PRODUTO'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Categoria do Produto.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_PRODUTO', @level2type=N'COLUMN',@level2name=N'CODIGO_CATEGORIA'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Armazena informa\u00e7\u00f5es de produtos.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_PRODUTO'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'C\u00f3digo da Venda.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_VENDA', @level2type=N'COLUMN',@level2name=N'CODIGO_VENDA'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'C\u00f3digo do Cliente' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_VENDA', @level2type=N'COLUMN',@level2name=N'CODIGO_CLIENTE'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Forma de Pagamento' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_VENDA', @level2type=N'COLUMN',@level2name=N'CODIGO_FORMA_PAGAMENTO'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Data da Venda' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_VENDA', @level2type=N'COLUMN',@level2name=N'DATA_VENDA'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Valor Total da Venda' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_VENDA', @level2type=N'COLUMN',@level2name=N'VALOR_FINAL'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Tipo de Pagamento' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_VENDA', @level2type=N'COLUMN',@level2name=N'TIPO_PAGAMENTO'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Armazenada informa\u00e7\u00f5es de vendas.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_VENDA'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'C\u00f3digo do Vendedor.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_VENDEDOR', @level2type=N'COLUMN',@level2name=N'CODIGO_VENDEDOR'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Nome do Vendedor.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_VENDEDOR', @level2type=N'COLUMN',@level2name=N'NOME_VENDEDOR'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Armazena informa\u00e7\u00f5es de vendedores' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'TB_VENDEDOR'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Chave da Dimens\u00e3o Tempo' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'Tempo', @level2type=N'COLUMN',@level2name=N'ID_TEMPO'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Identifica a Data' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'Tempo', @level2type=N'COLUMN',@level2name=N'DATA'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Ano referente a coluna data.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'Tempo', @level2type=N'COLUMN',@level2name=N'ANO'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'M\u00eas referente a coluna data.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'Tempo', @level2type=N'COLUMN',@level2name=N'MES'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Dia referente a coluna data.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'Tempo', @level2type=N'COLUMN',@level2name=N'DIA'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Data de Cadastro do Registro.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'Tempo', @level2type=N'COLUMN',@level2name=N'DATA_CADASTRO'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Data de Atualiza\u00e7\u00e3o do Registro.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'Tempo', @level2type=N'COLUMN',@level2name=N'DATA_ALTERACAO'\nGO\n</code></pre>"},{"location":"3_configuracao_ambiente_azure_sql/#seq-34-script-create-table-baseado-no-modelo-multidimensional","title":"SEQ-3.4 - Script CREATE TABLE - Baseado no Modelo Multidimensional","text":"<p>Esse script pode ser encontrado em: Script de Cria\u00e7\u00e3o de Tabelas Fatos e Dimens\u00f5es</p> Script Para Criar Tabelas Fatos e Dimens\u00f5es no SQL<pre><code>IF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Fato_Venda', N'COLUMN',N'DATA_ALTERACAO'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Fato_Venda', @level2type=N'COLUMN',@level2name=N'DATA_ALTERACAO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Fato_Venda', N'COLUMN',N'DATA_CADASTRO'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Fato_Venda', @level2type=N'COLUMN',@level2name=N'DATA_CADASTRO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Fato_Venda', N'COLUMN',N'TIPO_PAGAMENTO'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Fato_Venda', @level2type=N'COLUMN',@level2name=N'TIPO_PAGAMENTO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Fato_Venda', N'COLUMN',N'VALOR_FINAL'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Fato_Venda', @level2type=N'COLUMN',@level2name=N'VALOR_FINAL'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Fato_Venda', N'COLUMN',N'VALOR_UNITARIO'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Fato_Venda', @level2type=N'COLUMN',@level2name=N'VALOR_UNITARIO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Fato_Venda', N'COLUMN',N'QUANTIDADE'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Fato_Venda', @level2type=N'COLUMN',@level2name=N'QUANTIDADE'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Fato_Venda', N'COLUMN',N'HORA_VENDA'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Fato_Venda', @level2type=N'COLUMN',@level2name=N'HORA_VENDA'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Fato_Venda', N'COLUMN',N'ID_TEMPO'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Fato_Venda', @level2type=N'COLUMN',@level2name=N'ID_TEMPO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Fato_Venda', N'COLUMN',N'ID_FORMA_PAGAMENTO'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Fato_Venda', @level2type=N'COLUMN',@level2name=N'ID_FORMA_PAGAMENTO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Fato_Venda', N'COLUMN',N'ID_PRODUTO'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Fato_Venda', @level2type=N'COLUMN',@level2name=N'ID_PRODUTO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Fato_Venda', N'COLUMN',N'ID_LOJA'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Fato_Venda', @level2type=N'COLUMN',@level2name=N'ID_LOJA'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Fato_Venda', N'COLUMN',N'ID_CLIENTE'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Fato_Venda', @level2type=N'COLUMN',@level2name=N'ID_CLIENTE'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Fato_Venda', N'COLUMN',N'CODIGO_VENDA'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Fato_Venda', @level2type=N'COLUMN',@level2name=N'CODIGO_VENDA'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Dim_Tempo', N'COLUMN',N'DATA_ALTERACAO'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Tempo', @level2type=N'COLUMN',@level2name=N'DATA_ALTERACAO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Dim_Tempo', N'COLUMN',N'DATA_CADASTRO'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Tempo', @level2type=N'COLUMN',@level2name=N'DATA_CADASTRO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Dim_Tempo', N'COLUMN',N'DIA'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Tempo', @level2type=N'COLUMN',@level2name=N'DIA'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Dim_Tempo', N'COLUMN',N'MES'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Tempo', @level2type=N'COLUMN',@level2name=N'MES'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Dim_Tempo', N'COLUMN',N'ANO'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Tempo', @level2type=N'COLUMN',@level2name=N'ANO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Dim_Tempo', N'COLUMN',N'DATA'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Tempo', @level2type=N'COLUMN',@level2name=N'DATA'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Dim_Tempo', N'COLUMN',N'ID_TEMPO'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Tempo', @level2type=N'COLUMN',@level2name=N'ID_TEMPO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Dim_Produto', N'COLUMN',N'DATA_ALTERACAO'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Produto', @level2type=N'COLUMN',@level2name=N'DATA_ALTERACAO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Dim_Produto', N'COLUMN',N'DATA_CADASTRO'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Produto', @level2type=N'COLUMN',@level2name=N'DATA_CADASTRO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Dim_Produto', N'COLUMN',N'SUB_CATEGORIA_PRODUTO'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Produto', @level2type=N'COLUMN',@level2name=N'SUB_CATEGORIA_PRODUTO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Dim_Produto', N'COLUMN',N'CATEGORIA_PRODUTO'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Produto', @level2type=N'COLUMN',@level2name=N'CATEGORIA_PRODUTO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Dim_Produto', N'COLUMN',N'DESCRICAO_PRODUTO'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Produto', @level2type=N'COLUMN',@level2name=N'DESCRICAO_PRODUTO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Dim_Produto', N'COLUMN',N'CODIGO_PRODUTO'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Produto', @level2type=N'COLUMN',@level2name=N'CODIGO_PRODUTO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Dim_Produto', N'COLUMN',N'ID_PRODUTO'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Produto', @level2type=N'COLUMN',@level2name=N'ID_PRODUTO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Dim_Loja', N'COLUMN',N'DATA_ALTERACAO'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Loja', @level2type=N'COLUMN',@level2name=N'DATA_ALTERACAO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Dim_Loja', N'COLUMN',N'DATA_CADASTRO'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Loja', @level2type=N'COLUMN',@level2name=N'DATA_CADASTRO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Dim_Loja', N'COLUMN',N'TIPO_LOJA'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Loja', @level2type=N'COLUMN',@level2name=N'TIPO_LOJA'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Dim_Loja', N'COLUMN',N'LOCALIDADE_LOJA'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Loja', @level2type=N'COLUMN',@level2name=N'LOCALIDADE_LOJA'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Dim_Loja', N'COLUMN',N'NOME_VENDEDOR'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Loja', @level2type=N'COLUMN',@level2name=N'NOME_VENDEDOR'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Dim_Loja', N'COLUMN',N'NOME_LOJA'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Loja', @level2type=N'COLUMN',@level2name=N'NOME_LOJA'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Dim_Loja', N'COLUMN',N'CODIGO_LOJA'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Loja', @level2type=N'COLUMN',@level2name=N'CODIGO_LOJA'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Dim_Loja', N'COLUMN',N'ID_LOJA'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Loja', @level2type=N'COLUMN',@level2name=N'ID_LOJA'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Dim_Forma_Pagamento', N'COLUMN',N'DATA_ALTERACAO'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Forma_Pagamento', @level2type=N'COLUMN',@level2name=N'DATA_ALTERACAO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Dim_Forma_Pagamento', N'COLUMN',N'DATA_CADASTRO'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Forma_Pagamento', @level2type=N'COLUMN',@level2name=N'DATA_CADASTRO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Dim_Forma_Pagamento', N'COLUMN',N'DESCRICAO_FORMA_PAGAMENTO'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Forma_Pagamento', @level2type=N'COLUMN',@level2name=N'DESCRICAO_FORMA_PAGAMENTO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Dim_Forma_Pagamento', N'COLUMN',N'CODIGO_FORMA_PAGAMENTO'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Forma_Pagamento', @level2type=N'COLUMN',@level2name=N'CODIGO_FORMA_PAGAMENTO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Dim_Forma_Pagamento', N'COLUMN',N'ID_FORMA_PAGAMENTO'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Forma_Pagamento', @level2type=N'COLUMN',@level2name=N'ID_FORMA_PAGAMENTO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Dim_Cliente', N'COLUMN',N'DATA_ALTERACAO'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Cliente', @level2type=N'COLUMN',@level2name=N'DATA_ALTERACAO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Dim_Cliente', N'COLUMN',N'DATA_CADASTRO'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Cliente', @level2type=N'COLUMN',@level2name=N'DATA_CADASTRO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Dim_Cliente', N'COLUMN',N'OCUPACAO_CLIENTE'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Cliente', @level2type=N'COLUMN',@level2name=N'OCUPACAO_CLIENTE'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Dim_Cliente', N'COLUMN',N'EMAIL_CLIENTE'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Cliente', @level2type=N'COLUMN',@level2name=N'EMAIL_CLIENTE'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Dim_Cliente', N'COLUMN',N'NUMERO_TELEFONE'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Cliente', @level2type=N'COLUMN',@level2name=N'NUMERO_TELEFONE'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Dim_Cliente', N'COLUMN',N'NOME_CIDADE'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Cliente', @level2type=N'COLUMN',@level2name=N'NOME_CIDADE'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Dim_Cliente', N'COLUMN',N'NUMERO_ENDERECO'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Cliente', @level2type=N'COLUMN',@level2name=N'NUMERO_ENDERECO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Dim_Cliente', N'COLUMN',N'DESCRICAO_ENDERECO'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Cliente', @level2type=N'COLUMN',@level2name=N'DESCRICAO_ENDERECO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Dim_Cliente', N'COLUMN',N'IDADE_CLIENTE'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Cliente', @level2type=N'COLUMN',@level2name=N'IDADE_CLIENTE'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Dim_Cliente', N'COLUMN',N'DATA_NASCIMENTO'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Cliente', @level2type=N'COLUMN',@level2name=N'DATA_NASCIMENTO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Dim_Cliente', N'COLUMN',N'NOME_CLIENTE'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Cliente', @level2type=N'COLUMN',@level2name=N'NOME_CLIENTE'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Dim_Cliente', N'COLUMN',N'CODIGO_CLIENTE'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Cliente', @level2type=N'COLUMN',@level2name=N'CODIGO_CLIENTE'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dw', N'TABLE',N'Dim_Cliente', N'COLUMN',N'ID_CLIENTE'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Cliente', @level2type=N'COLUMN',@level2name=N'ID_CLIENTE'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'Tempo', N'COLUMN',N'DATA_ALTERACAO'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'Tempo', @level2type=N'COLUMN',@level2name=N'DATA_ALTERACAO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'Tempo', N'COLUMN',N'DATA_CADASTRO'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'Tempo', @level2type=N'COLUMN',@level2name=N'DATA_CADASTRO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'Tempo', N'COLUMN',N'DIA'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'Tempo', @level2type=N'COLUMN',@level2name=N'DIA'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'Tempo', N'COLUMN',N'MES'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'Tempo', @level2type=N'COLUMN',@level2name=N'MES'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'Tempo', N'COLUMN',N'ANO'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'Tempo', @level2type=N'COLUMN',@level2name=N'ANO'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'Tempo', N'COLUMN',N'DATA'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'Tempo', @level2type=N'COLUMN',@level2name=N'DATA'\nGO\nIF  EXISTS (SELECT * FROM sys.fn_listextendedproperty(N'MS_Description' , N'SCHEMA',N'dbo', N'TABLE',N'Tempo', N'COLUMN',N'ID_TEMPO'))\nEXEC sys.sp_dropextendedproperty @name=N'MS_Description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'Tempo', @level2type=N'COLUMN',@level2name=N'ID_TEMPO'\nGO\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dw].[Fato_Venda]') AND type in (N'U'))\nALTER TABLE [dw].[Fato_Venda] DROP CONSTRAINT IF EXISTS [FK_Fato_Venda_Dim_Tempo]\nGO\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dw].[Fato_Venda]') AND type in (N'U'))\nALTER TABLE [dw].[Fato_Venda] DROP CONSTRAINT IF EXISTS [FK_Fato_Venda_Dim_Produto]\nGO\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dw].[Fato_Venda]') AND type in (N'U'))\nALTER TABLE [dw].[Fato_Venda] DROP CONSTRAINT IF EXISTS [FK_Fato_Venda_Dim_loja]\nGO\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dw].[Fato_Venda]') AND type in (N'U'))\nALTER TABLE [dw].[Fato_Venda] DROP CONSTRAINT IF EXISTS [FK_Fato_Venda_Dim_Forma_Pagamento]\nGO\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dw].[Fato_Venda]') AND type in (N'U'))\nALTER TABLE [dw].[Fato_Venda] DROP CONSTRAINT IF EXISTS [FK_Fato_Venda_Dim_Cliente]\nGO\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dw].[Fato_Venda]') AND type in (N'U'))\nALTER TABLE [dw].[Fato_Venda] DROP CONSTRAINT IF EXISTS [DF__Fato_Vend__DATA___2803DB90]\nGO\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dw].[Fato_Venda]') AND type in (N'U'))\nALTER TABLE [dw].[Fato_Venda] DROP CONSTRAINT IF EXISTS [DF__Fato_Vend__DATA___270FB757]\nGO\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dw].[Dim_Tempo]') AND type in (N'U'))\nALTER TABLE [dw].[Dim_Tempo] DROP CONSTRAINT IF EXISTS [DF__Dim_Tempo__DATA___24334AAC]\nGO\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dw].[Dim_Tempo]') AND type in (N'U'))\nALTER TABLE [dw].[Dim_Tempo] DROP CONSTRAINT IF EXISTS [DF__Dim_Tempo__DATA___233F2673]\nGO\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dw].[Dim_Produto]') AND type in (N'U'))\nALTER TABLE [dw].[Dim_Produto] DROP CONSTRAINT IF EXISTS [DF__Dim_Produ__DATA___2062B9C8]\nGO\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dw].[Dim_Produto]') AND type in (N'U'))\nALTER TABLE [dw].[Dim_Produto] DROP CONSTRAINT IF EXISTS [DF__Dim_Produ__DATA___1F6E958F]\nGO\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dw].[Dim_Loja]') AND type in (N'U'))\nALTER TABLE [dw].[Dim_Loja] DROP CONSTRAINT IF EXISTS [DF__Dim_Loja__DATA_A__1C9228E4]\nGO\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dw].[Dim_Loja]') AND type in (N'U'))\nALTER TABLE [dw].[Dim_Loja] DROP CONSTRAINT IF EXISTS [DF__Dim_Loja__DATA_C__1B9E04AB]\nGO\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dw].[Dim_Forma_Pagamento]') AND type in (N'U'))\nALTER TABLE [dw].[Dim_Forma_Pagamento] DROP CONSTRAINT IF EXISTS [DF__Dim_Forma__DATA___18C19800]\nGO\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dw].[Dim_Forma_Pagamento]') AND type in (N'U'))\nALTER TABLE [dw].[Dim_Forma_Pagamento] DROP CONSTRAINT IF EXISTS [DF__Dim_Forma__DATA___17CD73C7]\nGO\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dw].[Dim_Cliente]') AND type in (N'U'))\nALTER TABLE [dw].[Dim_Cliente] DROP CONSTRAINT IF EXISTS [DF__Dim_Clien__DATA___14F1071C]\nGO\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dw].[Dim_Cliente]') AND type in (N'U'))\nALTER TABLE [dw].[Dim_Cliente] DROP CONSTRAINT IF EXISTS [DF__Dim_Clien__DATA___13FCE2E3]\nGO\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Tempo]') AND type in (N'U'))\nALTER TABLE [dbo].[Tempo] DROP CONSTRAINT IF EXISTS [DF__Tempo__DATA_ALTE__3CFEF876]\nGO\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Tempo]') AND type in (N'U'))\nALTER TABLE [dbo].[Tempo] DROP CONSTRAINT IF EXISTS [DF__Tempo__DATA_CADA__3C0AD43D]\nGO\n/****** Object:  Table [dw].[Fato_Venda]    Script Date: 15/02/2024 08:31:43 ******/\nDROP TABLE IF EXISTS [dw].[Fato_Venda]\nGO\n/****** Object:  Table [dw].[Dim_Tempo]    Script Date: 15/02/2024 08:31:43 ******/\nDROP TABLE IF EXISTS [dw].[Dim_Tempo]\nGO\n/****** Object:  Table [dw].[Dim_Produto]    Script Date: 15/02/2024 08:31:43 ******/\nDROP TABLE IF EXISTS [dw].[Dim_Produto]\nGO\n/****** Object:  Table [dw].[Dim_Loja]    Script Date: 15/02/2024 08:31:43 ******/\nDROP TABLE IF EXISTS [dw].[Dim_Loja]\nGO\n/****** Object:  Table [dw].[Dim_Forma_Pagamento]    Script Date: 15/02/2024 08:31:43 ******/\nDROP TABLE IF EXISTS [dw].[Dim_Forma_Pagamento]\nGO\n/****** Object:  Table [dw].[Dim_Cliente]    Script Date: 15/02/2024 08:31:43 ******/\nDROP TABLE IF EXISTS [dw].[Dim_Cliente]\nGO\n/****** Object:  Table [dbo].[Tempo]    Script Date: 15/02/2024 08:31:43 ******/\nDROP TABLE IF EXISTS [dbo].[Tempo]\nGO\n/****** Object:  Table [dbo].[Tempo]    Script Date: 15/02/2024 08:31:43 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dbo].[Tempo](\n    [ID_TEMPO] [varchar](100) NOT NULL,\n    [DATA] [varchar](10) NOT NULL,\n    [ANO] [int] NOT NULL,\n    [MES] [int] NOT NULL,\n    [DIA] [int] NOT NULL,\n    [DATA_CADASTRO] [datetime] NOT NULL,\n    [DATA_ALTERACAO] [datetime] NOT NULL,\n CONSTRAINT [PK_Tempo] PRIMARY KEY CLUSTERED \n(\n    [ID_TEMPO] ASC\n)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]\n) ON [PRIMARY]\nGO\n/****** Object:  Table [dw].[Dim_Cliente]    Script Date: 15/02/2024 08:31:43 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dw].[Dim_Cliente](\n    [ID_CLIENTE] [varchar](100) NOT NULL,\n    [CODIGO_CLIENTE] [int] NOT NULL,\n    [NOME_CLIENTE] [varchar](100) NOT NULL,\n    [DATA_NASCIMENTO] [date] NOT NULL,\n    [IDADE_CLIENTE] [int] NOT NULL,\n    [DESCRICAO_ENDERECO] [varchar](200) NOT NULL,\n    [NUMERO_ENDERECO] [int] NOT NULL,\n    [NOME_CIDADE] [varchar](100) NOT NULL,\n    [NUMERO_TELEFONE] [varchar](30) NOT NULL,\n    [EMAIL_CLIENTE] [varchar](100) NOT NULL,\n    [OCUPACAO_CLIENTE] [varchar](100) NOT NULL,\n    [DATA_CADASTRO] [datetime] NOT NULL,\n    [DATA_ALTERACAO] [datetime] NOT NULL,\n CONSTRAINT [PK_Dim_Cliente] PRIMARY KEY CLUSTERED \n(\n    [ID_CLIENTE] ASC\n)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]\n) ON [PRIMARY]\nGO\n/****** Object:  Table [dw].[Dim_Forma_Pagamento]    Script Date: 15/02/2024 08:31:43 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dw].[Dim_Forma_Pagamento](\n    [ID_FORMA_PAGAMENTO] [varchar](100) NOT NULL,\n    [CODIGO_FORMA_PAGAMENTO] [int] NOT NULL,\n    [DESCRICAO_FORMA_PAGAMENTO] [varchar](100) NOT NULL,\n    [DATA_CADASTRO] [datetime] NOT NULL,\n    [DATA_ALTERACAO] [datetime] NOT NULL,\n CONSTRAINT [PK_Dim_Forma_Pagamento] PRIMARY KEY CLUSTERED \n(\n    [ID_FORMA_PAGAMENTO] ASC\n)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]\n) ON [PRIMARY]\nGO\n/****** Object:  Table [dw].[Dim_Loja]    Script Date: 15/02/2024 08:31:43 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dw].[Dim_Loja](\n    [ID_LOJA] [varchar](100) NOT NULL,\n    [CODIGO_LOJA] [int] NOT NULL,\n    [NOME_LOJA] [varchar](100) NOT NULL,\n    [NOME_VENDEDOR] [varchar](100) NOT NULL,\n    [LOCALIDADE_LOJA] [varchar](100) NOT NULL,\n    [TIPO_LOJA] [varchar](100) NOT NULL,\n    [DATA_CADASTRO] [datetime] NOT NULL,\n    [DATA_ALTERACAO] [datetime] NOT NULL,\n CONSTRAINT [PK_Dim_Loja] PRIMARY KEY CLUSTERED \n(\n    [ID_LOJA] ASC\n)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]\n) ON [PRIMARY]\nGO\n/****** Object:  Table [dw].[Dim_Produto]    Script Date: 15/02/2024 08:31:43 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dw].[Dim_Produto](\n    [ID_PRODUTO] [varchar](100) NOT NULL,\n    [CODIGO_PRODUTO] [int] NOT NULL,\n    [DESCRICAO_PRODUTO] [varchar](100) NOT NULL,\n    [CATEGORIA_PRODUTO] [varchar](100) NOT NULL,\n    [SUB_CATEGORIA_PRODUTO] [varchar](100) NOT NULL,\n    [DATA_CADASTRO] [datetime] NOT NULL,\n    [DATA_ALTERACAO] [datetime] NOT NULL,\n CONSTRAINT [PK_Dim_Produto] PRIMARY KEY CLUSTERED \n(\n    [ID_PRODUTO] ASC\n)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]\n) ON [PRIMARY]\nGO\n/****** Object:  Table [dw].[Dim_Tempo]    Script Date: 15/02/2024 08:31:43 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dw].[Dim_Tempo](\n    [ID_TEMPO] [varchar](100) NOT NULL,\n    [DATA] [varchar](10) NOT NULL,\n    [ANO] [int] NOT NULL,\n    [MES] [int] NOT NULL,\n    [DIA] [int] NOT NULL,\n    [DATA_CADASTRO] [datetime] NOT NULL,\n    [DATA_ALTERACAO] [datetime] NOT NULL,\n CONSTRAINT [PK_Dim_Tempo] PRIMARY KEY CLUSTERED \n(\n    [ID_TEMPO] ASC\n)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]\n) ON [PRIMARY]\nGO\n/****** Object:  Table [dw].[Fato_Venda]    Script Date: 15/02/2024 08:31:43 ******/\nSET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\nCREATE TABLE [dw].[Fato_Venda](\n    [CODIGO_VENDA] [int] NOT NULL,\n    [ID_CLIENTE] [varchar](100) NOT NULL,\n    [ID_LOJA] [varchar](100) NOT NULL,\n    [ID_PRODUTO] [varchar](100) NOT NULL,\n    [ID_FORMA_PAGAMENTO] [varchar](100) NOT NULL,\n    [ID_TEMPO] [varchar](100) NOT NULL,\n    [HORA_VENDA] [int] NOT NULL,\n    [QUANTIDADE] [int] NOT NULL,\n    [VALOR_UNITARIO] [decimal](18, 2) NOT NULL,\n    [VALOR_FINAL] [decimal](18, 2) NOT NULL,\n    [TIPO_PAGAMENTO] [varchar](100) NOT NULL,\n    [DATA_CADASTRO] [datetime] NOT NULL,\n    [DATA_ALTERACAO] [datetime] NOT NULL,\n CONSTRAINT [PK_Fato_Venda] PRIMARY KEY CLUSTERED \n(\n    [CODIGO_VENDA] ASC,\n    [ID_CLIENTE] ASC,\n    [ID_LOJA] ASC,\n    [ID_PRODUTO] ASC,\n    [ID_FORMA_PAGAMENTO] ASC,\n    [ID_TEMPO] ASC\n)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]\n) ON [PRIMARY]\nGO\nALTER TABLE [dbo].[Tempo] ADD  DEFAULT (getdate()) FOR [DATA_CADASTRO]\nGO\nALTER TABLE [dbo].[Tempo] ADD  DEFAULT (getdate()) FOR [DATA_ALTERACAO]\nGO\nALTER TABLE [dw].[Dim_Cliente] ADD  DEFAULT (getdate()) FOR [DATA_CADASTRO]\nGO\nALTER TABLE [dw].[Dim_Cliente] ADD  DEFAULT (getdate()) FOR [DATA_ALTERACAO]\nGO\nALTER TABLE [dw].[Dim_Forma_Pagamento] ADD  DEFAULT (getdate()) FOR [DATA_CADASTRO]\nGO\nALTER TABLE [dw].[Dim_Forma_Pagamento] ADD  DEFAULT (getdate()) FOR [DATA_ALTERACAO]\nGO\nALTER TABLE [dw].[Dim_Loja] ADD  DEFAULT (getdate()) FOR [DATA_CADASTRO]\nGO\nALTER TABLE [dw].[Dim_Loja] ADD  DEFAULT (getdate()) FOR [DATA_ALTERACAO]\nGO\nALTER TABLE [dw].[Dim_Produto] ADD  DEFAULT (getdate()) FOR [DATA_CADASTRO]\nGO\nALTER TABLE [dw].[Dim_Produto] ADD  DEFAULT (getdate()) FOR [DATA_ALTERACAO]\nGO\nALTER TABLE [dw].[Dim_Tempo] ADD  DEFAULT (getdate()) FOR [DATA_CADASTRO]\nGO\nALTER TABLE [dw].[Dim_Tempo] ADD  DEFAULT (getdate()) FOR [DATA_ALTERACAO]\nGO\nALTER TABLE [dw].[Fato_Venda] ADD  DEFAULT (getdate()) FOR [DATA_CADASTRO]\nGO\nALTER TABLE [dw].[Fato_Venda] ADD  DEFAULT (getdate()) FOR [DATA_ALTERACAO]\nGO\nALTER TABLE [dw].[Fato_Venda]  WITH CHECK ADD  CONSTRAINT [FK_Fato_Venda_Dim_Cliente] FOREIGN KEY([ID_CLIENTE])\nREFERENCES [dw].[Dim_Cliente] ([ID_CLIENTE])\nGO\nALTER TABLE [dw].[Fato_Venda] CHECK CONSTRAINT [FK_Fato_Venda_Dim_Cliente]\nGO\nALTER TABLE [dw].[Fato_Venda]  WITH CHECK ADD  CONSTRAINT [FK_Fato_Venda_Dim_Forma_Pagamento] FOREIGN KEY([ID_FORMA_PAGAMENTO])\nREFERENCES [dw].[Dim_Forma_Pagamento] ([ID_FORMA_PAGAMENTO])\nGO\nALTER TABLE [dw].[Fato_Venda] CHECK CONSTRAINT [FK_Fato_Venda_Dim_Forma_Pagamento]\nGO\nALTER TABLE [dw].[Fato_Venda]  WITH CHECK ADD  CONSTRAINT [FK_Fato_Venda_Dim_loja] FOREIGN KEY([ID_LOJA])\nREFERENCES [dw].[Dim_Loja] ([ID_LOJA])\nGO\nALTER TABLE [dw].[Fato_Venda] CHECK CONSTRAINT [FK_Fato_Venda_Dim_loja]\nGO\nALTER TABLE [dw].[Fato_Venda]  WITH CHECK ADD  CONSTRAINT [FK_Fato_Venda_Dim_Produto] FOREIGN KEY([ID_PRODUTO])\nREFERENCES [dw].[Dim_Produto] ([ID_PRODUTO])\nGO\nALTER TABLE [dw].[Fato_Venda] CHECK CONSTRAINT [FK_Fato_Venda_Dim_Produto]\nGO\nALTER TABLE [dw].[Fato_Venda]  WITH CHECK ADD  CONSTRAINT [FK_Fato_Venda_Dim_Tempo] FOREIGN KEY([ID_TEMPO])\nREFERENCES [dw].[Dim_Tempo] ([ID_TEMPO])\nGO\nALTER TABLE [dw].[Fato_Venda] CHECK CONSTRAINT [FK_Fato_Venda_Dim_Tempo]\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Chave da Dimens\u00e3o Tempo' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'Tempo', @level2type=N'COLUMN',@level2name=N'ID_TEMPO'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Identifica a Data' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'Tempo', @level2type=N'COLUMN',@level2name=N'DATA'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Ano referente a coluna data.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'Tempo', @level2type=N'COLUMN',@level2name=N'ANO'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'M\u00eas referente a coluna data.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'Tempo', @level2type=N'COLUMN',@level2name=N'MES'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Dia referente a coluna data.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'Tempo', @level2type=N'COLUMN',@level2name=N'DIA'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Data de Cadastro do Registro.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'Tempo', @level2type=N'COLUMN',@level2name=N'DATA_CADASTRO'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Data de Atualiza\u00e7\u00e3o do Registro.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'Tempo', @level2type=N'COLUMN',@level2name=N'DATA_ALTERACAO'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Chave da Dimens\u00e3o Cliente' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Cliente', @level2type=N'COLUMN',@level2name=N'ID_CLIENTE'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'C\u00f3digo do Cliente' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Cliente', @level2type=N'COLUMN',@level2name=N'CODIGO_CLIENTE'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Nome do Cliente' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Cliente', @level2type=N'COLUMN',@level2name=N'NOME_CLIENTE'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Data de Nascimento do Cliente' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Cliente', @level2type=N'COLUMN',@level2name=N'DATA_NASCIMENTO'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Idade do Cliente' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Cliente', @level2type=N'COLUMN',@level2name=N'IDADE_CLIENTE'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Endere\u00e7o do Cliente' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Cliente', @level2type=N'COLUMN',@level2name=N'DESCRICAO_ENDERECO'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Numero da Residencia do Cliente' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Cliente', @level2type=N'COLUMN',@level2name=N'NUMERO_ENDERECO'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Cidade de Resid\u00eancia do Cliente' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Cliente', @level2type=N'COLUMN',@level2name=N'NOME_CIDADE'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Telefone do Cliente' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Cliente', @level2type=N'COLUMN',@level2name=N'NUMERO_TELEFONE'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'E-mail do Cliente' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Cliente', @level2type=N'COLUMN',@level2name=N'EMAIL_CLIENTE'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Ocupa\u00e7\u00e3o do cliente' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Cliente', @level2type=N'COLUMN',@level2name=N'OCUPACAO_CLIENTE'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Data de Cadastro do Registro.' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Cliente', @level2type=N'COLUMN',@level2name=N'DATA_CADASTRO'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Data de Atualiza\u00e7\u00e3o do Registro.' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Cliente', @level2type=N'COLUMN',@level2name=N'DATA_ALTERACAO'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Chave da Dimens\u00e3o Forma de Pagamento.' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Forma_Pagamento', @level2type=N'COLUMN',@level2name=N'ID_FORMA_PAGAMENTO'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'C\u00f3digo da Forma de Pagamento' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Forma_Pagamento', @level2type=N'COLUMN',@level2name=N'CODIGO_FORMA_PAGAMENTO'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Descri\u00e7\u00e3o da Forma de Pagamento' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Forma_Pagamento', @level2type=N'COLUMN',@level2name=N'DESCRICAO_FORMA_PAGAMENTO'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Data de Cadastro do Registro.' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Forma_Pagamento', @level2type=N'COLUMN',@level2name=N'DATA_CADASTRO'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Data de Atualiza\u00e7\u00e3o do Registro.' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Forma_Pagamento', @level2type=N'COLUMN',@level2name=N'DATA_ALTERACAO'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Chave da Dimens\u00e3o Loja' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Loja', @level2type=N'COLUMN',@level2name=N'ID_LOJA'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'C\u00f3digo da Loja' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Loja', @level2type=N'COLUMN',@level2name=N'CODIGO_LOJA'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Nome da Loja' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Loja', @level2type=N'COLUMN',@level2name=N'NOME_LOJA'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Nome do Vendedor.' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Loja', @level2type=N'COLUMN',@level2name=N'NOME_VENDEDOR'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Localidade da Loja.' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Loja', @level2type=N'COLUMN',@level2name=N'LOCALIDADE_LOJA'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Tipo da Loja.' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Loja', @level2type=N'COLUMN',@level2name=N'TIPO_LOJA'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Data de Cadastro do Registro.' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Loja', @level2type=N'COLUMN',@level2name=N'DATA_CADASTRO'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Data de Atualiza\u00e7\u00e3o do Registro.' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Loja', @level2type=N'COLUMN',@level2name=N'DATA_ALTERACAO'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Chave da Dimens\u00e3o Produto.' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Produto', @level2type=N'COLUMN',@level2name=N'ID_PRODUTO'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'C\u00f3digo do Produto' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Produto', @level2type=N'COLUMN',@level2name=N'CODIGO_PRODUTO'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Descri\u00e7\u00e3o do Produto' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Produto', @level2type=N'COLUMN',@level2name=N'DESCRICAO_PRODUTO'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Descri\u00e7\u00e3o da Categoria do Produto.' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Produto', @level2type=N'COLUMN',@level2name=N'CATEGORIA_PRODUTO'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Descri\u00e7\u00e3o da Categoria do Produto.' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Produto', @level2type=N'COLUMN',@level2name=N'SUB_CATEGORIA_PRODUTO'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Data de Cadastro do Registro.' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Produto', @level2type=N'COLUMN',@level2name=N'DATA_CADASTRO'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Data de Atualiza\u00e7\u00e3o do Registro.' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Produto', @level2type=N'COLUMN',@level2name=N'DATA_ALTERACAO'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Chave da Dimens\u00e3o Tempo' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Tempo', @level2type=N'COLUMN',@level2name=N'ID_TEMPO'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Identifica a Data' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Tempo', @level2type=N'COLUMN',@level2name=N'DATA'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Ano referente a coluna data.' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Tempo', @level2type=N'COLUMN',@level2name=N'ANO'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'M\u00eas referente a coluna data.' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Tempo', @level2type=N'COLUMN',@level2name=N'MES'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Dia referente a coluna data.' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Tempo', @level2type=N'COLUMN',@level2name=N'DIA'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Data de Cadastro do Registro.' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Tempo', @level2type=N'COLUMN',@level2name=N'DATA_CADASTRO'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Data de Atualiza\u00e7\u00e3o do Registro.' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Dim_Tempo', @level2type=N'COLUMN',@level2name=N'DATA_ALTERACAO'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'C\u00f3digo da Venda' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Fato_Venda', @level2type=N'COLUMN',@level2name=N'CODIGO_VENDA'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Chave da Dimens\u00e3o Cliente.' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Fato_Venda', @level2type=N'COLUMN',@level2name=N'ID_CLIENTE'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Chave da Dimens\u00e3o Loja.' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Fato_Venda', @level2type=N'COLUMN',@level2name=N'ID_LOJA'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Chave da Dimens\u00e3o Categoria do Produto.' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Fato_Venda', @level2type=N'COLUMN',@level2name=N'ID_PRODUTO'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Chave da Dimens\u00e3o Forma de Pagamento' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Fato_Venda', @level2type=N'COLUMN',@level2name=N'ID_FORMA_PAGAMENTO'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Chave da Dimens\u00e3o Tempo' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Fato_Venda', @level2type=N'COLUMN',@level2name=N'ID_TEMPO'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Hora em que a venda foi realizada' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Fato_Venda', @level2type=N'COLUMN',@level2name=N'HORA_VENDA'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Quantidade vendida do produto' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Fato_Venda', @level2type=N'COLUMN',@level2name=N'QUANTIDADE'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Valor unit\u00e1rio do produto' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Fato_Venda', @level2type=N'COLUMN',@level2name=N'VALOR_UNITARIO'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Valor total vendido do produto.em uma venda' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Fato_Venda', @level2type=N'COLUMN',@level2name=N'VALOR_FINAL'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Tipo de Pagamentto da Venda' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Fato_Venda', @level2type=N'COLUMN',@level2name=N'TIPO_PAGAMENTO'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Data de Cadastro do Registro.' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Fato_Venda', @level2type=N'COLUMN',@level2name=N'DATA_CADASTRO'\nGO\nEXEC sys.sp_addextendedproperty @name=N'MS_Description', @value=N'Data de Atualiza\u00e7\u00e3o do Registro.' , @level0type=N'SCHEMA',@level0name=N'dw', @level1type=N'TABLE',@level1name=N'Fato_Venda', @level2type=N'COLUMN',@level2name=N'DATA_ALTERACAO'\nGO\n</code></pre>"},{"location":"4_configuracao_ambiente_databricks/","title":"Projeto BI Zero TO DW","text":""},{"location":"4_configuracao_ambiente_databricks/#4-configurando-o-ambiente-databricks","title":"4 - Configurando o Ambiente Databricks","text":"<p>\u00c9 nessa etapa que \u00e9 realizada a configura\u00e7\u00e3o do ambiente Databricks para ingest\u00e3o dos dados.</p> <p>S\u00e3o elas:</p> Sequ\u00eancia A\u00e7\u00e3o Detalhamento SEQ-4.0 Importa\u00e7\u00e3o de Bibliotecas Defini\u00e7\u00e3o de quais bibliotecas estar\u00e3o sendo usada SEQ-4.0.1 Importa\u00e7\u00e3o de Notebook Externo Ser\u00e1 usado para criar a tabela Dimens\u00e3o Tempo SEQ-4.1 Configura\u00e7\u00e3o do ambiente no Databricks Cria\u00e7\u00e3o do storage \"dbfs:/FileStore/tables/landing_zone\" SEQ-4.2 / SEQ-4.3 / SEQ-4.4 Cria\u00e7\u00e3o de Schemas (Bancos de Dados) Cria\u00e7\u00e3o das Camadas Bronze, Silver e Gold SEQ-4.5 / SEQ-4.6 / SEQ-4.7 Cria\u00e7\u00e3o das Tabelas Cria\u00e7\u00e3o das Tabelas das Camadas Bronze, Silver e Gold SEQ-4.8 Cria\u00e7\u00e3o Script Dimens\u00e3o Tempo Gera\u00e7\u00e3o de Scripts de Insert para a Dimens\u00e3o Tempo para o m\u00eas de Jul/2023 SEQ-4.9 Visualizando a Estrutura de uma tabela Identificando informa\u00e7\u00f5es de nome da coluna, datatype, nulabilidade, descri\u00e7\u00e3o das colunas SEQ-4.10 Visualizando inform\u00e7oes de armazenamento de uma tabela Idenfica\u00e7\u00e3o de quando a tabela foi criada, onde ela \u00e9 armazenada etc. SEQ-4.11 Visualizando a Estrutura de uma schema Informa\u00e7\u00f5es do Schema <p>O arquivo do Notebook \u00e9 encontrado aqui. Notebook Configura\u00e7\u00e3o Ambiente Databricks</p>"},{"location":"4_configuracao_ambiente_databricks/#seq-40-importacao-de-bibliotecas","title":"SEQ-4.0 - Importa\u00e7\u00e3o de Bibliotecas","text":"Bibliotecas Usadas<pre><code>from pyspark.sql.functions import *\nfrom datetime import date, timedelta\n</code></pre>"},{"location":"4_configuracao_ambiente_databricks/#seq-401-importando-notebook-externo","title":"SEQ-4.0.1 - Importando Notebook Externo","text":"Notebook Externo<pre><code>%run /estudos/libs/bibliotecas\n</code></pre>"},{"location":"4_configuracao_ambiente_databricks/#seq-41-criacao-camada-landing-zone","title":"SEQ-4.1 - Cria\u00e7\u00e3o Camada Landing Zone","text":"<p>Nessa etapa que \u00e9 realizada a cria\u00e7\u00e3o de uma \u00e1rea no HDFS do Databricks para salvar em formato parquet os dados exportados do Azure SQL Database.</p> <p>Nome do Diret\u00f3rio: dbfs:/FileStore/tables/landing_zone</p> Cria\u00e7\u00e3o do Diret\u00f3rio no HDFS do Databricks<pre><code>diretorio_landing_zone = \"dbfs:/FileStore/tables/landing_zone\"\n\ntry:\n    dbutils.fs.ls(diretorio_landing_zone)\n    dbutils.fs.rm(diretorio_landing_zone, True)\n\nexcept:\n\n    print(f\"O diret\u00f3rio {diretorio_landing_zone} n\u00e3o existe.\")\n</code></pre> Cria\u00e7\u00e3o do Diret\u00f3rio no HDFS do Databricks<pre><code>try:\n\n    dbutils.fs.ls(diretorio_landing_zone)\n\nexcept:\n\n    print(f\"O diret\u00f3rio {diretorio_landing_zone} n\u00e3o existe e ser\u00e1 criado.\")\n    dbutils.fs.mkdirs(diretorio_landing_zone)\n</code></pre>"},{"location":"4_configuracao_ambiente_databricks/#seq-42-criacao-schema-de-dados-bronze","title":"SEQ-4.2 - Cria\u00e7\u00e3o Schema de Dados \"bronze\"","text":"<p>Cria\u00e7\u00e3o do Schema de Dados \"bronze\" para armazenamento dos dados ingeridos a partir da leituda dos arquivos de dados exportados do Azure SQL Database.</p> <p>Trata-se de uma camada transiente, ou seja, \u00e9 o momento em que os dados s\u00e3o carregados em sua totalidade sem a aplica\u00e7\u00e3o de tratamentos. </p> <p>Gosto de definir essa etapa como a transposi\u00e7\u00e3o dos arquivos em tabelas, usando o mesmo nome para criar as tabelas e colunas. </p> <p>Nenhum tratamento \u00e9 aplicado sobre os dados.</p> <p>As tabelas s\u00e3o TRUNCADAS (limpas) sempre a cada ciclo de carga.</p> <p>A sintaxe do script de cria\u00e7\u00e3o de um Schema.</p> <p></p> Exclus\u00e3o do Schema caso exista<pre><code>%sql\nDROP SCHEMA IF EXISTS bronze CASCADE;\n</code></pre> Cria\u00e7\u00e3o do Schema<pre><code>%sql\nCREATE SCHEMA IF NOT EXISTS bronze COMMENT 'SCHEMA (Banco de Dados) referente a Camada BRONZE.';\n</code></pre> Removendo o location das tabelas no HDFS<pre><code>dbutils.fs.rm('dbfs:/user/hive/warehouse/bronze.db/tb_forma_pagamento', True);\ndbutils.fs.rm('dbfs:/user/hive/warehouse/bronze.db/tb_categoria_produto', True);\ndbutils.fs.rm('dbfs:/user/hive/warehouse/bronze.db/tb_produto', True);\ndbutils.fs.rm('dbfs:/user/hive/warehouse/bronze.db/tb_cliente', True);\ndbutils.fs.rm('dbfs:/user/hive/warehouse/bronze.db/tb_vendedor', True);\ndbutils.fs.rm('dbfs:/user/hive/warehouse/bronze.db/tb_loja', True);\ndbutils.fs.rm('dbfs:/user/hive/warehouse/bronze.db/tb_venda', True);\ndbutils.fs.rm('dbfs:/user/hive/warehouse/bronze.db/tb_item_venda', True);\n</code></pre>"},{"location":"4_configuracao_ambiente_databricks/#seq-43-criacao-schema-de-dados-silver","title":"SEQ-4.3 - Cria\u00e7\u00e3o Schema de Dados \"silver\"","text":"<p>Cria\u00e7\u00e3o do Schema de Dados \"silver\" para armazenamento dos dados ingeridos da camada bronze.</p> <p>Nessa camada os dados sofreram transforma\u00e7\u00f5es (aplica\u00e7\u00f5es de regras de neg\u00f3cio) e estar\u00e3o dispon\u00edveis para que seja criada a camada dimensional.</p> <p>Exclus\u00e3o do Schema caso exista<pre><code>%sql\nDROP SCHEMA IF EXISTS silver CASCADE;\n</code></pre> Cria\u00e7\u00e3o do Schema<pre><code>%sql\nCREATE SCHEMA IF NOT EXISTS silver COMMENT 'SCHEMA (Banco de Dados) referente a Camada SILVER.';\n</code></pre></p> Removendo o location das tabelas no HDFS<pre><code>dbutils.fs.rm('dbfs:/user/hive/warehouse/silver.db/tb_forma_pagamento', True);\ndbutils.fs.rm('dbfs:/user/hive/warehouse/silver.db/tb_categoria_produto', True);\ndbutils.fs.rm('dbfs:/user/hive/warehouse/silver.db/tb_produto', True);\ndbutils.fs.rm('dbfs:/user/hive/warehouse/silver.db/tb_cliente', True);\ndbutils.fs.rm('dbfs:/user/hive/warehouse/silver.db/tb_vendedor', True);\ndbutils.fs.rm('dbfs:/user/hive/warehouse/silver.db/tb_loja', True);\ndbutils.fs.rm('dbfs:/user/hive/warehouse/silver.db/tb_venda', True);\ndbutils.fs.rm('dbfs:/user/hive/warehouse/silver.db/tb_item_venda', True);\n</code></pre>"},{"location":"4_configuracao_ambiente_databricks/#seq-44-criacao-schema-de-dados-gold","title":"SEQ-4.4 - Cria\u00e7\u00e3o Schema de Dados \"gold\"","text":"<p>Cria\u00e7\u00e3o do Schema de Dados \"gold\" para armazenamento dos dados ap\u00f3s a ingest\u00e3o dos dados na camada silver.</p> <p>Nessa camada os objetos ser\u00e3o modelados como dimens\u00f5es e fatos.</p> <p>Exclus\u00e3o do Schema caso exista<pre><code>%sql\nDROP SCHEMA IF EXISTS gold CASCADE;\n</code></pre> Cria\u00e7\u00e3o do Schema<pre><code>%sql\nCREATE SCHEMA IF NOT EXISTS gold COMMENT 'SCHEMA (Banco de Dados) referente a Camada GOLD.';\n</code></pre></p> Removendo o location das tabelas no HDFS<pre><code>dbutils.fs.rm('dbfs:/user/hive/warehouse/gold.db/dim_forma_pagamento', True);\ndbutils.fs.rm('dbfs:/user/hive/warehouse/gold.db/dim_categoria_produto', True);\ndbutils.fs.rm('dbfs:/user/hive/warehouse/gold.db/dim_produto', True);\ndbutils.fs.rm('dbfs:/user/hive/warehouse/gold.db/dim_cliente', True);\ndbutils.fs.rm('dbfs:/user/hive/warehouse/gold.db/dim_vendedor', True);\ndbutils.fs.rm('dbfs:/user/hive/warehouse/gold.db/dim_loja', True);\ndbutils.fs.rm('dbfs:/user/hive/warehouse/gold.db/fato_venda', True);\ndbutils.fs.rm('dbfs:/user/hive/warehouse/gold.db/dim_tempo', True);\n</code></pre> <p>Documenta\u00e7\u00e3o Create Schema Databricks</p>"},{"location":"4_configuracao_ambiente_databricks/#seq-45-create-table-schema-bronze","title":"SEQ-4.5 - CREATE TABLE schema \"bronze\"","text":"<p>Cria\u00e7\u00e3o das tabelas no Schema de Dados \"bronze\" com a mesma estrutura dos arquivos.</p> <p>Nessa etapa, as tabelas ser\u00e3o criadas as tabelas no Schema bronze.</p> <p>A sintaxe do script \u00e9 muito parecida com que possu\u00edmos em bancos de dados.</p> <p></p> Cria\u00e7\u00e3o das Tabelas no Schema Bronze<pre><code>%sql\n\nDROP  TABLE IF EXISTS bronze.tb_forma_pagamento;\nCREATE TABLE bronze.tb_forma_pagamento\n(\nCODIGO_FORMA_PAGAMENTO   INT COMMENT 'C\u00f3digo da Forma de Pagamento na Tabela TB_FORMA_PAGAMENTO.'\n,DESCRICAO_FORMA_PAGAMENTO VARCHAR(100) COMMENT 'Descri\u00e7\u00e3o da Forma de Pagamento na Tabela TB_FORMA_PAGAMENTO.'\n)\nCOMMENT 'Armazena informa\u00e7\u00f5es de forma de pagamento.';\n\nDROP  TABLE IF EXISTS bronze.tb_categoria_produto;\nCREATE TABLE bronze.tb_categoria_produto\n(\nCODIGO_CATEGORIA INT COMMENT 'C\u00f3digo da Categoria do Produto.'\n,DECRICAO_CATEGORIA VARCHAR(100) COMMENT 'Descri\u00e7\u00e3o da Categoria do Produto.'\n)\nCOMMENT 'Armazena informa\u00e7\u00f5es das categorias dos produtos';\n\nDROP  TABLE IF EXISTS bronze.tb_produto;\nCREATE TABLE bronze.tb_produto\n(\nCODIGO_PRODUTO   INT  COMMENT 'C\u00f3digo do Produto.'\n,DESCRICAO_PRODUTO   VARCHAR(100) COMMENT 'Descri\u00e7\u00e3o do Produto.'\n,CODIGO_CATEGORIA INT COMMENT 'Categoria do Produto.'\n)\nCOMMENT '   Armazena informa\u00e7\u00f5es de produtos.';\n\nDROP  TABLE IF EXISTS bronze.tb_cliente;\nCREATE TABLE bronze.tb_cliente\n(\nCODIGO_CLIENTE INT COMMENT 'C\u00f3digo do Cliente.'\n,NOME_CLIENTE VARCHAR(100) COMMENT 'Nome do Cliente.'\n)\nCOMMENT 'Armazena informa\u00e7\u00f5es de clientes.';\n\nDROP  TABLE IF EXISTS bronze.tb_vendedor;\nCREATE TABLE bronze.tb_vendedor\n(\nCODIGO_VENDEDOR INT COMMENT 'C\u00f3digo do Vendedor.'\n,NOME_VENDEDOR VARCHAR(100) COMMENT 'Nome do Vendedor.'\n)\nCOMMENT 'Armazena informa\u00e7\u00f5es de vendedores.';\n\nDROP  TABLE IF EXISTS bronze.tb_loja;\nCREATE TABLE bronze.tb_loja\n(\nCODIGO_LOJA  INT COMMENT 'C\u00f3digo da Loja.'\n,NOME_LOJA   VARCHAR(100) COMMENT 'Nome da Loja.'\n,LOCALIDADE_LOJA     VARCHAR(100) COMMENT 'Localidade da Loja.'\n,TIPO_LOJA VARCHAR(100) COMMENT 'Tipo da Loja.'\n)\nCOMMENT 'Armazena informa\u00e7\u00f5es de lojas.';\n\nDROP  TABLE IF EXISTS bronze.tb_venda;\nCREATE TABLE bronze.tb_venda\n(\nCODIGO_VENDA INT COMMENT 'C\u00f3digo da Venda.'\n,DATA_VENDA TIMESTAMP COMMENT 'Data da Venda'\n,CODIGO_CLIENTE INT COMMENT 'C\u00f3digo do Cliente.'\n,CODIGO_VENDEDOR    INT COMMENT 'C\u00f3digo do Vendedor.'\n,CODIGO_LOJA    INT COMMENT 'C\u00f3digo da Loja.'\n,VALOR_FINAL DECIMAL(18,2)   COMMENT 'Valor Total da Venda.'\n,FORMA_PAGAMENTO    INT COMMENT 'Forma de Pagamento.'\n,TIPO_PAGAMENTO VARCHAR(100) COMMENT 'Tipo de Pagamento.'\n)\nCOMMENT 'Armazenada informa\u00e7\u00f5es de vendas.';\n\nDROP  TABLE IF EXISTS bronze.tb_item_venda;\nCREATE TABLE bronze.tb_item_venda\n(\nCODIGO_VENDA INT COMMENT 'C\u00f3digo da Venda.'\n,CODIGO_PRODUTO INT COMMENT 'C\u00f3digo do Produto.'\n,VALOR_UNITARIO DECIMAL(18,2)    COMMENT 'Valor Unit\u00e1rio do Produto.'\n,QUANTIDADE INT COMMENT 'Quantidade do Produto Vendido.'\n,VALOR_FINAL DECIMAL(18,2) COMMENT 'Valor Final do Produto Vendido.'\n)\nCOMMENT 'Armazena informa\u00e7\u00f5es sobre os itens que foram vendidos.';\n</code></pre>"},{"location":"4_configuracao_ambiente_databricks/#seq-46-create-table-schema-silver","title":"SEQ-4.6 - CREATE TABLE schema \"silver\"","text":"<p>Cria\u00e7\u00e3o das tabelas no Schema de Dados \"silver\".</p> Cria\u00e7\u00e3o das Tabelas no Schema Silver<pre><code>%sql\n\nDROP  TABLE IF EXISTS silver.tb_forma_pagamento;\nCREATE TABLE silver.tb_forma_pagamento\n(\nCODIGO_FORMA_PAGAMENTO   INT COMMENT 'C\u00f3digo da Forma de Pagamento na Tabela TB_FORMA_PAGAMENTO.'\n,DESCRICAO_FORMA_PAGAMENTO VARCHAR(100) COMMENT 'Descri\u00e7\u00e3o da Forma de Pagamento na Tabela TB_FORMA_PAGAMENTO.'\n,DATA_CADASTRO TIMESTAMP COMMENT 'Data de Cadastro do Registro.'\n,DATA_ALTERACAO TIMESTAMP COMMENT 'Data de Atualiza\u00e7\u00e3o do Registro.'\n)\nCOMMENT 'Armazena informa\u00e7\u00f5es de forma de pagamento.';\n\nDROP  TABLE IF EXISTS silver.tb_categoria_produto;\nCREATE TABLE silver.tb_categoria_produto\n(\nCODIGO_CATEGORIA INT COMMENT 'C\u00f3digo da Categoria do Produto.'\n,DECRICAO_CATEGORIA VARCHAR(100) COMMENT 'Descri\u00e7\u00e3o da Categoria do Produto.'\n,DATA_CADASTRO TIMESTAMP COMMENT 'Data de Cadastro do Registro.'\n,DATA_ALTERACAO TIMESTAMP COMMENT 'Data de Atualiza\u00e7\u00e3o do Registro.'\n)\nCOMMENT 'Armazena informa\u00e7\u00f5es das categorias dos produtos';\n\nDROP  TABLE IF EXISTS silver.tb_produto;\nCREATE TABLE silver.tb_produto\n(\nCODIGO_PRODUTO   INT  COMMENT 'C\u00f3digo do Produto.'\n,DESCRICAO_PRODUTO   VARCHAR(100) COMMENT 'Descri\u00e7\u00e3o do Produto.'\n,CODIGO_CATEGORIA INT COMMENT 'Categoria do Produto.'\n,DATA_CADASTRO TIMESTAMP COMMENT 'Data de Cadastro do Registro.'\n,DATA_ALTERACAO TIMESTAMP COMMENT 'Data de Atualiza\u00e7\u00e3o do Registro.'\n)\nCOMMENT '   Armazena informa\u00e7\u00f5es de produtos.';\n\nDROP  TABLE IF EXISTS silver.tb_cliente;\nCREATE TABLE silver.tb_cliente\n(\nCODIGO_CLIENTE INT COMMENT 'C\u00f3digo do Cliente.'\n,NOME_CLIENTE VARCHAR(100) COMMENT 'Nome do Cliente.'\n,DATA_CADASTRO TIMESTAMP COMMENT 'Data de Cadastro do Registro.'\n,DATA_ALTERACAO TIMESTAMP COMMENT 'Data de Atualiza\u00e7\u00e3o do Registro.'\n)\nCOMMENT 'Armazena informa\u00e7\u00f5es de clientes.';\n\nDROP  TABLE IF EXISTS silver.tb_vendedor;\nCREATE TABLE silver.tb_vendedor\n(\nCODIGO_VENDEDOR INT COMMENT 'C\u00f3digo do Vendedor.'\n,NOME_VENDEDOR VARCHAR(100) COMMENT 'Nome do Vendedor.'\n,DATA_CADASTRO TIMESTAMP COMMENT 'Data de Cadastro do Registro.'\n,DATA_ALTERACAO TIMESTAMP COMMENT 'Data de Atualiza\u00e7\u00e3o do Registro.'\n)\nCOMMENT 'Armazena informa\u00e7\u00f5es de vendedores.';\n\nDROP  TABLE IF EXISTS silver.tb_loja;\nCREATE TABLE silver.tb_loja\n(\nCODIGO_LOJA  INT COMMENT 'C\u00f3digo da Loja.'\n,NOME_LOJA   VARCHAR(100) COMMENT 'Nome da Loja.'\n,LOCALIDADE_LOJA     VARCHAR(100) COMMENT 'Localidade da Loja.'\n,TIPO_LOJA VARCHAR(100) COMMENT 'Tipo da Loja.'\n,DATA_CADASTRO TIMESTAMP COMMENT 'Data de Cadastro do Registro.'\n,DATA_ALTERACAO TIMESTAMP COMMENT 'Data de Atualiza\u00e7\u00e3o do Registro.'\n)\nCOMMENT 'Armazena informa\u00e7\u00f5es de lojas.';\n\nDROP  TABLE IF EXISTS silver.tb_venda;\nCREATE TABLE silver.tb_venda\n(\nCODIGO_VENDA INT COMMENT 'C\u00f3digo da Venda.'\n,DATA_VENDA TIMESTAMP COMMENT 'Data da Venda'\n,CODIGO_CLIENTE INT COMMENT 'C\u00f3digo do Cliente.'\n,CODIGO_VENDEDOR    INT COMMENT 'C\u00f3digo do Vendedor.'\n,CODIGO_LOJA    INT COMMENT 'C\u00f3digo da Loja.'\n,VALOR_FINAL DECIMAL(18,2)   COMMENT 'Valor Total da Venda.'\n,FORMA_PAGAMENTO    INT COMMENT 'Forma de Pagamento.'\n,TIPO_PAGAMENTO VARCHAR(100) COMMENT 'Tipo de Pagamento.'\n,DATA_CADASTRO TIMESTAMP COMMENT 'Data de Cadastro do Registro.'\n,DATA_ALTERACAO TIMESTAMP COMMENT 'Data de Atualiza\u00e7\u00e3o do Registro.'\n)\nCOMMENT 'Armazenada informa\u00e7\u00f5es de vendas.';\n\nDROP  TABLE IF EXISTS silver.tb_item_venda;\nCREATE TABLE silver.tb_item_venda\n(\nCODIGO_VENDA INT COMMENT 'C\u00f3digo da Venda.'\n,CODIGO_PRODUTO INT COMMENT 'C\u00f3digo do Produto.'\n,VALOR_UNITARIO DECIMAL(18,2)    COMMENT 'Valor Unit\u00e1rio do Produto.'\n,QUANTIDADE INT COMMENT 'Quantidade do Produto Vendido.'\n,VALOR_FINAL DECIMAL(18,2) COMMENT 'Valor Final do Produto Vendido.'\n,DATA_CADASTRO TIMESTAMP COMMENT 'Data de Cadastro do Registro.'\n,DATA_ALTERACAO TIMESTAMP COMMENT 'Data de Atualiza\u00e7\u00e3o do Registro.'\n)\nCOMMENT 'Armazena informa\u00e7\u00f5es sobre os itens que foram vendidos.';\n</code></pre>"},{"location":"4_configuracao_ambiente_databricks/#seq-47-create-table-schema-gold","title":"SEQ-4.7 - CREATE TABLE schema \"gold\"","text":"<p>Cria\u00e7\u00e3o das tabelas no Schema de Dados \"gold\".</p> Cria\u00e7\u00e3o das Tabelas no Schema Gold<pre><code>%sql\n\nDROP  TABLE IF EXISTS gold.dim_forma_pagamento;\nCREATE TABLE gold.dim_forma_pagamento\n(\nID_FORMA_PAGAMENTO VARCHAR(100) COMMENT 'Chave da Dimens\u00e3o Forma de Pagamento.'\n,CODIGO_FORMA_PAGAMENTO  INT COMMENT 'C\u00f3digo da Forma de Pagamento na Tabela TB_FORMA_PAGAMENTO.'\n,DESCRICAO_FORMA_PAGAMENTO VARCHAR(100) COMMENT 'Descri\u00e7\u00e3o da Forma de Pagamento na Tabela TB_FORMA_PAGAMENTO.'\n,DATA_CADASTRO TIMESTAMP COMMENT 'Data de Cadastro do Registro.'\n,DATA_ALTERACAO TIMESTAMP COMMENT 'Data de Atualiza\u00e7\u00e3o do Registro.'\n);\n\nDROP  TABLE IF EXISTS gold.dim_produto;\nCREATE TABLE gold.dim_produto\n(\nID_PRODUTO VARCHAR(100) COMMENT 'Chave da Dimens\u00e3o Produto.'\n,CODIGO_PRODUTO  INT  COMMENT 'C\u00f3digo do Produto.'\n,DESCRICAO_PRODUTO VARCHAR(100) COMMENT 'Descri\u00e7\u00e3o do Produto.'\n,CATEGORIA_PRODUTO VARCHAR(100) COMMENT 'Categoria do Produto.'\n,SUB_CATEGORIA_PRODUTO VARCHAR(100) COMMENT 'Categoria do Produto.'\n,DATA_CADASTRO TIMESTAMP COMMENT 'Data de Cadastro do Registro.'\n,DATA_ALTERACAO TIMESTAMP COMMENT 'Data de Atualiza\u00e7\u00e3o do Registro.'\n);\n\nDROP  TABLE IF EXISTS gold.dim_cliente;\nCREATE TABLE gold.dim_cliente\n(\nID_CLIENTE VARCHAR(100) COMMENT 'Chave da Dimens\u00e3o Cliente.'\n,CODIGO_CLIENTE INT COMMENT 'C\u00f3digo do Cliente.'\n,NOME_CLIENTE VARCHAR(100) COMMENT 'Nome do Cliente.'\n,DATA_NASCIMENTO DATE COMMENT 'Data de Nascimento do Cliente'\n,IDADE_CLIENTE INT COMMENT 'Idade do Cliente'\n,DESCRICAO_ENDERECO VARCHAR(200) COMMENT 'Endere\u00e7o do Cliente'\n,NUMERO_ENDERECO INT COMMENT 'Numero da Residencia do Cliente'\n,NOME_CIDADE VARCHAR(100) COMMENT 'Cidade de Resid\u00eancia do Cliente'\n,NUMERO_TELEFONE VARCHAR(30) COMMENT 'Telefone do Cliente'\n,EMAIL_CLIENTE VARCHAR(100) COMMENT 'E-mail do Cliente'\n,OCUPACAO_CLIENTE VARCHAR(100) COMMENT 'Ocupa\u00e7\u00e3o do cliente'\n,DATA_CADASTRO TIMESTAMP COMMENT 'Data de Cadastro do Registro.'\n,DATA_ALTERACAO TIMESTAMP COMMENT 'Data de Atualiza\u00e7\u00e3o do Registro.'\n);\n\nDROP  TABLE IF EXISTS gold.dim_loja;\nCREATE TABLE gold.dim_loja\n(\nID_LOJA VARCHAR(100) COMMENT 'Chave da Dimens\u00e3o Loja.'\n,CODIGO_LOJA     INT COMMENT 'C\u00f3digo da Loja.'\n,NOME_LOJA   VARCHAR(100) COMMENT 'Nome da Loja.'\n,NOME_VENDEDOR VARCHAR(100)  COMMENT 'Nome do Vendedor.'\n,LOCALIDADE_LOJA     VARCHAR(100) COMMENT 'Localidade da Loja.'\n,TIPO_LOJA VARCHAR(100) COMMENT 'Tipo da Loja.'\n,DATA_CADASTRO TIMESTAMP COMMENT 'Data de Cadastro do Registro.'\n,DATA_ALTERACAO TIMESTAMP COMMENT 'Data de Atualiza\u00e7\u00e3o do Registro.'\n);\n\nDROP  TABLE IF EXISTS gold.dim_tempo;\nCREATE TABLE gold.dim_tempo\n(\nID_TEMPO VARCHAR(100) COMMENT 'Chave da Dimens\u00e3o Tempo.'\n,DATA VARCHAR(10) COMMENT 'Data.'\n,ANO INT COMMENT 'Ano referente a coluna data.'\n,MES    INT COMMENT 'M\u00eas referente a coluna data.'\n,DIA INT COMMENT 'Dia referente a coluna data.' \n,DATA_CADASTRO TIMESTAMP COMMENT 'Data de Cadastro do Registro.'\n,DATA_ALTERACAO TIMESTAMP COMMENT 'Data de Atualiza\u00e7\u00e3o do Registro.'\n);\n\nDROP  TABLE IF EXISTS gold.fato_venda;\nCREATE TABLE gold.fato_venda\n(\nCODIGO_VENDA INT COMMENT 'C\u00f3digo da Venda.'\n,ID_CLIENTE VARCHAR(100)  COMMENT 'Chave da Dimens\u00e3o Cliente.'\n,ID_LOJA VARCHAR(100) COMMENT 'Chave da Dimens\u00e3o Loja.'\n,ID_PRODUTO VARCHAR(100)  COMMENT 'Chave da Dimens\u00e3o Produto.'\n,ID_FORMA_PAGAMENTO  VARCHAR(100) COMMENT 'Chave da Dimens\u00e3o Forma de Pagamento.'\n,ID_TEMPO VARCHAR(100)  COMMENT 'Chave da Dimens\u00e3o Tempo.'\n,HORA_VENDA INT COMMENT 'Hora em que ocorreu a venda.'\n,QUANTIDADE INT COMMENT 'Quantidade vendida do produto.'\n,VALOR_UNITARIO DECIMAL(18,2)    COMMENT 'Valor unit\u00e1rio do produto.'\n,VALOR_FINAL DECIMAL(18,2)   COMMENT 'Valor vendido de um produto.'\n,TIPO_PAGAMENTO VARCHAR(100) COMMENT 'Tipo de Pagamentto da Venda.'\n,DATA_CADASTRO TIMESTAMP COMMENT 'Data de Cadastro do Registro.'\n,DATA_ALTERACAO TIMESTAMP COMMENT 'Data de Atualiza\u00e7\u00e3o do Registro.'\n);\n</code></pre>"},{"location":"4_configuracao_ambiente_databricks/#seq-48-insercao-dimensao-tempo","title":"SEQ-4.8 - Inser\u00e7\u00e3o Dimens\u00e3o Tempo","text":"<p>Script para inser\u00e7\u00e3o dos dados na Dimens\u00e3o Tempo.</p> Populando a Dimens\u00e3o Tempo<pre><code>data_inicial = date(2023, 6, 1)\ndata_fim = date(2023, 8, 1)\ndias_acrescimo = timedelta(days=1)\n\ncria_dimensao_tempo(data_inicial, data_fim, dias_acrescimo)\n</code></pre>"},{"location":"4_configuracao_ambiente_databricks/#seq-49-listando-as-tabelas-do-schema","title":"SEQ-4.9 - Listando as Tabelas do Schema","text":"<p>Script para visualizar todas as tabelas de um schema qualquer.</p> Listando as Tabelas do Schema<pre><code>%sql\nSHOW TABLES FROM silver\n</code></pre>"},{"location":"4_configuracao_ambiente_databricks/#seq-410-visualizar-estrutura-de-tabela","title":"SEQ-4.10 - Visualizar Estrutura de Tabela","text":"<p>Script para visualizar a estrutura de uma tabela qualquer.</p> Listando a Estrutura de uma tabela<pre><code>%sql\nDESC gold.DIM_LOJA\n</code></pre>"},{"location":"4_configuracao_ambiente_databricks/#seq-411-visualizar-armazenamento-de-uma-tabela","title":"SEQ-4.11 - Visualizar Armazenamento de uma Tabela","text":"<p>Script para visualizar informa\u00e7\u00f5es de armazenamento de uma tabela qualquer.</p> Listando Informa\u00e7\u00f5es da Tabela<pre><code>%sql\nDESC DETAIL gold.DIM_LOJA\n</code></pre>"},{"location":"4_configuracao_ambiente_databricks/#seq-411-visualizar-estrutura-de-schema","title":"SEQ-4.11 - Visualizar Estrutura de Schema","text":"<p>Script para visualizar a estrutura de um schema.</p> Listando a Estrutura do Schema<pre><code>%sql\nDESC SCHEMA bronze\n</code></pre>"},{"location":"5_ingestao_dados_azure/","title":"Projeto BI Zero TO DW","text":""},{"location":"5_ingestao_dados_azure/#5-ingestao-dos-dados-do-azure-sql-databse","title":"5 - Ingest\u00e3o dos Dados do Azure SQL Databse","text":"<p>Pr\u00e9-Requisito para ingest\u00e3o dos dados do Azure SQL Database.</p> Sequ\u00eancia A\u00e7\u00e3o Detalhamento SEQ-2.1 Provisionamento do Azure SQL Provisionamento de um banco de dados no Azure SEQ-2.2 Configura\u00e7\u00e3o do Ambiente Azure Cria\u00e7\u00e3o de toda a estrutura de tabelas e dados <p>Atividades que ser\u00e3o realizadas nessa etapa.</p> Sequ\u00eancia A\u00e7\u00e3o Detalhamento SEQ-01 / SEQ-02 Configura\u00e7\u00e3o de Biblioteca Instala\u00e7\u00e3o da Biblioteca \"sqlalchemy\" SEQ-03 Consumindo Arquivo JSON Arquivo com as credenciais de acesso ao Azure SQL Database SEQ-04 Sela\u00e7\u00e3o das Tabelas Identificar quais ser\u00e3o as tabelas usadas durante o processo de ingest\u00e3o SEQ-05 Extra\u00e7\u00e3o dos Dados do Azure SQL Coleta dos Dados do Azure SQL SEQ-06 Persistir os Dados em Parquet Os dados dever\u00e3o ser persistidos no diret\u00f3rio de cada tabela em formato parquet. <p>O arquivo do Notebook \u00e9 encontrado aqui. Notebook Ingest\u00e3o Dados Azure SQL Database</p>"},{"location":"5_ingestao_dados_azure/#seq-51-configurando-bibliotaca-sqlalchemy","title":"SEQ-5.1 - Configurando Bibliotaca sqlalchemy","text":"<p>A biblioteca \"sqlalchemy\" ser\u00e1 usada para realizar a conex\u00e3o com o Azure SQL Database.</p> Instala\u00e7\u00e3o da Biblioteca<pre><code>pip install sqlalchemy\n</code></pre>"},{"location":"5_ingestao_dados_azure/#seq-52-importando-das-bibliotecas","title":"SEQ-5.2 - Importando das bibliotecas","text":"<p>Sele\u00e7\u00e3o e Importa\u00e7\u00e3o das bibliotecas que ser\u00e3o usadas</p> <p>Validar se existe a necessidade de importar todas as bibliotecas.</p> Bibliotecas usadas<pre><code>from sqlalchemy import __version__ as sa_version, create_engine, text\nimport json\nimport pandas as pd\n</code></pre>"},{"location":"5_ingestao_dados_azure/#seq-53-arquivo-parametro-de-conexao-com-database","title":"SEQ-5.3 - Arquivo Par\u00e2metro de Conex\u00e3o com Database","text":"<p>Importa\u00e7\u00e3o do Arquivo JSON que ser\u00e1 usado para buscar informa\u00e7\u00f5es de conex\u00e3o com o Azure SQL Database</p> <p>Esse arquivo JSON ter\u00e1 a seguinte estrutura.</p> <p></p> <p>O arquivo ser\u00e1 lido e as informa\u00e7\u00f5es de servidor, banco de dados, usu\u00e1rio e senha ser\u00e3o armazenado nas vari\u00e1veis.</p> <p>Esse modo de trabalhar \u00e9 melhor pois voc\u00ea n\u00e3o exp\u00f5em as suas senhas e mant\u00e9m um \u00fanico ponto de altera\u00e7\u00e3o.</p> <p>No Azure voc\u00ea pode armazenar suas credenciais no Azure Key Vault.</p> Buscando informa\u00e7\u00f5es de conex\u00e3o<pre><code>dfjson =  pd.read_json(\"https://raw.githubusercontent.com/dbaassists/Projeto_BI_Zero_TO_DW/main/04_ARQUIVO_CONFIG/config_azure_sql.json\")\n\nserver = dfjson['Config']['server']\ndatabase = dfjson['Config']['database']\nusername = dfjson['Config']['username']\npassword = dfjson['Config']['password']\n</code></pre>"},{"location":"5_ingestao_dados_azure/#seq-54-extracao-dados-azure-sql-database","title":"SEQ-5.4 - Extra\u00e7\u00e3o Dados Azure SQL Database","text":"<p>Identifica\u00e7\u00e3o das Tabelas do Azure SQL Database que ser\u00e3o extra\u00eddas.</p> <p>Obs: Para esse nosso projeto, estaremos importando todas as tabelas do banco.</p> Idenfifica\u00e7\u00e3o das Tabelas do Banco<pre><code>df = spark.read \\\n.format(\"jdbc\") \\\n.option(\"url\", f\"jdbc:sqlserver://{server};database={database}\") \\\n.option(\"query\", \"\"\"SELECT s.name + '.' +  t.NAME AS Nome_Tabela \n                        FROM sys.tables t\n                        INNER JOIN sys.schemas s\n                        ON t.schema_id = s.schema_id\"\"\") \\\n.option(\"user\", f\"{username}\") \\\n.option(\"password\", f\"{password}\") \\\n.load()\n</code></pre> <p>Visualizando o conte\u00fado retornado da execu\u00e7\u00e3o da consulta.</p> Listando dados carregados no Dataframe<pre><code>display(df)\n</code></pre>"},{"location":"5_ingestao_dados_azure/#seq-55-extracao-de-dados","title":"SEQ-5.5 - Extra\u00e7\u00e3o de Dados","text":"<p>Ap\u00f3s a extra\u00e7\u00e3o dos dados do Azure SQL Database, os dados ser\u00e3o persistidos na camada landing zone em formato parquet.</p> <p>Comentando um pouco o script abaixo:</p> <ul> <li>No fluxo abaixo, nosso processamento ir\u00e1 trabalhar em loop uma vez que j\u00e1 identificou os objetos que precisam ser extraidos no passo \"SEQ-5.4\" e agora ir\u00e1 realizar a consulta de todos eles e por \u00faltimo estar\u00e1 salvando os dados no diret\u00f3rio \"dbfs:/FileStore/tables/landing_zone/\" em formato parquet.</li> </ul> Extra\u00e7\u00e3o dos Dados do Azure SQL Database e Salvando na Landing Zone<pre><code>lista_tabelas = df.collect()\n\nfor tabela in lista_tabelas:\n\n    tabela_paquet = tabela['Nome_Tabela'].replace('dbo.','').lower()\n\n    print(tabela_paquet)\n\n    diretorio_parquet = \"dbfs:/FileStore/tables/landing_zone/{0}\".format(tabela_paquet)\n\n    df = (spark.read\n    .format(\"jdbc\")\n    .option(\"url\", f\"jdbc:sqlserver://{server};database={database}\") \\\n    .option(\"query\", \"SELECT * FROM {0}\".format(tabela['Nome_Tabela']))\n    .option(\"user\", f\"{username}\") \\\n    .option(\"password\", f\"{password}\") \\\n    .load()\n    )\n\n    (df.write\n    .format('parquet')\n    .mode(\"overwrite\")\n    .save(diretorio_parquet)\n    )\n</code></pre>"},{"location":"5_ingestao_dados_azure/#seq-56-firewall-azure-sql-database-liberando-acesso-ao-banco","title":"SEQ-5.6 - Firewall Azure SQL Database - Liberando acesso ao Banco","text":"Concedendo acesso ao Azure SQL Database<pre><code>exec sp_set_firewall_rule N'nome_regra', '0.0.0.0', '0.0.0.0'\n</code></pre> <p>Ou podemos fazer a libera\u00e7\u00e3o acessando o portal do Azure.</p> <p></p> <p>Depois realizamos o cadastro da regra.</p> <p></p>"},{"location":"5_ingestao_dados_azure/#seq-57-firewall-azure-sql-database-revogando-acesso-ao-banco","title":"SEQ-5.7 - Firewall Azure SQL Database - Revogando acesso ao Banco","text":"Removendo acesso ao Azure SQL Database<pre><code>exec sp_delete_firewall_rule N'nome_regra'\n</code></pre> <p>Ou podemos fazer a revoga\u00e7\u00e3o acessando o portal do Azure.</p> <p></p> <p>Depois realizamos a entrada referente a regra.</p> <p></p>"},{"location":"6_ingestao_dados_camada_bronze/","title":"Projeto BI Zero TO DW","text":""},{"location":"6_ingestao_dados_camada_bronze/#6-ingestao-dos-dados-na-camada-bronze","title":"6 - Ingest\u00e3o dos Dados na Camada Bronze","text":"Sequ\u00eancia A\u00e7\u00e3o Detalhamento SEQ-6.1 / SEQ-6.2 Ingest\u00e3o dos Dados Identificar no storage \"dbfs:/FileStore/tables/landing_zone\" os dados a serem inseridos na camada BRONZE. <p>O arquivo do Notebook \u00e9 encontrado aqui. Notebook Ingest\u00e3o Dados Para Camada Bronze</p>"},{"location":"6_ingestao_dados_camada_bronze/#seq-61-origem-dos-dados-no-databricks","title":"SEQ-6.1 - Origem dos Dados no Databricks","text":"<p>Nessa etapa definimos onde os nossos dados foram armazenados na etapa de extra\u00e7\u00e3o de dados do Azure SQL Database.</p> Carregando Vari\u00e1vel<pre><code>diretorio_landing_zone = \"dbfs:/FileStore/tables/landing_zone/\"\narquivos_diretorio = dbutils.fs.ls(diretorio_landing_zone)\n</code></pre>"},{"location":"6_ingestao_dados_camada_bronze/#seq-62-carga-dados-camada-bronze","title":"SEQ-6.2 - Carga Dados Camada Bronze","text":"<p>Rotina de leitura dos arquivos e carga na camada bronze.</p> Extra\u00e7\u00e3o Dos Dados do Azure SQL Database<pre><code>for arquivo in arquivos_diretorio:\n\n    diretorio = arquivo.path\n    tabela = arquivo.name.replace('/','').lower()\n\n    parDF1=spark.read.parquet(diretorio)\n\n    colunas = parDF1.columns\n    lista1 = ''\n    listaInsert = ''\n    listaCondicao = ''\n\n    for coluna in colunas:\n        if lista1 == '':\n            lista1 = coluna\n        else:\n            lista1 = lista1 + ',' + coluna\n\n    for coluna in colunas:\n        if listaInsert == '':\n            listaInsert = 'b.'+coluna\n        else:\n            listaInsert = listaInsert + ',' + 'b.'+ coluna\n\n    for coluna in colunas:\n        if listaCondicao == '':\n            listaCondicao =  'a.'+coluna + '= b.'+coluna\n\n    if tabela == 'tb_item_venda':\n        listaCondicao = listaCondicao + ' AND a.CODIGO_PRODUTO = b.CODIGO_PRODUTO'\n\n\n    tabela_dl = tabela.replace('dbo.','')\n\n    parDF1.createOrReplaceTempView(tabela)\n\n    comando_truncate = f\"\"\"TRUNCATE TABLE bronze.{tabela}\"\"\"\n\n    print(comando_truncate)\n\n    spark.sql(comando_truncate)\n\n    comando_insert = f\"\"\"MERGE INTO bronze.{tabela} a\n            USING {tabela} b\n            ON {listaCondicao}\n            WHEN NOT MATCHED\n            THEN INSERT ({lista1}) VALUES ({listaInsert})\n            \"\"\"\n\n    print(comando_insert)\n\n    spark.sql(comando_insert)\n</code></pre>"},{"location":"7_ingestao_dados_camada_silver/","title":"Projeto BI Zero TO DW","text":""},{"location":"7_ingestao_dados_camada_silver/#7-ingestao-dos-dados-na-camada-silver","title":"7 - Ingest\u00e3o dos Dados na Camada Silver","text":"Sequ\u00eancia A\u00e7\u00e3o Detalhamento SEQ-7.1 Fun\u00e7\u00e3o acentuacao Usada para remover a acentua\u00e7\u00e3o de campos do tipo STRING. SEQ-7.2 / SEQ-7.3 / SEQ-7.4 / SEQ-7.5 / SEQ-7.6 / SEQ-7.7 / SEQ-7.8 / SEQ-7.9 Ingest\u00e3o dos Dados da Camada Bronze para Silver Carga realizada baseada nos dados existentes nas tabelas da camada Bronze. SEQ-7.2 / SEQ-7.3 / SEQ-7.4 / SEQ-7.5 / SEQ-7.6 / SEQ-7.7 / SEQ-7.8 / SEQ-7.9 Tratamento de dados antes de inserir/atualizar Remover acentua\u00e7\u00e3o e caracteres especiais, valores nulos onde o datatype foi STRING, informar 'N/A', datatype NUM\u00c9RICO, informar 0 (zero) e datatype DATE/TIMESTAMP, informar '1900-01-01'. Todo os dados do tipo STRING devem estar dados em caixa alta. SEQ-7.2 / SEQ-7.3 / SEQ-7.4 / SEQ-7.5 / SEQ-7.6 / SEQ-7.7 / SEQ-7.8 / SEQ-7.9 Identificar a data de altera\u00e7\u00e3o ou cadastro Regra: Caso o registro n\u00e3o exista (caindo na condi\u00e7\u00e3o INSERT do MERGE), a data de cadastro e data de altera\u00e7\u00e3o devem ser a mesma, caso o registro exista, a data de altera\u00e7\u00e3o dever\u00e1 ser alterada. <p>O arquivo do Notebook \u00e9 encontrado aqui. Notebook Ingest\u00e3o Dados Para Camada Silver</p>"},{"location":"7_ingestao_dados_camada_silver/#seq-71-notebook-externo","title":"SEQ-7.1 - Notebook Externo","text":"<p>Nessa etapa \u00e9 realizada a importa\u00e7\u00e3o de um notebook externo que cont\u00e9m a fun\u00e7\u00e3o que ser\u00e1 usada para realizar o tratamento (remo\u00e7\u00e3o da acentua\u00e7\u00e3o) dos dados.</p> Notebook Externo<pre><code>%run /estudos/libs/bibliotecas\n</code></pre>"},{"location":"7_ingestao_dados_camada_silver/#atividades-de-ingestao","title":"Atividades de Ingest\u00e3o","text":""},{"location":"7_ingestao_dados_camada_silver/#seq-72-ingestao-de-dados-na-camada-silver-de-tb_categoria_produto","title":"SEQ-7.2 - Ingest\u00e3o de Dados na camada \"silver\" de tb_categoria_produto","text":"Carga Silver tb_categoria_produto<pre><code>%sql\nMERGE INTO silver.tb_categoria_produto a\nUSING (\nSELECT \nCODIGO_CATEGORIA\n,IFNULL(TRIM(acentuacao(CATEGORIA_PRODUTO)),'N/A') CATEGORIA_PRODUTO\n,IFNULL(TRIM(acentuacao(SUB_CATEGORIA_PRODUTO)),'N/A') SUB_CATEGORIA_PRODUTO\nFROM bronze.tb_categoria_produto\n) b\n\nON a.CODIGO_CATEGORIA= b.CODIGO_CATEGORIA\n\nWHEN MATCHED THEN\nUPDATE SET \na.CATEGORIA_PRODUTO = b.CATEGORIA_PRODUTO\n,a.SUB_CATEGORIA_PRODUTO = b.SUB_CATEGORIA_PRODUTO\n,a.DATA_ALTERACAO = from_utc_timestamp(now(),'GMT-3')\n\nWHEN NOT MATCHED\nTHEN \nINSERT \n(\nCODIGO_CATEGORIA\n,CATEGORIA_PRODUTO\n,SUB_CATEGORIA_PRODUTO\n,DATA_CADASTRO\n,DATA_ALTERACAO\n) \nVALUES \n(\nb.CODIGO_CATEGORIA\n,b.CATEGORIA_PRODUTO\n,b.SUB_CATEGORIA_PRODUTO\n,from_utc_timestamp(now(),'GMT-3')\n,from_utc_timestamp(now(),'GMT-3')\n)\n</code></pre>"},{"location":"7_ingestao_dados_camada_silver/#seq-73-ingestao-de-dados-na-camada-silver-de-tb_cliente","title":"SEQ-7.3 - Ingest\u00e3o de Dados na camada \"silver\" de tb_cliente","text":"Carga Silver tb_cliente<pre><code>%sql\nMERGE INTO silver.tb_cliente a\nUSING (\nSELECT \nCODIGO_CLIENTE\n,DATA_NASCIMENTO\n,IDADE_CLIENTE\n,DESCRICAO_ENDERECO\n,NUMERO_ENDERECO\n,NOME_CIDADE\n,NUMERO_TELEFONE\n,EMAIL_CLIENTE\n,OCUPACAO_CLIENTE\n,IFNULL(TRIM(acentuacao(NOME_CLIENTE)),'N/A') NOME_CLIENTE\nFROM bronze.tb_cliente\n) b\n\nON a.CODIGO_CLIENTE= b.CODIGO_CLIENTE\n\nWHEN MATCHED THEN\nUPDATE SET \na.NOME_CLIENTE = b.NOME_CLIENTE\n,a.DATA_NASCIMENTO = b.DATA_NASCIMENTO\n,a.IDADE_CLIENTE = b.IDADE_CLIENTE\n,a.DESCRICAO_ENDERECO = b.DESCRICAO_ENDERECO\n,a.NUMERO_ENDERECO = b.NUMERO_ENDERECO\n,a.NOME_CIDADE = b.NOME_CIDADE\n,a.NUMERO_TELEFONE = b.NUMERO_TELEFONE\n,a.EMAIL_CLIENTE = b.EMAIL_CLIENTE\n,a.OCUPACAO_CLIENTE = b.OCUPACAO_CLIENTE\n,a.DATA_ALTERACAO = from_utc_timestamp(now(),'GMT-3')\n\nWHEN NOT MATCHED\nTHEN \nINSERT \n(\nCODIGO_CLIENTE\n,NOME_CLIENTE\n,DATA_NASCIMENTO\n,IDADE_CLIENTE\n,DESCRICAO_ENDERECO\n,NUMERO_ENDERECO\n,NOME_CIDADE\n,NUMERO_TELEFONE\n,EMAIL_CLIENTE\n,OCUPACAO_CLIENTE\n,DATA_CADASTRO\n,DATA_ALTERACAO\n)\nVALUES \n(\nb.CODIGO_CLIENTE\n,b.NOME_CLIENTE\n,b.DATA_NASCIMENTO\n,b.IDADE_CLIENTE\n,b.DESCRICAO_ENDERECO\n,b.NUMERO_ENDERECO\n,b.NOME_CIDADE\n,b.NUMERO_TELEFONE\n,b.EMAIL_CLIENTE\n,b.OCUPACAO_CLIENTE\n,from_utc_timestamp(now(),'GMT-3')\n,from_utc_timestamp(now(),'GMT-3')\n)\n</code></pre>"},{"location":"7_ingestao_dados_camada_silver/#seq-74-ingestao-de-dados-na-camada-silver-de-tb_forma_pagamento","title":"SEQ-7.4 - Ingest\u00e3o de Dados na camada \"silver\" de tb_forma_pagamento","text":"Carga Silver tb_forma_pagamento<pre><code>%sql\nMERGE INTO silver.tb_forma_pagamento a\nUSING (\nSELECT \nCODIGO_FORMA_PAGAMENTO\n,IFNULL(TRIM(acentuacao(DESCRICAO_FORMA_PAGAMENTO)),'N/A') DESCRICAO_FORMA_PAGAMENTO\nFROM bronze.tb_forma_pagamento\n) b\n\nON a.CODIGO_FORMA_PAGAMENTO= b.CODIGO_FORMA_PAGAMENTO\n\nWHEN MATCHED THEN\nUPDATE SET \na.DESCRICAO_FORMA_PAGAMENTO = b.DESCRICAO_FORMA_PAGAMENTO\n,a.DATA_ALTERACAO = from_utc_timestamp(now(),'GMT-3')\n\nWHEN NOT MATCHED\nTHEN \nINSERT \n(CODIGO_FORMA_PAGAMENTO\n,DESCRICAO_FORMA_PAGAMENTO\n,DATA_CADASTRO\n,DATA_ALTERACAO) \nVALUES \n(b.CODIGO_FORMA_PAGAMENTO\n,b.DESCRICAO_FORMA_PAGAMENTO\n,from_utc_timestamp(now(),'GMT-3')\n,from_utc_timestamp(now(),'GMT-3')\n)\n</code></pre>"},{"location":"7_ingestao_dados_camada_silver/#seq-75-ingestao-de-dados-na-camada-silver-de-tb_item_venda","title":"SEQ-7.5 - Ingest\u00e3o de Dados na camada \"silver\" de tb_item_venda","text":"Carga Silver tb_item_venda<pre><code>%sql\nMERGE INTO silver.tb_item_venda a\nUSING (\nSELECT \nCODIGO_VENDA\n,CODIGO_PRODUTO\n,VALOR_UNITARIO\n,QUANTIDADE\n,VALOR_FINAL\nFROM bronze.tb_item_venda\n) b\n\nON a.CODIGO_VENDA= b.CODIGO_VENDA\nAND a.CODIGO_PRODUTO= b.CODIGO_PRODUTO\n\nWHEN MATCHED THEN\nUPDATE SET \na.VALOR_UNITARIO = b.VALOR_UNITARIO\n,a.QUANTIDADE = b.QUANTIDADE\n,a.VALOR_FINAL = b.VALOR_FINAL\n,a.DATA_ALTERACAO = from_utc_timestamp(now(),'GMT-3')\n\nWHEN NOT MATCHED\nTHEN \nINSERT \n(\nCODIGO_VENDA\n,CODIGO_PRODUTO\n,VALOR_UNITARIO\n,QUANTIDADE\n,VALOR_FINAL\n,DATA_CADASTRO\n,DATA_ALTERACAO\n)\nVALUES \n(\nb.CODIGO_VENDA\n,b.CODIGO_PRODUTO\n,b.VALOR_UNITARIO\n,b.QUANTIDADE\n,b.VALOR_FINAL\n,from_utc_timestamp(now(),'GMT-3')\n,from_utc_timestamp(now(),'GMT-3')\n)\n</code></pre>"},{"location":"7_ingestao_dados_camada_silver/#seq-76-ingestao-de-dados-na-camada-silver-de-tb_loja","title":"SEQ-7.6 - Ingest\u00e3o de Dados na camada \"silver\" de tb_loja","text":"Carga Silver tb_loja<pre><code>%sql\nMERGE INTO silver.tb_loja a\nUSING (\nSELECT \nCODIGO_LOJA_VENDEDOR\n,CODIGO_LOJA\n,CODIGO_VENDEDOR\n,IFNULL(TRIM(acentuacao(NOME_LOJA)),'N/A') NOME_LOJA\n,IFNULL(TRIM(acentuacao(LOCALIDADE_LOJA)),'N/A') LOCALIDADE_LOJA\n,IFNULL(TRIM(TIPO_LOJA),'N/A') TIPO_LOJA\nFROM bronze.tb_loja\n) b\n\nON a.CODIGO_LOJA_VENDEDOR= b.CODIGO_LOJA_VENDEDOR\n\nWHEN MATCHED THEN\nUPDATE SET \na.CODIGO_LOJA = b.CODIGO_LOJA\n,a.CODIGO_VENDEDOR = b.CODIGO_VENDEDOR\n,a.NOME_LOJA = b.NOME_LOJA\n,a.LOCALIDADE_LOJA = b.LOCALIDADE_LOJA\n,a.TIPO_LOJA = b.TIPO_LOJA\n,a.DATA_ALTERACAO = from_utc_timestamp(now(),'GMT-3')\n\nWHEN NOT MATCHED\nTHEN \nINSERT (\nCODIGO_LOJA_VENDEDOR\n,CODIGO_LOJA\n,CODIGO_VENDEDOR\n,NOME_LOJA\n,LOCALIDADE_LOJA\n,TIPO_LOJA\n,DATA_CADASTRO\n,DATA_ALTERACAO\n) \nVALUES \n(\nb.CODIGO_LOJA_VENDEDOR  \n,b.CODIGO_LOJA\n,b.CODIGO_VENDEDOR\n,b.NOME_LOJA\n,b.LOCALIDADE_LOJA\n,b.TIPO_LOJA\n,from_utc_timestamp(now(),'GMT-3')\n,from_utc_timestamp(now(),'GMT-3')\n)\n</code></pre>"},{"location":"7_ingestao_dados_camada_silver/#seq-77-ingestao-de-dados-na-camada-silver-de-tb_produto","title":"SEQ-7.7 - Ingest\u00e3o de Dados na camada \"silver\" de tb_produto","text":"Carga Silver tb_produto<pre><code>%sql\n\nMERGE INTO silver.tb_produto a\nUSING (SELECT \nPROD.CODIGO_PRODUTO\n,IFNULL(TRIM(acentuacao(PROD.DESCRICAO_PRODUTO)),'N/A') DESCRICAO_PRODUTO\n,IFNULL(TRIM(PROD.CODIGO_CATEGORIA),'N/A') CODIGO_CATEGORIA\nFROM bronze.tb_produto PROD) b\n\nON a.CODIGO_PRODUTO= b.CODIGO_PRODUTO\n\nWHEN MATCHED \nTHEN\nUPDATE SET \na.DESCRICAO_PRODUTO = b.DESCRICAO_PRODUTO\n,a.CODIGO_CATEGORIA = b.CODIGO_CATEGORIA\n,a.DATA_ALTERACAO = from_utc_timestamp(now(),'GMT-3')\n\nWHEN NOT MATCHED\nTHEN \nINSERT \n(\nCODIGO_PRODUTO\n,DESCRICAO_PRODUTO\n,CODIGO_CATEGORIA\n,DATA_CADASTRO\n,DATA_ALTERACAO\n) \nVALUES \n(\nb.CODIGO_PRODUTO\n,b.DESCRICAO_PRODUTO\n,b.CODIGO_CATEGORIA\n,from_utc_timestamp(now(),'GMT-3')\n,from_utc_timestamp(now(),'GMT-3')\n)\n</code></pre>"},{"location":"7_ingestao_dados_camada_silver/#seq-78-ingestao-de-dados-na-camada-silver-de-tb_venda","title":"SEQ-7.8 - Ingest\u00e3o de Dados na camada \"silver\" de tb_venda","text":"Carga Silver tb_venda<pre><code>%sql\n\nMERGE INTO silver.tb_venda a\nUSING (\nSELECT \nCODIGO_VENDA\n,DATA_VENDA\n,CODIGO_CLIENTE\n,CODIGO_LOJA_VENDEDOR\n,VALOR_FINAL\n,IFNULL(TRIM(CODIGO_FORMA_PAGAMENTO),'N/A') CODIGO_FORMA_PAGAMENTO\n,IFNULL(TRIM(TIPO_PAGAMENTO),'N/A') TIPO_PAGAMENTO\nFROM bronze.tb_venda\n) b\n\nON a.CODIGO_VENDA= b.CODIGO_VENDA\n\nWHEN MATCHED THEN\nUPDATE SET \na.DATA_VENDA = b.DATA_VENDA\n,a.CODIGO_CLIENTE = b.CODIGO_CLIENTE\n,a.CODIGO_LOJA_VENDEDOR = b.CODIGO_LOJA_VENDEDOR\n,a.VALOR_FINAL = b.VALOR_FINAL\n,a.CODIGO_FORMA_PAGAMENTO = b.CODIGO_FORMA_PAGAMENTO\n,a.TIPO_PAGAMENTO = b.TIPO_PAGAMENTO\n,a.DATA_ALTERACAO = from_utc_timestamp(now(),'GMT-3')\n\nWHEN NOT MATCHED\nTHEN \nINSERT \n(\nCODIGO_VENDA\n,DATA_VENDA\n,CODIGO_CLIENTE\n,CODIGO_LOJA_VENDEDOR\n,VALOR_FINAL\n,CODIGO_FORMA_PAGAMENTO\n,TIPO_PAGAMENTO\n,DATA_CADASTRO\n,DATA_ALTERACAO\n)\nVALUES (\nb.CODIGO_VENDA\n,b.DATA_VENDA\n,b.CODIGO_CLIENTE\n,b.CODIGO_LOJA_VENDEDOR\n,b.VALOR_FINAL\n,b.CODIGO_FORMA_PAGAMENTO\n,b.TIPO_PAGAMENTO\n,from_utc_timestamp(now(),'GMT-3')\n,from_utc_timestamp(now(),'GMT-3')\n)\n</code></pre>"},{"location":"7_ingestao_dados_camada_silver/#seq-79-ingestao-de-dados-na-camada-silver-de-tb_vendedor","title":"SEQ-7.9 - Ingest\u00e3o de Dados na camada \"silver\" de tb_vendedor","text":"Carga Silver tb_vendedor<pre><code>%sql\n\nMERGE INTO silver.tb_vendedor a\nUSING (\nSELECT \nCODIGO_VENDEDOR\n,IFNULL(TRIM(acentuacao(NOME_VENDEDOR)),'N/A') NOME_VENDEDOR\nFROM bronze.tb_vendedor\n) b\n\nON a.CODIGO_VENDEDOR= b.CODIGO_VENDEDOR\n\nWHEN MATCHED THEN\nUPDATE SET \na.NOME_VENDEDOR = b.NOME_VENDEDOR\n,a.DATA_ALTERACAO = from_utc_timestamp(now(),'GMT-3')\n\nWHEN NOT MATCHED\nTHEN \nINSERT \n(\nCODIGO_VENDEDOR\n,NOME_VENDEDOR\n,DATA_CADASTRO\n,DATA_ALTERACAO\n) \nVALUES \n(\nb.CODIGO_VENDEDOR\n,b.NOME_VENDEDOR\n,from_utc_timestamp(now(),'GMT-3')\n,from_utc_timestamp(now(),'GMT-3')\n)\n</code></pre>"},{"location":"8_ingestao_dados_camada_gold/","title":"Projeto BI Zero TO DW","text":""},{"location":"8_ingestao_dados_camada_gold/#8-ingestao-dos-dados-na-camada-gold","title":"8 - Ingest\u00e3o dos Dados na Camada Gold","text":"Sequ\u00eancia A\u00e7\u00e3o Detalhamento SEQ-8.1 / SEQ-8.2 / SEQ-8.3 / SEQ-8.4 / SEQ-8.5 / SEQ-8.6 Ingest\u00e3o dos Dados da Camada Silver para Gold Carga realizada baseada nos dados existentes nas tabelas da camada Silver. SEQ-8.1 / SEQ-8.2 / SEQ-8.3 / SEQ-8.4 / SEQ-8.5 / SEQ-8.6 Identificar a data de altera\u00e7\u00e3o ou cadastro Regra: Caso o registro n\u00e3o exista (caindo na condi\u00e7\u00e3o INSERT do MERGE), a data de cadastro e data de altera\u00e7\u00e3o devem ser a mesma, caso o registro exista, a data de altera\u00e7\u00e3o dever\u00e1 ser alterada. SEQ-8.1 / SEQ-8.2 / SEQ-8.3 / SEQ-8.4 / SEQ-8.5 / SEQ-8.6 Cria\u00e7\u00e3o da PK usando o Algoritmo HASH(256) Regra: Usar a PK da tabela na camada Silver e encriptar usando HASH(256). SEQ-8.1 / SEQ-8.2 / SEQ-8.3 / SEQ-8.4 / SEQ-8.5 / SEQ-8.6 SCD Tipos N\u00e3o estaremos aplicando nenhuma forma de versionamento dos dados na camada dimensional. <p>O arquivo do Notebook \u00e9 encontrado aqui. Notebook Ingest\u00e3o Dados Para Camada Gold</p>"},{"location":"8_ingestao_dados_camada_gold/#seq-81-carga-tabela-camada-gold-dim_cliente","title":"SEQ-8.1 - Carga Tabela Camada Gold - dim_cliente","text":"Carga Gold gold.dim_cliente<pre><code>%sql\nMERGE INTO gold.DIM_CLIENTE a\nUSING (\nSELECT \nhash(CODIGO_CLIENTE, 256) ID_CLIENTE\n,CODIGO_CLIENTE\n,acentuacao(NOME_CLIENTE) NOME_CLIENTE\n,DATA_NASCIMENTO\n,IDADE_CLIENTE\n,acentuacao(DESCRICAO_ENDERECO) DESCRICAO_ENDERECO\n,NUMERO_ENDERECO\n,acentuacao(NOME_CIDADE) NOME_CIDADE\n,NUMERO_TELEFONE\n,EMAIL_CLIENTE\n,acentuacao(OCUPACAO_CLIENTE) OCUPACAO_CLIENTE\nFROM silver.tb_cliente\n) b\n\nON a.ID_CLIENTE= b.ID_CLIENTE\n\nWHEN MATCHED THEN\nUPDATE SET \na.CODIGO_CLIENTE = b.CODIGO_CLIENTE\n,a.NOME_CLIENTE = b.NOME_CLIENTE\n,a.DATA_NASCIMENTO = b.DATA_NASCIMENTO\n,a.IDADE_CLIENTE = b.IDADE_CLIENTE\n,a.DESCRICAO_ENDERECO = b.DESCRICAO_ENDERECO\n,a.NUMERO_ENDERECO = b.NUMERO_ENDERECO\n,a.NOME_CIDADE = b.NOME_CIDADE\n,a.NUMERO_TELEFONE = b.NUMERO_TELEFONE\n,a.EMAIL_CLIENTE = b.EMAIL_CLIENTE\n,a.OCUPACAO_CLIENTE = b.OCUPACAO_CLIENTE\n,a.DATA_ALTERACAO = from_utc_timestamp(now(),'GMT-3')\n\nWHEN NOT MATCHED\nTHEN \nINSERT \n(\nID_CLIENTE\n,CODIGO_CLIENTE\n,NOME_CLIENTE\n,DATA_NASCIMENTO\n,IDADE_CLIENTE\n,DESCRICAO_ENDERECO\n,NUMERO_ENDERECO\n,NOME_CIDADE\n,NUMERO_TELEFONE\n,EMAIL_CLIENTE\n,OCUPACAO_CLIENTE\n,DATA_CADASTRO\n,DATA_ALTERACAO\n)\nVALUES \n(\nb.ID_CLIENTE\n,b.CODIGO_CLIENTE\n,b.NOME_CLIENTE\n,b.DATA_NASCIMENTO\n,b.IDADE_CLIENTE\n,b.DESCRICAO_ENDERECO\n,b.NUMERO_ENDERECO\n,b.NOME_CIDADE\n,b.NUMERO_TELEFONE\n,b.EMAIL_CLIENTE\n,b.OCUPACAO_CLIENTE\n,from_utc_timestamp(now(),'GMT-3')\n,from_utc_timestamp(now(),'GMT-3')\n)\n</code></pre>"},{"location":"8_ingestao_dados_camada_gold/#seq-82-carga-tabela-camada-gold-dim_forma_pagamento","title":"SEQ-8.2 - Carga Tabela Camada Gold - dim_forma_pagamento","text":"Carga Gold gold.dim_forma_pagamento<pre><code>%sql\nMERGE INTO gold.DIM_FORMA_PAGAMENTO a\nUSING (\nSELECT \nhash(CODIGO_FORMA_PAGAMENTO, 256) ID_FORMA_PAGAMENTO\n,CODIGO_FORMA_PAGAMENTO\n,acentuacao(DESCRICAO_FORMA_PAGAMENTO) DESCRICAO_FORMA_PAGAMENTO\nFROM silver.tb_forma_pagamento\n) b\n\nON a.ID_FORMA_PAGAMENTO= b.ID_FORMA_PAGAMENTO\n\nWHEN MATCHED THEN\nUPDATE SET \na.CODIGO_FORMA_PAGAMENTO = b.CODIGO_FORMA_PAGAMENTO\n,a.DESCRICAO_FORMA_PAGAMENTO = b.DESCRICAO_FORMA_PAGAMENTO\n,a.DATA_ALTERACAO = from_utc_timestamp(now(),'GMT-3')\n\nWHEN NOT MATCHED\nTHEN \nINSERT \n(\nID_FORMA_PAGAMENTO  \n,CODIGO_FORMA_PAGAMENTO\n,DESCRICAO_FORMA_PAGAMENTO\n,DATA_CADASTRO\n,DATA_ALTERACAO) \nVALUES \n(\nb.ID_FORMA_PAGAMENTO\n,b.CODIGO_FORMA_PAGAMENTO\n,b.DESCRICAO_FORMA_PAGAMENTO\n,from_utc_timestamp(now(),'GMT-3')\n,from_utc_timestamp(now(),'GMT-3')\n)\n</code></pre>"},{"location":"8_ingestao_dados_camada_gold/#seq-83-carga-tabela-camada-gold-dim_loja","title":"SEQ-8.3 - Carga Tabela Camada Gold - dim_loja","text":"Carga Gold gold.dim_loja<pre><code>%sql\nMERGE INTO gold.DIM_LOJA a\nUSING (\nSELECT \nhash(LOJA.CODIGO_LOJA_VENDEDOR, 256) ID_LOJA\n,LOJA.CODIGO_LOJA\n,acentuacao(LOJA.NOME_LOJA) NOME_LOJA\n,acentuacao(VENDEDOR.NOME_VENDEDOR) NOME_VENDEDOR\n,acentuacao(LOJA.LOCALIDADE_LOJA) LOCALIDADE_LOJA\n,LOJA.TIPO_LOJA\nFROM silver.tb_loja LOJA\n\nINNER JOIN silver.tb_vendedor VENDEDOR\n\nON LOJA.CODIGO_VENDEDOR = VENDEDOR.CODIGO_VENDEDOR\n\n\n) b\n\nON a.ID_LOJA= b.ID_LOJA\n\nWHEN MATCHED THEN\nUPDATE SET \na.CODIGO_LOJA = b.CODIGO_LOJA\n,a.NOME_LOJA = b.NOME_LOJA\n,a.NOME_VENDEDOR  = b.NOME_VENDEDOR\n,a.LOCALIDADE_LOJA = b.LOCALIDADE_LOJA\n,a.TIPO_LOJA = b.TIPO_LOJA\n,a.DATA_ALTERACAO = from_utc_timestamp(now(),'GMT-3')\n\nWHEN NOT MATCHED\nTHEN \nINSERT (\nID_LOJA\n,CODIGO_LOJA\n,NOME_LOJA\n,NOME_VENDEDOR\n,LOCALIDADE_LOJA\n,TIPO_LOJA\n,DATA_CADASTRO\n,DATA_ALTERACAO\n) \nVALUES \n(\nb.ID_LOJA\n,b.CODIGO_LOJA\n,b.NOME_LOJA\n,b.NOME_VENDEDOR\n,b.LOCALIDADE_LOJA\n,b.TIPO_LOJA\n,from_utc_timestamp(now(),'GMT-3')\n,from_utc_timestamp(now(),'GMT-3')\n)\n</code></pre>"},{"location":"8_ingestao_dados_camada_gold/#seq-84-carga-tabela-camada-gold-dim_produto","title":"SEQ-8.4 - Carga Tabela Camada Gold - dim_produto","text":"Carga Gold gold.dim_produto<pre><code>%sql\n\nMERGE INTO gold.DIM_PRODUTO a\nUSING (SELECT \nhash(PROD.CODIGO_PRODUTO, 256) ID_PRODUTO\n,PROD.CODIGO_PRODUTO\n,PROD.DESCRICAO_PRODUTO\n,CAT_PROD.CATEGORIA_PRODUTO\n,CAT_PROD.SUB_CATEGORIA_PRODUTO\n\nFROM silver.tb_produto PROD \n\nINNER JOIN silver.tb_categoria_produto CAT_PROD\n\nON PROD.CODIGO_CATEGORIA = CAT_PROD.CODIGO_CATEGORIA\n) b\n\nON a.ID_PRODUTO= b.ID_PRODUTO\n\nWHEN MATCHED \nTHEN\nUPDATE SET \na.CODIGO_PRODUTO = b.CODIGO_PRODUTO\n,a.DESCRICAO_PRODUTO = b.DESCRICAO_PRODUTO\n,a.CATEGORIA_PRODUTO = b.CATEGORIA_PRODUTO\n,a.SUB_CATEGORIA_PRODUTO = b.SUB_CATEGORIA_PRODUTO\n,a.DATA_ALTERACAO = from_utc_timestamp(now(),'GMT-3')\n\nWHEN NOT MATCHED\nTHEN \nINSERT \n(\nID_PRODUTO\n,CODIGO_PRODUTO\n,DESCRICAO_PRODUTO\n,CATEGORIA_PRODUTO\n,SUB_CATEGORIA_PRODUTO\n,DATA_CADASTRO\n,DATA_ALTERACAO\n) \nVALUES \n(\nb.ID_PRODUTO\n,b.CODIGO_PRODUTO\n,b.DESCRICAO_PRODUTO\n,b.CATEGORIA_PRODUTO\n,b.SUB_CATEGORIA_PRODUTO\n,from_utc_timestamp(now(),'GMT-3')\n,from_utc_timestamp(now(),'GMT-3')\n)\n</code></pre>"},{"location":"8_ingestao_dados_camada_gold/#seq-85-carga-tabela-camada-gold-dim_tempo","title":"SEQ-8.5 - Carga Tabela Camada Gold - dim_tempo","text":"<p>A dimens\u00e3o tempo \u00e9 carregado no notebook \"00_configuracao_ambiente\" etapa \"SEQ-08 - Insert Tabela GOLD - DIM_TEMPO\".</p> Carga Gold gold.dim_tempo<pre><code>%sql\ndiretorio = 'dbfs:/FileStore/tables/landing_zone/tempo/'\ntabela = 'tempo'\n\nparDF1=spark.read.parquet(diretorio)\n\nparDF1.createOrReplaceTempView('tmp_dim_tempo')\n\ncolunas = parDF1.columns\nlista1 = ''\nlistaInsert = ''\nlistaCondicao = ''\n\nfor coluna in colunas:\n    if lista1 == '':\n        lista1 = coluna\n    else:\n        lista1 = lista1 + ',' + coluna\n\nfor coluna in colunas:\n    if listaInsert == '':\n        listaInsert = 'b.'+coluna\n    else:\n        listaInsert = listaInsert + ',' + 'b.'+ coluna\n\nfor coluna in colunas:\n    if listaCondicao == '':\n        listaCondicao =  'a.'+coluna + '= b.'+coluna\n\ntabela_dl = tabela.replace('dbo.','')\n\ncomando_truncate = f\"\"\"TRUNCATE TABLE gold.dim_tempo\"\"\"\n\nprint(comando_truncate)\n\nspark.sql(comando_truncate)\n\ncomando_insert = f\"\"\"MERGE INTO gold.dim_tempo a\n        USING tmp_dim_tempo b\n        ON a.ID_TEMPO= b.ID_TEMPO\n        WHEN NOT MATCHED\n        THEN INSERT (ID_TEMPO\n                    ,DATA\n                    ,ANO\n                    ,MES\n                    ,DIA\n                    ,DATA_CADASTRO\n                    ,DATA_ALTERACAO) \n                    VALUES (\n                        hash(b.ID_TEMPO, 256)\n                        ,b.DATA\n                        ,b.ANO\n                        ,b.MES\n                        ,b.DIA\n                        ,b.DATA_CADASTRO\n                        ,b.DATA_ALTERACAO)\n        \"\"\"\n\nprint(comando_insert)\n\nspark.sql(comando_insert)\n</code></pre>"},{"location":"8_ingestao_dados_camada_gold/#seq-86-carga-tabela-camada-gold-fato_venda","title":"SEQ-8.6 - Carga Tabela Camada Gold - fato_venda","text":"Carga Gold gold.fato_venda<pre><code>%sql\n\nMERGE INTO gold.fato_venda a\nUSING (\nSELECT  \n\nVENDA.CODIGO_VENDA\n,DCLIENTE.ID_CLIENTE\n,DLOJA.ID_LOJA\n,DPRODUTO.ID_PRODUTO\n,DFORMAPAGAMENTO.ID_FORMA_PAGAMENTO\n,DTEMPO.ID_TEMPO\n,HOUR(VENDA.DATA_VENDA) HORA_VENDA\n,IVENDA.QUANTIDADE\n,IVENDA.VALOR_UNITARIO\n,(IVENDA.QUANTIDADE * IVENDA.VALOR_UNITARIO) VALOR_FINAL\n,VENDA.TIPO_PAGAMENTO\n\nFROM silver.tb_venda VENDA\n\nINNER JOIN silver.tb_item_venda IVENDA\n\nON VENDA.CODIGO_VENDA = IVENDA.CODIGO_VENDA\n\nINNER JOIN silver.tb_loja LOJA\n\nON VENDA.CODIGO_LOJA_VENDEDOR = LOJA.CODIGO_LOJA_VENDEDOR\n\nINNER JOIN silver.tb_vendedor VENDEDOR\n\nON LOJA.CODIGO_VENDEDOR = VENDEDOR.CODIGO_VENDEDOR\n\nINNER JOIN gold.dim_tempo DTEMPO\n\nON REPLACE(TO_DATE(VENDA.DATA_VENDA) ,'-','') = DTEMPO.DATA\n\nINNER JOIN gold.dim_cliente DCLIENTE\n\nON VENDA.CODIGO_CLIENTE = DCLIENTE.CODIGO_CLIENTE\n\nINNER JOIN gold.dim_loja DLOJA\n\nON LOJA.CODIGO_LOJA = DLOJA.CODIGO_LOJA\n\nAND VENDEDOR.NOME_VENDEDOR = DLOJA.NOME_VENDEDOR\n\nINNER JOIN gold.dim_produto DPRODUTO\n\nON IVENDA.CODIGO_PRODUTO = DPRODUTO.CODIGO_PRODUTO\n\nINNER JOIN gold.dim_forma_pagamento DFORMAPAGAMENTO\n\nON VENDA.CODIGO_FORMA_PAGAMENTO = DFORMAPAGAMENTO.CODIGO_FORMA_PAGAMENTO\n) b\n\nON \n\na.CODIGO_VENDA = b.CODIGO_VENDA\nAND a.ID_CLIENTE = b.ID_CLIENTE\nAND a.ID_LOJA = b.ID_LOJA\nAND a.ID_PRODUTO = b.ID_PRODUTO\nAND a.ID_FORMA_PAGAMENTO = b.ID_FORMA_PAGAMENTO\nAND a.ID_TEMPO = b.ID_TEMPO\n\nWHEN MATCHED \nTHEN\nUPDATE SET \na.HORA_VENDA = b.HORA_VENDA\n,a.QUANTIDADE = b.QUANTIDADE\n,a.VALOR_UNITARIO = b.VALOR_UNITARIO\n,a.VALOR_FINAL = b.VALOR_FINAL\n,a.TIPO_PAGAMENTO = b.TIPO_PAGAMENTO\n,a.DATA_ALTERACAO = from_utc_timestamp(now(),'GMT-3')\n\nWHEN NOT MATCHED\nTHEN \nINSERT \n(\nCODIGO_VENDA\n,ID_CLIENTE\n,ID_LOJA\n,ID_PRODUTO\n,ID_FORMA_PAGAMENTO\n,ID_TEMPO\n,HORA_VENDA\n,QUANTIDADE\n,VALOR_UNITARIO\n,VALOR_FINAL\n,TIPO_PAGAMENTO\n,DATA_CADASTRO\n,DATA_ALTERACAO\n) \nVALUES \n(\nb.CODIGO_VENDA\n,b.ID_CLIENTE\n,b.ID_LOJA\n,b.ID_PRODUTO\n,b.ID_FORMA_PAGAMENTO\n,b.ID_TEMPO\n,b.HORA_VENDA\n,b.QUANTIDADE\n,b.VALOR_UNITARIO\n,b.VALOR_FINAL\n,b.TIPO_PAGAMENTO\n,from_utc_timestamp(now(),'GMT-3')\n,from_utc_timestamp(now(),'GMT-3')\n)\n</code></pre>"},{"location":"9_analise_dados/","title":"Projeto BI Zero TO DW","text":""},{"location":"9_analise_dados/#9-analise-dos-dados","title":"9 - An\u00e1lise dos Dados","text":""}]}